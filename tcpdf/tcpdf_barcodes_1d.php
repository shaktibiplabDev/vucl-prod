<?php
$code = base64_decode('PD9waHAKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEZpbGUgbmFtZSAgIDogdGNwZGZfYmFyY29kZXNfMWQucGhwCi8vIFZlcnNpb24gICAgIDogMS4wLjAyNwovLyBCZWdpbiAgICAgICA6IDIwMDgtMDYtMDkKLy8gTGFzdCBVcGRhdGUgOiAyMDE0LTEwLTIwCi8vIEF1dGhvciAgICAgIDogTmljb2xhIEFzdW5pIC0gVGVjbmljay5jb20gTFREIC0gd3d3LnRlY25pY2suY29tIC0gaW5mb0B0ZWNuaWNrLmNvbQovLyBMaWNlbnNlICAgICA6IEdOVS1MR1BMIHYzIChodHRwOi8vd3d3LmdudS5vcmcvY29weWxlZnQvbGVzc2VyLmh0bWwpCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gQ29weXJpZ2h0IChDKSAyMDA4LTIwMTQgTmljb2xhIEFzdW5pIC0gVGVjbmljay5jb20gTFRECi8vCi8vIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFRDUERGIHNvZnR3YXJlIGxpYnJhcnkuCi8vCi8vIFRDUERGIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQKLy8gdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMKLy8gcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlCi8vIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi8vCi8vIFRDUERGIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dAovLyBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4KLy8gU2VlIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLy8KLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggVENQREYuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCi8vCi8vIFNlZSBMSUNFTlNFLlRYVCBmaWxlIGZvciBtb3JlIGluZm9ybWF0aW9uLgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vCi8vIERlc2NyaXB0aW9uIDogUEhQIGNsYXNzIHRvIGNyZWF0ZXMgYXJyYXkgcmVwcmVzZW50YXRpb25zIGZvcgovLyAgICAgICAgICAgICAgIGNvbW1vbiAxRCBiYXJjb2RlcyB0byBiZSB1c2VkIHdpdGggVENQREYuCi8vCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KwoKLyoqCiAqIEBmaWxlCiAqIFBIUCBjbGFzcyB0byBjcmVhdGVzIGFycmF5IHJlcHJlc2VudGF0aW9ucyBmb3IgY29tbW9uIDFEIGJhcmNvZGVzIHRvIGJlIHVzZWQgd2l0aCBUQ1BERi4KICogQHBhY2thZ2UgY29tLnRlY25pY2sudGNwZGYKICogQGF1dGhvciBOaWNvbGEgQXN1bmkKICogQHZlcnNpb24gMS4wLjAyNwogKi8KCi8qKgogKiBAY2xhc3MgVENQREZCYXJjb2RlCiAqIFBIUCBjbGFzcyB0byBjcmVhdGVzIGFycmF5IHJlcHJlc2VudGF0aW9ucyBmb3IgY29tbW9uIDFEIGJhcmNvZGVzIHRvIGJlIHVzZWQgd2l0aCBUQ1BERiAoaHR0cDovL3d3dy50Y3BkZi5vcmcpLjxicj4KICogQHBhY2thZ2UgY29tLnRlY25pY2sudGNwZGYKICogQHZlcnNpb24gMS4wLjAyNwogKiBAYXV0aG9yIE5pY29sYSBBc3VuaQogKi8KY2xhc3MgVENQREZCYXJjb2RlIHsKCgkvKioKCSAqIEFycmF5IHJlcHJlc2VudGF0aW9uIG9mIGJhcmNvZGUuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkYmFyY29kZV9hcnJheSA9IGFycmF5KCk7CgoJLyoqCgkgKiBUaGlzIGlzIHRoZSBjbGFzcyBjb25zdHJ1Y3Rvci4KCSAqIFJldHVybiBhbiBhcnJheSByZXByZXNlbnRhdGlvbnMgZm9yIGNvbW1vbiAxRCBiYXJjb2Rlczo8dWw+CgkgKiA8bGk+JGFycmNvZGVbJ2NvZGUnXSBjb2RlIHRvIGJlIHByaW50ZWQgb24gdGV4dCBsYWJlbDwvbGk+CgkgKiA8bGk+JGFycmNvZGVbJ21heGgnXSBtYXggYmFyY29kZSBoZWlnaHQ8L2xpPgoJICogPGxpPiRhcnJjb2RlWydtYXh3J10gbWF4IGJhcmNvZGUgd2lkdGg8L2xpPgoJICogPGxpPiRhcnJjb2RlWydiY29kZSddWyRrXSBzaW5nbGUgYmFyIG9yIHNwYWNlIGluICRrIHBvc2l0aW9uPC9saT4KCSAqIDxsaT4kYXJyY29kZVsnYmNvZGUnXVska11bJ3QnXSBiYXIgdHlwZTogdHJ1ZSA9IGJhciwgZmFsc2UgPSBzcGFjZS48L2xpPgoJICogPGxpPiRhcnJjb2RlWydiY29kZSddWyRrXVsndyddIGJhciB3aWR0aCBpbiB1bml0cy48L2xpPgoJICogPGxpPiRhcnJjb2RlWydiY29kZSddWyRrXVsnaCddIGJhciBoZWlnaHQgaW4gdW5pdHMuPC9saT4KCSAqIDxsaT4kYXJyY29kZVsnYmNvZGUnXVska11bJ3AnXSBiYXIgdG9wIHBvc2l0aW9uICgwID0gdG9wLCAxID0gbWlkZGxlKTwvbGk+PC91bD4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byBwcmludAogCSAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgdHlwZSBvZiBiYXJjb2RlOiA8dWw+PGxpPkMzOSA6IENPREUgMzkgLSBBTlNJIE1IMTAuOE0tMTk4MyAtIFVTRC0zIC0gMyBvZiA5LjwvbGk+PGxpPkMzOSsgOiBDT0RFIDM5IHdpdGggY2hlY2tzdW08L2xpPjxsaT5DMzlFIDogQ09ERSAzOSBFWFRFTkRFRDwvbGk+PGxpPkMzOUUrIDogQ09ERSAzOSBFWFRFTkRFRCArIENIRUNLU1VNPC9saT48bGk+QzkzIDogQ09ERSA5MyAtIFVTUy05MzwvbGk+PGxpPlMyNSA6IFN0YW5kYXJkIDIgb2YgNTwvbGk+PGxpPlMyNSsgOiBTdGFuZGFyZCAyIG9mIDUgKyBDSEVDS1NVTTwvbGk+PGxpPkkyNSA6IEludGVybGVhdmVkIDIgb2YgNTwvbGk+PGxpPkkyNSsgOiBJbnRlcmxlYXZlZCAyIG9mIDUgKyBDSEVDS1NVTTwvbGk+PGxpPkMxMjggOiBDT0RFIDEyODwvbGk+PGxpPkMxMjhBIDogQ09ERSAxMjggQTwvbGk+PGxpPkMxMjhCIDogQ09ERSAxMjggQjwvbGk+PGxpPkMxMjhDIDogQ09ERSAxMjggQzwvbGk+PGxpPkVBTjIgOiAyLURpZ2l0cyBVUEMtQmFzZWQgRXh0ZW5zaW9uPC9saT48bGk+RUFONSA6IDUtRGlnaXRzIFVQQy1CYXNlZCBFeHRlbnNpb248L2xpPjxsaT5FQU44IDogRUFOIDg8L2xpPjxsaT5FQU4xMyA6IEVBTiAxMzwvbGk+PGxpPlVQQ0EgOiBVUEMtQTwvbGk+PGxpPlVQQ0UgOiBVUEMtRTwvbGk+PGxpPk1TSSA6IE1TSSAoVmFyaWF0aW9uIG9mIFBsZXNzZXkgY29kZSk8L2xpPjxsaT5NU0krIDogTVNJICsgQ0hFQ0tTVU0gKG1vZHVsbyAxMSk8L2xpPjxsaT5QT1NUTkVUIDogUE9TVE5FVDwvbGk+PGxpPlBMQU5FVCA6IFBMQU5FVDwvbGk+PGxpPlJNUzRDQyA6IFJNUzRDQyAoUm95YWwgTWFpbCA0LXN0YXRlIEN1c3RvbWVyIENvZGUpIC0gQ0JDIChDdXN0b21lciBCYXIgQ29kZSk8L2xpPjxsaT5LSVggOiBLSVggKEtsYW50IGluZGV4IC0gQ3VzdG9tZXIgaW5kZXgpPC9saT48bGk+SU1COiBJbnRlbGxpZ2VudCBNYWlsIEJhcmNvZGUgLSBPbmVjb2RlIC0gVVNQUy1CLTMyMDA8L2xpPjxsaT5DT0RBQkFSIDogQ09EQUJBUjwvbGk+PGxpPkNPREUxMSA6IENPREUgMTE8L2xpPjxsaT5QSEFSTUEgOiBQSEFSTUFDT0RFPC9saT48bGk+UEhBUk1BMlQgOiBQSEFSTUFDT0RFIFRXTy1UUkFDS1M8L2xpPjwvdWw+CiAJICogQHB1YmxpYwoJICovCglwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvZGUsICR0eXBlKSB7CgkJJHRoaXMtPnNldEJhcmNvZGUoJGNvZGUsICR0eXBlKTsKCX0KCgkvKioKCSAqIFJldHVybiBhbiBhcnJheSByZXByZXNlbnRhdGlvbnMgb2YgYmFyY29kZS4KIAkgKiBAcmV0dXJuIGFycmF5CiAJICogQHB1YmxpYwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0QmFyY29kZUFycmF5KCkgewoJCXJldHVybiAkdGhpcy0+YmFyY29kZV9hcnJheTsKCX0KCgkvKioKCSAqIFNlbmQgYmFyY29kZSBhcyBTVkcgaW1hZ2Ugb2JqZWN0IHRvIHRoZSBzdGFuZGFyZCBvdXRwdXQuCgkgKiBAcGFyYW0gaW50ICR3IE1pbmltdW0gd2lkdGggb2YgYSBzaW5nbGUgYmFyIGluIHVzZXIgdW5pdHMuCgkgKiBAcGFyYW0gaW50ICRoIEhlaWdodCBvZiBiYXJjb2RlIGluIHVzZXIgdW5pdHMuCgkgKiBAcGFyYW0gc3RyaW5nICRjb2xvciBGb3JlZ3JvdW5kIGNvbG9yIChpbiBTVkcgZm9ybWF0KSBmb3IgYmFyIGVsZW1lbnRzIChiYWNrZ3JvdW5kIGlzIHRyYW5zcGFyZW50KS4KIAkgKiBAcHVibGljCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRCYXJjb2RlU1ZHKCR3PTIsICRoPTMwLCAkY29sb3I9J2JsYWNrJykgewoJCS8vIHNlbmQgaGVhZGVycwoJCSRjb2RlID0gJHRoaXMtPmdldEJhcmNvZGVTVkdjb2RlKCR3LCAkaCwgJGNvbG9yKTsKCQloZWFkZXIoJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vc3ZnK3htbCcpOwoJCWhlYWRlcignQ2FjaGUtQ29udHJvbDogcHVibGljLCBtdXN0LXJldmFsaWRhdGUsIG1heC1hZ2U9MCcpOyAvLyBIVFRQLzEuMQoJCWhlYWRlcignUHJhZ21hOiBwdWJsaWMnKTsKCQloZWFkZXIoJ0V4cGlyZXM6IFNhdCwgMjYgSnVsIDE5OTcgMDU6MDA6MDAgR01UJyk7IC8vIERhdGUgaW4gdGhlIHBhc3QKCQloZWFkZXIoJ0xhc3QtTW9kaWZpZWQ6ICcuZ21kYXRlKCdELCBkIE0gWSBIOmk6cycpLicgR01UJyk7CgkJaGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uOiBpbmxpbmU7IGZpbGVuYW1lPSInLm1kNSgkY29kZSkuJy5zdmciOycpOwoJCS8vaGVhZGVyKCdDb250ZW50LUxlbmd0aDogJy5zdHJsZW4oJGNvZGUpKTsKCQllY2hvICRjb2RlOwoJfQoKCS8qKgoJICogUmV0dXJuIGEgU1ZHIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiBiYXJjb2RlLgoJICogQHBhcmFtIGludCAkdyBNaW5pbXVtIHdpZHRoIG9mIGEgc2luZ2xlIGJhciBpbiB1c2VyIHVuaXRzLgoJICogQHBhcmFtIGludCAkaCBIZWlnaHQgb2YgYmFyY29kZSBpbiB1c2VyIHVuaXRzLgoJICogQHBhcmFtIHN0cmluZyAkY29sb3IgRm9yZWdyb3VuZCBjb2xvciAoaW4gU1ZHIGZvcm1hdCkgZm9yIGJhciBlbGVtZW50cyAoYmFja2dyb3VuZCBpcyB0cmFuc3BhcmVudCkuCiAJICogQHJldHVybiBzdHJpbmcgU1ZHIGNvZGUuCiAJICogQHB1YmxpYwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0QmFyY29kZVNWR2NvZGUoJHc9MiwgJGg9MzAsICRjb2xvcj0nYmxhY2snKSB7CgkJLy8gcmVwbGFjZSB0YWJsZSBmb3Igc3BlY2lhbCBjaGFyYWN0ZXJzCgkJJHJlcHN0ciA9IGFycmF5KCJcMCIgPT4gJycsICcmJyA9PiAnJmFtcDsnLCAnPCcgPT4gJyZsdDsnLCAnPicgPT4gJyZndDsnKTsKCQkkc3ZnID0gJzwnLic/Jy4neG1sIHZlcnNpb249IjEuMCIgc3RhbmRhbG9uZT0ibm8iJy4nPycuJz4nLiJcbiI7CgkJJHN2ZyAuPSAnPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4nLiJcbiI7CgkJJHN2ZyAuPSAnPHN2ZyB3aWR0aD0iJy5yb3VuZCgoJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ21heHcnXSAqICR3KSwgMykuJyIgaGVpZ2h0PSInLiRoLiciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4nLiJcbiI7CgkJJHN2ZyAuPSAiXHQiLic8ZGVzYz4nLnN0cnRyKCR0aGlzLT5iYXJjb2RlX2FycmF5Wydjb2RlJ10sICRyZXBzdHIpLic8L2Rlc2M+Jy4iXG4iOwoJCSRzdmcgLj0gIlx0Ii4nPGcgaWQ9ImJhcnMiIGZpbGw9IicuJGNvbG9yLiciIHN0cm9rZT0ibm9uZSI+Jy4iXG4iOwoJCS8vIHByaW50IGJhcnMKCQkkeCA9IDA7CgkJZm9yZWFjaCAoJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ2Jjb2RlJ10gYXMgJGsgPT4gJHYpIHsKCQkJJGJ3ID0gcm91bmQoKCR2Wyd3J10gKiAkdyksIDMpOwoJCQkkYmggPSByb3VuZCgoJHZbJ2gnXSAqICRoIC8gJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ21heGgnXSksIDMpOwoJCQlpZiAoJHZbJ3QnXSkgewoJCQkJJHkgPSByb3VuZCgoJHZbJ3AnXSAqICRoIC8gJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ21heGgnXSksIDMpOwoJCQkJLy8gZHJhdyBhIHZlcnRpY2FsIGJhcgoJCQkJJHN2ZyAuPSAiXHRcdCIuJzxyZWN0IHg9IicuJHguJyIgeT0iJy4keS4nIiB3aWR0aD0iJy4kYncuJyIgaGVpZ2h0PSInLiRiaC4nIiAvPicuIlxuIjsKCQkJfQoJCQkkeCArPSAkYnc7CgkJfQoJCSRzdmcgLj0gIlx0Ii4nPC9nPicuIlxuIjsKCQkkc3ZnIC49ICc8L3N2Zz4nLiJcbiI7CgkJcmV0dXJuICRzdmc7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZiBiYXJjb2RlLgoJICogQHBhcmFtIGludCAkdyBXaWR0aCBvZiBhIHNpbmdsZSBiYXIgZWxlbWVudCBpbiBwaXhlbHMuCgkgKiBAcGFyYW0gaW50ICRoIEhlaWdodCBvZiBhIHNpbmdsZSBiYXIgZWxlbWVudCBpbiBwaXhlbHMuCgkgKiBAcGFyYW0gc3RyaW5nICRjb2xvciBGb3JlZ3JvdW5kIGNvbG9yIGZvciBiYXIgZWxlbWVudHMgKGJhY2tncm91bmQgaXMgdHJhbnNwYXJlbnQpLgogCSAqIEByZXR1cm4gc3RyaW5nIEhUTUwgY29kZS4KIAkgKiBAcHVibGljCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRCYXJjb2RlSFRNTCgkdz0yLCAkaD0zMCwgJGNvbG9yPSdibGFjaycpIHsKCQkkaHRtbCA9ICc8ZGl2IHN0eWxlPSJmb250LXNpemU6MDtwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDonLigkdGhpcy0+YmFyY29kZV9hcnJheVsnbWF4dyddICogJHcpLidweDtoZWlnaHQ6Jy4oJGgpLidweDsiPicuIlxuIjsKCQkvLyBwcmludCBiYXJzCgkJJHggPSAwOwoJCWZvcmVhY2ggKCR0aGlzLT5iYXJjb2RlX2FycmF5WydiY29kZSddIGFzICRrID0+ICR2KSB7CgkJCSRidyA9IHJvdW5kKCgkdlsndyddICogJHcpLCAzKTsKCQkJJGJoID0gcm91bmQoKCR2WydoJ10gKiAkaCAvICR0aGlzLT5iYXJjb2RlX2FycmF5WydtYXhoJ10pLCAzKTsKCQkJaWYgKCR2Wyd0J10pIHsKCQkJCSR5ID0gcm91bmQoKCR2WydwJ10gKiAkaCAvICR0aGlzLT5iYXJjb2RlX2FycmF5WydtYXhoJ10pLCAzKTsKCQkJCS8vIGRyYXcgYSB2ZXJ0aWNhbCBiYXIKCQkJCSRodG1sIC49ICc8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOicuJGNvbG9yLic7d2lkdGg6Jy4kYncuJ3B4O2hlaWdodDonLiRiaC4ncHg7cG9zaXRpb246YWJzb2x1dGU7bGVmdDonLiR4LidweDt0b3A6Jy4keS4ncHg7Ij4mbmJzcDs8L2Rpdj4nLiJcbiI7CgkJCX0KCQkJJHggKz0gJGJ3OwoJCX0KCQkkaHRtbCAuPSAnPC9kaXY+Jy4iXG4iOwoJCXJldHVybiAkaHRtbDsKCX0KCgkvKioKCSAqIFNlbmQgYSBQTkcgaW1hZ2UgcmVwcmVzZW50YXRpb24gb2YgYmFyY29kZSAocmVxdWlyZXMgR0Qgb3IgSW1hZ2ljayBsaWJyYXJ5KS4KCSAqIEBwYXJhbSBpbnQgJHcgV2lkdGggb2YgYSBzaW5nbGUgYmFyIGVsZW1lbnQgaW4gcGl4ZWxzLgoJICogQHBhcmFtIGludCAkaCBIZWlnaHQgb2YgYSBzaW5nbGUgYmFyIGVsZW1lbnQgaW4gcGl4ZWxzLgoJICogQHBhcmFtIGFycmF5ICRjb2xvciBSR0IgKDAtMjU1KSBmb3JlZ3JvdW5kIGNvbG9yIGZvciBiYXIgZWxlbWVudHMgKGJhY2tncm91bmQgaXMgdHJhbnNwYXJlbnQpLgogCSAqIEBwdWJsaWMKCSAqLwoJcHVibGljIGZ1bmN0aW9uIGdldEJhcmNvZGVQTkcoJHc9MiwgJGg9MzAsICRjb2xvcj1hcnJheSgwLDAsMCkpIHsKCQkkZGF0YSA9ICR0aGlzLT5nZXRCYXJjb2RlUG5nRGF0YSgkdywgJGgsICRjb2xvcik7CgkJLy8gc2VuZCBoZWFkZXJzCgkJaGVhZGVyKCdDb250ZW50LVR5cGU6IGltYWdlL3BuZycpOwoJCWhlYWRlcignQ2FjaGUtQ29udHJvbDogcHVibGljLCBtdXN0LXJldmFsaWRhdGUsIG1heC1hZ2U9MCcpOyAvLyBIVFRQLzEuMQoJCWhlYWRlcignUHJhZ21hOiBwdWJsaWMnKTsKCQloZWFkZXIoJ0V4cGlyZXM6IFNhdCwgMjYgSnVsIDE5OTcgMDU6MDA6MDAgR01UJyk7IC8vIERhdGUgaW4gdGhlIHBhc3QKCQloZWFkZXIoJ0xhc3QtTW9kaWZpZWQ6ICcuZ21kYXRlKCdELCBkIE0gWSBIOmk6cycpLicgR01UJyk7CgkJLy9oZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoOiAnLnN0cmxlbigkZGF0YSkpOwoJCWVjaG8gJGRhdGE7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gYSBQTkcgaW1hZ2UgcmVwcmVzZW50YXRpb24gb2YgYmFyY29kZSAocmVxdWlyZXMgR0Qgb3IgSW1hZ2ljayBsaWJyYXJ5KS4KCSAqIEBwYXJhbSBpbnQgJHcgV2lkdGggb2YgYSBzaW5nbGUgYmFyIGVsZW1lbnQgaW4gcGl4ZWxzLgoJICogQHBhcmFtIGludCAkaCBIZWlnaHQgb2YgYSBzaW5nbGUgYmFyIGVsZW1lbnQgaW4gcGl4ZWxzLgoJICogQHBhcmFtIGFycmF5ICRjb2xvciBSR0IgKDAtMjU1KSBmb3JlZ3JvdW5kIGNvbG9yIGZvciBiYXIgZWxlbWVudHMgKGJhY2tncm91bmQgaXMgdHJhbnNwYXJlbnQpLgogCSAqIEByZXR1cm4gc3RyaW5nfEltYWdpY2t8ZmFsc2UgaW1hZ2Ugb3IgZmFsc2UgaW4gY2FzZSBvZiBlcnJvci4KIAkgKiBAcHVibGljCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBnZXRCYXJjb2RlUG5nRGF0YSgkdz0yLCAkaD0zMCwgJGNvbG9yPWFycmF5KDAsMCwwKSkgewoJCS8vIGNhbGN1bGF0ZSBpbWFnZSBzaXplCgkJJHdpZHRoID0gKCR0aGlzLT5iYXJjb2RlX2FycmF5WydtYXh3J10gKiAkdyk7CgkJJGhlaWdodCA9ICRoOwoJCWlmIChmdW5jdGlvbl9leGlzdHMoJ2ltYWdlY3JlYXRlJykpIHsKCQkJLy8gR0QgbGlicmFyeQoJCQkkaW1hZ2ljayA9IGZhbHNlOwoJCQkkcG5nID0gaW1hZ2VjcmVhdGUoJHdpZHRoLCAkaGVpZ2h0KTsKCQkJJGJnY29sID0gaW1hZ2Vjb2xvcmFsbG9jYXRlKCRwbmcsIDI1NSwgMjU1LCAyNTUpOwoJCQlpbWFnZWNvbG9ydHJhbnNwYXJlbnQoJHBuZywgJGJnY29sKTsKCQkJJGZnY29sID0gaW1hZ2Vjb2xvcmFsbG9jYXRlKCRwbmcsICRjb2xvclswXSwgJGNvbG9yWzFdLCAkY29sb3JbMl0pOwoJCX0gZWxzZWlmIChleHRlbnNpb25fbG9hZGVkKCdpbWFnaWNrJykpIHsKCQkJJGltYWdpY2sgPSB0cnVlOwoJCQkkYmdjb2wgPSBuZXcgaW1hZ2lja3BpeGVsKCdyZ2IoMjU1LDI1NSwyNTUnKTsKCQkJJGZnY29sID0gbmV3IGltYWdpY2twaXhlbCgncmdiKCcuJGNvbG9yWzBdLicsJy4kY29sb3JbMV0uJywnLiRjb2xvclsyXS4nKScpOwoJCQkkcG5nID0gbmV3IEltYWdpY2soKTsKCQkJJHBuZy0+bmV3SW1hZ2UoJHdpZHRoLCAkaGVpZ2h0LCAnbm9uZScsICdwbmcnKTsKCQkJJGJhciA9IG5ldyBpbWFnaWNrZHJhdygpOwoJCQkkYmFyLT5zZXRmaWxsY29sb3IoJGZnY29sKTsKCQl9IGVsc2UgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCS8vIHByaW50IGJhcnMKCQkkeCA9IDA7CgkJZm9yZWFjaCAoJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ2Jjb2RlJ10gYXMgJGsgPT4gJHYpIHsKCQkJJGJ3ID0gcm91bmQoKCR2Wyd3J10gKiAkdyksIDMpOwoJCQkkYmggPSByb3VuZCgoJHZbJ2gnXSAqICRoIC8gJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ21heGgnXSksIDMpOwoJCQlpZiAoJHZbJ3QnXSkgewoJCQkJJHkgPSByb3VuZCgoJHZbJ3AnXSAqICRoIC8gJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ21heGgnXSksIDMpOwoJCQkJLy8gZHJhdyBhIHZlcnRpY2FsIGJhcgoJCQkJaWYgKCRpbWFnaWNrKSB7CgkJCQkJJGJhci0+cmVjdGFuZ2xlKCR4LCAkeSwgKCR4ICsgJGJ3IC0gMSksICgkeSArICRiaCAtIDEpKTsKCQkJCX0gZWxzZSB7CgkJCQkJaW1hZ2VmaWxsZWRyZWN0YW5nbGUoJHBuZywgJHgsICR5LCAoJHggKyAkYncgLSAxKSwgKCR5ICsgJGJoIC0gMSksICRmZ2NvbCk7CgkJCQl9CgkJCX0KCQkJJHggKz0gJGJ3OwoJCX0KCQlpZiAoJGltYWdpY2spIHsKCQkJJHBuZy0+ZHJhd2ltYWdlKCRiYXIpOwoJCQlyZXR1cm4gJHBuZzsKCQl9IGVsc2UgewoJCQlvYl9zdGFydCgpOwoJCQlpbWFnZXBuZygkcG5nKTsKCQkJJGltYWdlZGF0YSA9IG9iX2dldF9jbGVhbigpOwoJCQlpbWFnZWRlc3Ryb3koJHBuZyk7CgkJCXJldHVybiAkaW1hZ2VkYXRhOwoJCX0KCX0KCgkvKioKCSAqIFNldCB0aGUgYmFyY29kZS4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byBwcmludAogCSAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgdHlwZSBvZiBiYXJjb2RlOiA8dWw+PGxpPkMzOSA6IENPREUgMzkgLSBBTlNJIE1IMTAuOE0tMTk4MyAtIFVTRC0zIC0gMyBvZiA5LjwvbGk+PGxpPkMzOSsgOiBDT0RFIDM5IHdpdGggY2hlY2tzdW08L2xpPjxsaT5DMzlFIDogQ09ERSAzOSBFWFRFTkRFRDwvbGk+PGxpPkMzOUUrIDogQ09ERSAzOSBFWFRFTkRFRCArIENIRUNLU1VNPC9saT48bGk+QzkzIDogQ09ERSA5MyAtIFVTUy05MzwvbGk+PGxpPlMyNSA6IFN0YW5kYXJkIDIgb2YgNTwvbGk+PGxpPlMyNSsgOiBTdGFuZGFyZCAyIG9mIDUgKyBDSEVDS1NVTTwvbGk+PGxpPkkyNSA6IEludGVybGVhdmVkIDIgb2YgNTwvbGk+PGxpPkkyNSsgOiBJbnRlcmxlYXZlZCAyIG9mIDUgKyBDSEVDS1NVTTwvbGk+PGxpPkMxMjggOiBDT0RFIDEyODwvbGk+PGxpPkMxMjhBIDogQ09ERSAxMjggQTwvbGk+PGxpPkMxMjhCIDogQ09ERSAxMjggQjwvbGk+PGxpPkMxMjhDIDogQ09ERSAxMjggQzwvbGk+PGxpPkVBTjIgOiAyLURpZ2l0cyBVUEMtQmFzZWQgRXh0ZW5zaW9uPC9saT48bGk+RUFONSA6IDUtRGlnaXRzIFVQQy1CYXNlZCBFeHRlbnNpb248L2xpPjxsaT5FQU44IDogRUFOIDg8L2xpPjxsaT5FQU4xMyA6IEVBTiAxMzwvbGk+PGxpPlVQQ0EgOiBVUEMtQTwvbGk+PGxpPlVQQ0UgOiBVUEMtRTwvbGk+PGxpPk1TSSA6IE1TSSAoVmFyaWF0aW9uIG9mIFBsZXNzZXkgY29kZSk8L2xpPjxsaT5NU0krIDogTVNJICsgQ0hFQ0tTVU0gKG1vZHVsbyAxMSk8L2xpPjxsaT5QT1NUTkVUIDogUE9TVE5FVDwvbGk+PGxpPlBMQU5FVCA6IFBMQU5FVDwvbGk+PGxpPlJNUzRDQyA6IFJNUzRDQyAoUm95YWwgTWFpbCA0LXN0YXRlIEN1c3RvbWVyIENvZGUpIC0gQ0JDIChDdXN0b21lciBCYXIgQ29kZSk8L2xpPjxsaT5LSVggOiBLSVggKEtsYW50IGluZGV4IC0gQ3VzdG9tZXIgaW5kZXgpPC9saT48bGk+SU1COiBJbnRlbGxpZ2VudCBNYWlsIEJhcmNvZGUgLSBPbmVjb2RlIC0gVVNQUy1CLTMyMDA8L2xpPjxsaT5JTUJQUkU6IFByZS1wcm9jZXNzZWQgSW50ZWxsaWdlbnQgTWFpbCBCYXJjb2RlIC0gT25lY29kZSAtIFVTUFMtQi0zMjAwLCB1c2luZyBvbmx5IEYsQSxELFQgbGV0dGVyczwvbGk+PGxpPkNPREFCQVIgOiBDT0RBQkFSPC9saT48bGk+Q09ERTExIDogQ09ERSAxMTwvbGk+PGxpPlBIQVJNQSA6IFBIQVJNQUNPREU8L2xpPjxsaT5QSEFSTUEyVCA6IFBIQVJNQUNPREUgVFdPLVRSQUNLUzwvbGk+PC91bD4KIAkgKiBAcmV0dXJuIHZvaWQKIAkgKiBAcHVibGljCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBzZXRCYXJjb2RlKCRjb2RlLCAkdHlwZSkgewoJCXN3aXRjaCAoc3RydG91cHBlcigkdHlwZSkpIHsKCQkJY2FzZSAnQzM5JzogeyAvLyBDT0RFIDM5IC0gQU5TSSBNSDEwLjhNLTE5ODMgLSBVU0QtMyAtIDMgb2YgOS4KCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfY29kZTM5KCRjb2RlLCBmYWxzZSwgZmFsc2UpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQzM5Kyc6IHsgLy8gQ09ERSAzOSB3aXRoIGNoZWNrc3VtCgkJCQkkYXJyY29kZSA9ICR0aGlzLT5iYXJjb2RlX2NvZGUzOSgkY29kZSwgZmFsc2UsIHRydWUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQzM5RSc6IHsgLy8gQ09ERSAzOSBFWFRFTkRFRAoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9jb2RlMzkoJGNvZGUsIHRydWUsIGZhbHNlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0MzOUUrJzogeyAvLyBDT0RFIDM5IEVYVEVOREVEICsgQ0hFQ0tTVU0KCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfY29kZTM5KCRjb2RlLCB0cnVlLCB0cnVlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0M5Myc6IHsgLy8gQ09ERSA5MyAtIFVTUy05MwoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9jb2RlOTMoJGNvZGUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnUzI1JzogeyAvLyBTdGFuZGFyZCAyIG9mIDUKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfczI1KCRjb2RlLCBmYWxzZSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdTMjUrJzogeyAvLyBTdGFuZGFyZCAyIG9mIDUgKyBDSEVDS1NVTQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9zMjUoJGNvZGUsIHRydWUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnSTI1JzogeyAvLyBJbnRlcmxlYXZlZCAyIG9mIDUKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfaTI1KCRjb2RlLCBmYWxzZSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdJMjUrJzogeyAvLyBJbnRlcmxlYXZlZCAyIG9mIDUgKyBDSEVDS1NVTQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9pMjUoJGNvZGUsIHRydWUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQzEyOCc6IHsgLy8gQ09ERSAxMjgKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfYzEyOCgkY29kZSwgJycpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQzEyOEEnOiB7IC8vIENPREUgMTI4IEEKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfYzEyOCgkY29kZSwgJ0EnKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0MxMjhCJzogeyAvLyBDT0RFIDEyOCBCCgkJCQkkYXJyY29kZSA9ICR0aGlzLT5iYXJjb2RlX2MxMjgoJGNvZGUsICdCJyk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdDMTI4Qyc6IHsgLy8gQ09ERSAxMjggQwoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9jMTI4KCRjb2RlLCAnQycpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnRUFOMic6IHsgLy8gMi1EaWdpdHMgVVBDLUJhc2VkIEV4dGVuc2lvbgoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9lYW5leHQoJGNvZGUsIDIpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnRUFONSc6IHsgLy8gNS1EaWdpdHMgVVBDLUJhc2VkIEV4dGVuc2lvbgoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9lYW5leHQoJGNvZGUsIDUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnRUFOOCc6IHsgLy8gRUFOIDgKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfZWFudXBjKCRjb2RlLCA4KTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0VBTjEzJzogeyAvLyBFQU4gMTMKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfZWFudXBjKCRjb2RlLCAxMyk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdVUENBJzogeyAvLyBVUEMtQQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9lYW51cGMoJGNvZGUsIDEyKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ1VQQ0UnOiB7IC8vIFVQQy1FCgkJCQkkYXJyY29kZSA9ICR0aGlzLT5iYXJjb2RlX2VhbnVwYygkY29kZSwgNik7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdNU0knOiB7IC8vIE1TSSAoVmFyaWF0aW9uIG9mIFBsZXNzZXkgY29kZSkKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfbXNpKCRjb2RlLCBmYWxzZSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdNU0krJzogeyAvLyBNU0kgKyBDSEVDS1NVTSAobW9kdWxvIDExKQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9tc2koJGNvZGUsIHRydWUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnUE9TVE5FVCc6IHsgLy8gUE9TVE5FVAoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9wb3N0bmV0KCRjb2RlLCBmYWxzZSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlICdQTEFORVQnOiB7IC8vIFBMQU5FVAoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9wb3N0bmV0KCRjb2RlLCB0cnVlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ1JNUzRDQyc6IHsgLy8gUk1TNENDIChSb3lhbCBNYWlsIDQtc3RhdGUgQ3VzdG9tZXIgQ29kZSkgLSBDQkMgKEN1c3RvbWVyIEJhciBDb2RlKQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9ybXM0Y2MoJGNvZGUsIGZhbHNlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0tJWCc6IHsgLy8gS0lYIChLbGFudCBpbmRleCAtIEN1c3RvbWVyIGluZGV4KQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9ybXM0Y2MoJGNvZGUsIHRydWUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnSU1CJzogeyAvLyBJTUIgLSBJbnRlbGxpZ2VudCBNYWlsIEJhcmNvZGUgLSBPbmVjb2RlIC0gVVNQUy1CLTMyMDAKCQkJCSRhcnJjb2RlID0gJHRoaXMtPmJhcmNvZGVfaW1iKCRjb2RlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0lNQlBSRSc6IHsgLy8gSU1CIC0gSW50ZWxsaWdlbnQgTWFpbCBCYXJjb2RlIC0gT25lY29kZSAtIFVTUFMtQi0zMjAwLSBwcmUtcHJvY2Vzc2VkCgkJCQkkYXJyY29kZSA9ICR0aGlzLT5iYXJjb2RlX2ltYl9wcmUoJGNvZGUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQ09EQUJBUic6IHsgLy8gQ09EQUJBUgoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9jb2RhYmFyKCRjb2RlKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0NPREUxMSc6IHsgLy8gQ09ERSAxMQoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9jb2RlMTEoJGNvZGUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnUEhBUk1BJzogeyAvLyBQSEFSTUFDT0RFCgkJCQkkYXJyY29kZSA9ICR0aGlzLT5iYXJjb2RlX3BoYXJtYWNvZGUoJGNvZGUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnUEhBUk1BMlQnOiB7IC8vIFBIQVJNQUNPREUgVFdPLVRSQUNLUwoJCQkJJGFycmNvZGUgPSAkdGhpcy0+YmFyY29kZV9waGFybWFjb2RlMnQoJGNvZGUpOwoJCQkJYnJlYWs7CgkJCX0KCQkJZGVmYXVsdDogewoJCQkJJHRoaXMtPmJhcmNvZGVfYXJyYXkgPSBhcnJheSgpOwoJCQkJJGFycmNvZGUgPSBmYWxzZTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCSR0aGlzLT5iYXJjb2RlX2FycmF5ID0gJGFycmNvZGU7Cgl9CgoJLyoqCgkgKiBDT0RFIDM5IC0gQU5TSSBNSDEwLjhNLTE5ODMgLSBVU0QtMyAtIDMgb2YgOS4KCSAqIEdlbmVyYWwtcHVycG9zZSBjb2RlIGluIHZlcnkgd2lkZSB1c2Ugd29ybGQtd2lkZQoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEBwYXJhbSBib29sZWFuICRleHRlbmRlZCBpZiB0cnVlIHVzZXMgdGhlIGV4dGVuZGVkIG1vZGUuCgkgKiBAcGFyYW0gYm9vbGVhbiAkY2hlY2tzdW0gaWYgdHJ1ZSBhZGQgYSBjaGVja3N1bSB0byB0aGUgY29kZS4KCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfY29kZTM5KCRjb2RlLCAkZXh0ZW5kZWQ9ZmFsc2UsICRjaGVja3N1bT1mYWxzZSkgewoJCSRjaHJbJzAnXSA9ICcxMTEzMzEzMTEnOwoJCSRjaHJbJzEnXSA9ICczMTEzMTExMTMnOwoJCSRjaHJbJzInXSA9ICcxMTMzMTExMTMnOwoJCSRjaHJbJzMnXSA9ICczMTMzMTExMTEnOwoJCSRjaHJbJzQnXSA9ICcxMTEzMzExMTMnOwoJCSRjaHJbJzUnXSA9ICczMTEzMzExMTEnOwoJCSRjaHJbJzYnXSA9ICcxMTMzMzExMTEnOwoJCSRjaHJbJzcnXSA9ICcxMTEzMTEzMTMnOwoJCSRjaHJbJzgnXSA9ICczMTEzMTEzMTEnOwoJCSRjaHJbJzknXSA9ICcxMTMzMTEzMTEnOwoJCSRjaHJbJ0EnXSA9ICczMTExMTMxMTMnOwoJCSRjaHJbJ0InXSA9ICcxMTMxMTMxMTMnOwoJCSRjaHJbJ0MnXSA9ICczMTMxMTMxMTEnOwoJCSRjaHJbJ0QnXSA9ICcxMTExMzMxMTMnOwoJCSRjaHJbJ0UnXSA9ICczMTExMzMxMTEnOwoJCSRjaHJbJ0YnXSA9ICcxMTMxMzMxMTEnOwoJCSRjaHJbJ0cnXSA9ICcxMTExMTMzMTMnOwoJCSRjaHJbJ0gnXSA9ICczMTExMTMzMTEnOwoJCSRjaHJbJ0knXSA9ICcxMTMxMTMzMTEnOwoJCSRjaHJbJ0onXSA9ICcxMTExMzMzMTEnOwoJCSRjaHJbJ0snXSA9ICczMTExMTExMzMnOwoJCSRjaHJbJ0wnXSA9ICcxMTMxMTExMzMnOwoJCSRjaHJbJ00nXSA9ICczMTMxMTExMzEnOwoJCSRjaHJbJ04nXSA9ICcxMTExMzExMzMnOwoJCSRjaHJbJ08nXSA9ICczMTExMzExMzEnOwoJCSRjaHJbJ1AnXSA9ICcxMTMxMzExMzEnOwoJCSRjaHJbJ1EnXSA9ICcxMTExMTEzMzMnOwoJCSRjaHJbJ1InXSA9ICczMTExMTEzMzEnOwoJCSRjaHJbJ1MnXSA9ICcxMTMxMTEzMzEnOwoJCSRjaHJbJ1QnXSA9ICcxMTExMzEzMzEnOwoJCSRjaHJbJ1UnXSA9ICczMzExMTExMTMnOwoJCSRjaHJbJ1YnXSA9ICcxMzMxMTExMTMnOwoJCSRjaHJbJ1cnXSA9ICczMzMxMTExMTEnOwoJCSRjaHJbJ1gnXSA9ICcxMzExMzExMTMnOwoJCSRjaHJbJ1knXSA9ICczMzExMzExMTEnOwoJCSRjaHJbJ1onXSA9ICcxMzMxMzExMTEnOwoJCSRjaHJbJy0nXSA9ICcxMzExMTEzMTMnOwoJCSRjaHJbJy4nXSA9ICczMzExMTEzMTEnOwoJCSRjaHJbJyAnXSA9ICcxMzMxMTEzMTEnOwoJCSRjaHJbJyQnXSA9ICcxMzEzMTMxMTEnOwoJCSRjaHJbJy8nXSA9ICcxMzEzMTExMzEnOwoJCSRjaHJbJysnXSA9ICcxMzExMTMxMzEnOwoJCSRjaHJbJyUnXSA9ICcxMTEzMTMxMzEnOwoJCSRjaHJbJyonXSA9ICcxMzExMzEzMTEnOwoJCSRjb2RlID0gc3RydG91cHBlcigkY29kZSk7CgkJaWYgKCRleHRlbmRlZCkgewoJCQkvLyBleHRlbmRlZCBtb2RlCgkJCSRjb2RlID0gJHRoaXMtPmVuY29kZV9jb2RlMzlfZXh0KCRjb2RlKTsKCQl9CgkJaWYgKCRjb2RlID09PSBmYWxzZSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCWlmICgkY2hlY2tzdW0pIHsKCQkJLy8gY2hlY2tzdW0KCQkJJGNvZGUgLj0gJHRoaXMtPmNoZWNrc3VtX2NvZGUzOSgkY29kZSk7CgkJfQoJCS8vIGFkZCBzdGFydCBhbmQgc3RvcCBjb2RlcwoJCSRjb2RlID0gJyonLiRjb2RlLicqJzsKCQkkYmFyYXJyYXkgPSBhcnJheSgnY29kZScgPT4gJGNvZGUsICdtYXh3JyA9PiAwLCAnbWF4aCcgPT4gMSwgJ2Jjb2RlJyA9PiBhcnJheSgpKTsKCQkkayA9IDA7CgkJJGNsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCWZvciAoJGkgPSAwOyAkaSA8ICRjbGVuOyArKyRpKSB7CgkJCSRjaGFyID0gJGNvZGVbJGldOwoJCQlpZighaXNzZXQoJGNoclskY2hhcl0pKSB7CgkJCQkvLyBpbnZhbGlkIGNoYXJhY3RlcgoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCWZvciAoJGogPSAwOyAkaiA8IDk7ICsrJGopIHsKCQkJCWlmICgoJGogJSAyKSA9PSAwKSB7CgkJCQkJJHQgPSB0cnVlOyAvLyBiYXIKCQkJCX0gZWxzZSB7CgkJCQkJJHQgPSBmYWxzZTsgLy8gc3BhY2UKCQkJCX0KCQkJCSR3ID0gJGNoclskY2hhcl1bJGpdOwoJCQkJJGJhcmFycmF5WydiY29kZSddWyRrXSA9IGFycmF5KCd0JyA9PiAkdCwgJ3cnID0+ICR3LCAnaCcgPT4gMSwgJ3AnID0+IDApOwoJCQkJJGJhcmFycmF5WydtYXh3J10gKz0gJHc7CgkJCQkrKyRrOwoJCQl9CgkJCS8vIGludGVyY2hhcmFjdGVyIGdhcAoJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGtdID0gYXJyYXkoJ3QnID0+IGZhbHNlLCAndycgPT4gMSwgJ2gnID0+IDEsICdwJyA9PiAwKTsKCQkJJGJhcmFycmF5WydtYXh3J10gKz0gMTsKCQkJKyskazsKCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIEVuY29kZSBhIHN0cmluZyB0byBiZSB1c2VkIGZvciBDT0RFIDM5IEV4dGVuZGVkIG1vZGUuCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gcmVwcmVzZW50LgoJICogQHJldHVybiBzdHJpbmcgZW5jb2RlZCBzdHJpbmcuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVfY29kZTM5X2V4dCgkY29kZSkgewoJCSRlbmNvZGUgPSBhcnJheSgKCQkJY2hyKDApID0+ICclVScsIGNocigxKSA9PiAnJEEnLCBjaHIoMikgPT4gJyRCJywgY2hyKDMpID0+ICckQycsCgkJCWNocig0KSA9PiAnJEQnLCBjaHIoNSkgPT4gJyRFJywgY2hyKDYpID0+ICckRicsIGNocig3KSA9PiAnJEcnLAoJCQljaHIoOCkgPT4gJyRIJywgY2hyKDkpID0+ICckSScsIGNocigxMCkgPT4gJyRKJywgY2hyKDExKSA9PiAnwqNLJywKCQkJY2hyKDEyKSA9PiAnJEwnLCBjaHIoMTMpID0+ICckTScsIGNocigxNCkgPT4gJyROJywgY2hyKDE1KSA9PiAnJE8nLAoJCQljaHIoMTYpID0+ICckUCcsIGNocigxNykgPT4gJyRRJywgY2hyKDE4KSA9PiAnJFInLCBjaHIoMTkpID0+ICckUycsCgkJCWNocigyMCkgPT4gJyRUJywgY2hyKDIxKSA9PiAnJFUnLCBjaHIoMjIpID0+ICckVicsIGNocigyMykgPT4gJyRXJywKCQkJY2hyKDI0KSA9PiAnJFgnLCBjaHIoMjUpID0+ICckWScsIGNocigyNikgPT4gJyRaJywgY2hyKDI3KSA9PiAnJUEnLAoJCQljaHIoMjgpID0+ICclQicsIGNocigyOSkgPT4gJyVDJywgY2hyKDMwKSA9PiAnJUQnLCBjaHIoMzEpID0+ICclRScsCgkJCWNocigzMikgPT4gJyAnLCBjaHIoMzMpID0+ICcvQScsIGNocigzNCkgPT4gJy9CJywgY2hyKDM1KSA9PiAnL0MnLAoJCQljaHIoMzYpID0+ICcvRCcsIGNocigzNykgPT4gJy9FJywgY2hyKDM4KSA9PiAnL0YnLCBjaHIoMzkpID0+ICcvRycsCgkJCWNocig0MCkgPT4gJy9IJywgY2hyKDQxKSA9PiAnL0knLCBjaHIoNDIpID0+ICcvSicsIGNocig0MykgPT4gJy9LJywKCQkJY2hyKDQ0KSA9PiAnL0wnLCBjaHIoNDUpID0+ICctJywgY2hyKDQ2KSA9PiAnLicsIGNocig0NykgPT4gJy9PJywKCQkJY2hyKDQ4KSA9PiAnMCcsIGNocig0OSkgPT4gJzEnLCBjaHIoNTApID0+ICcyJywgY2hyKDUxKSA9PiAnMycsCgkJCWNocig1MikgPT4gJzQnLCBjaHIoNTMpID0+ICc1JywgY2hyKDU0KSA9PiAnNicsIGNocig1NSkgPT4gJzcnLAoJCQljaHIoNTYpID0+ICc4JywgY2hyKDU3KSA9PiAnOScsIGNocig1OCkgPT4gJy9aJywgY2hyKDU5KSA9PiAnJUYnLAoJCQljaHIoNjApID0+ICclRycsIGNocig2MSkgPT4gJyVIJywgY2hyKDYyKSA9PiAnJUknLCBjaHIoNjMpID0+ICclSicsCgkJCWNocig2NCkgPT4gJyVWJywgY2hyKDY1KSA9PiAnQScsIGNocig2NikgPT4gJ0InLCBjaHIoNjcpID0+ICdDJywKCQkJY2hyKDY4KSA9PiAnRCcsIGNocig2OSkgPT4gJ0UnLCBjaHIoNzApID0+ICdGJywgY2hyKDcxKSA9PiAnRycsCgkJCWNocig3MikgPT4gJ0gnLCBjaHIoNzMpID0+ICdJJywgY2hyKDc0KSA9PiAnSicsIGNocig3NSkgPT4gJ0snLAoJCQljaHIoNzYpID0+ICdMJywgY2hyKDc3KSA9PiAnTScsIGNocig3OCkgPT4gJ04nLCBjaHIoNzkpID0+ICdPJywKCQkJY2hyKDgwKSA9PiAnUCcsIGNocig4MSkgPT4gJ1EnLCBjaHIoODIpID0+ICdSJywgY2hyKDgzKSA9PiAnUycsCgkJCWNocig4NCkgPT4gJ1QnLCBjaHIoODUpID0+ICdVJywgY2hyKDg2KSA9PiAnVicsIGNocig4NykgPT4gJ1cnLAoJCQljaHIoODgpID0+ICdYJywgY2hyKDg5KSA9PiAnWScsIGNocig5MCkgPT4gJ1onLCBjaHIoOTEpID0+ICclSycsCgkJCWNocig5MikgPT4gJyVMJywgY2hyKDkzKSA9PiAnJU0nLCBjaHIoOTQpID0+ICclTicsIGNocig5NSkgPT4gJyVPJywKCQkJY2hyKDk2KSA9PiAnJVcnLCBjaHIoOTcpID0+ICcrQScsIGNocig5OCkgPT4gJytCJywgY2hyKDk5KSA9PiAnK0MnLAoJCQljaHIoMTAwKSA9PiAnK0QnLCBjaHIoMTAxKSA9PiAnK0UnLCBjaHIoMTAyKSA9PiAnK0YnLCBjaHIoMTAzKSA9PiAnK0cnLAoJCQljaHIoMTA0KSA9PiAnK0gnLCBjaHIoMTA1KSA9PiAnK0knLCBjaHIoMTA2KSA9PiAnK0onLCBjaHIoMTA3KSA9PiAnK0snLAoJCQljaHIoMTA4KSA9PiAnK0wnLCBjaHIoMTA5KSA9PiAnK00nLCBjaHIoMTEwKSA9PiAnK04nLCBjaHIoMTExKSA9PiAnK08nLAoJCQljaHIoMTEyKSA9PiAnK1AnLCBjaHIoMTEzKSA9PiAnK1EnLCBjaHIoMTE0KSA9PiAnK1InLCBjaHIoMTE1KSA9PiAnK1MnLAoJCQljaHIoMTE2KSA9PiAnK1QnLCBjaHIoMTE3KSA9PiAnK1UnLCBjaHIoMTE4KSA9PiAnK1YnLCBjaHIoMTE5KSA9PiAnK1cnLAoJCQljaHIoMTIwKSA9PiAnK1gnLCBjaHIoMTIxKSA9PiAnK1knLCBjaHIoMTIyKSA9PiAnK1onLCBjaHIoMTIzKSA9PiAnJVAnLAoJCQljaHIoMTI0KSA9PiAnJVEnLCBjaHIoMTI1KSA9PiAnJVInLCBjaHIoMTI2KSA9PiAnJVMnLCBjaHIoMTI3KSA9PiAnJVQnKTsKCQkkY29kZV9leHQgPSAnJzsKCQkkY2xlbiA9IHN0cmxlbigkY29kZSk7CgkJZm9yICgkaSA9IDAgOyAkaSA8ICRjbGVuOyArKyRpKSB7CgkJCWlmIChvcmQoJGNvZGVbJGldKSA+IDEyNykgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCSRjb2RlX2V4dCAuPSAkZW5jb2RlWyRjb2RlWyRpXV07CgkJfQoJCXJldHVybiAkY29kZV9leHQ7Cgl9CgoJLyoqCgkgKiBDYWxjdWxhdGUgQ09ERSAzOSBjaGVja3N1bSAobW9kdWxvIDQzKS4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQuCgkgKiBAcmV0dXJuIHN0cmluZyBjaGFyIGNoZWNrc3VtLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2tzdW1fY29kZTM5KCRjb2RlKSB7CgkJJGNoYXJzID0gYXJyYXkoCgkJCScwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywKCQkJJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onLCAnSycsCgkJCSdMJywgJ00nLCAnTicsICdPJywgJ1AnLCAnUScsICdSJywgJ1MnLCAnVCcsICdVJywgJ1YnLAoJCQknVycsICdYJywgJ1knLCAnWicsICctJywgJy4nLCAnICcsICckJywgJy8nLCAnKycsICclJyk7CgkJJHN1bSA9IDA7CgkJJGNsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCWZvciAoJGkgPSAwIDsgJGkgPCAkY2xlbjsgKyskaSkgewoJCQkkayA9IGFycmF5X2tleXMoJGNoYXJzLCAkY29kZVskaV0pOwoJCQkkc3VtICs9ICRrWzBdOwoJCX0KCQkkaiA9ICgkc3VtICUgNDMpOwoJCXJldHVybiAkY2hhcnNbJGpdOwoJfQoKCS8qKgoJICogQ09ERSA5MyAtIFVTUy05MwoJICogQ29tcGFjdCBjb2RlIHNpbWlsYXIgdG8gQ29kZSAzOQoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfY29kZTkzKCRjb2RlKSB7CgkJJGNocls0OF0gPSAnMTMxMTEyJzsgLy8gMAoJCSRjaHJbNDldID0gJzExMTIxMyc7IC8vIDEKCQkkY2hyWzUwXSA9ICcxMTEzMTInOyAvLyAyCgkJJGNocls1MV0gPSAnMTExNDExJzsgLy8gMwoJCSRjaHJbNTJdID0gJzEyMTExMyc7IC8vIDQKCQkkY2hyWzUzXSA9ICcxMjEyMTInOyAvLyA1CgkJJGNocls1NF0gPSAnMTIxMzExJzsgLy8gNgoJCSRjaHJbNTVdID0gJzExMTExNCc7IC8vIDcKCQkkY2hyWzU2XSA9ICcxMzEyMTEnOyAvLyA4CgkJJGNocls1N10gPSAnMTQxMTExJzsgLy8gOQoJCSRjaHJbNjVdID0gJzIxMTExMyc7IC8vIEEKCQkkY2hyWzY2XSA9ICcyMTEyMTInOyAvLyBCCgkJJGNocls2N10gPSAnMjExMzExJzsgLy8gQwoJCSRjaHJbNjhdID0gJzIyMTExMic7IC8vIEQKCQkkY2hyWzY5XSA9ICcyMjEyMTEnOyAvLyBFCgkJJGNocls3MF0gPSAnMjMxMTExJzsgLy8gRgoJCSRjaHJbNzFdID0gJzExMjExMyc7IC8vIEcKCQkkY2hyWzcyXSA9ICcxMTIyMTInOyAvLyBICgkJJGNocls3M10gPSAnMTEyMzExJzsgLy8gSQoJCSRjaHJbNzRdID0gJzEyMjExMic7IC8vIEoKCQkkY2hyWzc1XSA9ICcxMzIxMTEnOyAvLyBLCgkJJGNocls3Nl0gPSAnMTExMTIzJzsgLy8gTAoJCSRjaHJbNzddID0gJzExMTIyMic7IC8vIE0KCQkkY2hyWzc4XSA9ICcxMTEzMjEnOyAvLyBOCgkJJGNocls3OV0gPSAnMTIxMTIyJzsgLy8gTwoJCSRjaHJbODBdID0gJzEzMTEyMSc7IC8vIFAKCQkkY2hyWzgxXSA9ICcyMTIxMTInOyAvLyBRCgkJJGNocls4Ml0gPSAnMjEyMjExJzsgLy8gUgoJCSRjaHJbODNdID0gJzIxMTEyMic7IC8vIFMKCQkkY2hyWzg0XSA9ICcyMTEyMjEnOyAvLyBUCgkJJGNocls4NV0gPSAnMjIxMTIxJzsgLy8gVQoJCSRjaHJbODZdID0gJzIyMjExMSc7IC8vIFYKCQkkY2hyWzg3XSA9ICcxMTIxMjInOyAvLyBXCgkJJGNocls4OF0gPSAnMTEyMjIxJzsgLy8gWAoJCSRjaHJbODldID0gJzEyMjEyMSc7IC8vIFkKCQkkY2hyWzkwXSA9ICcxMjMxMTEnOyAvLyBaCgkJJGNocls0NV0gPSAnMTIxMTMxJzsgLy8gLQoJCSRjaHJbNDZdID0gJzMxMTExMic7IC8vIC4KCQkkY2hyWzMyXSA9ICczMTEyMTEnOyAvLwoJCSRjaHJbMzZdID0gJzMyMTExMSc7IC8vICQKCQkkY2hyWzQ3XSA9ICcxMTIxMzEnOyAvLyAvCgkJJGNocls0M10gPSAnMTEzMTIxJzsgLy8gKwoJCSRjaHJbMzddID0gJzIxMTEzMSc7IC8vICUKCQkkY2hyWzEyOF0gPSAnMTIxMjIxJzsgLy8gKCQpCgkJJGNoclsxMjldID0gJzMxMTEyMSc7IC8vICgvKQoJCSRjaHJbMTMwXSA9ICcxMjIyMTEnOyAvLyAoKykKCQkkY2hyWzEzMV0gPSAnMzEyMTExJzsgLy8gKCUpCgkJJGNocls0Ml0gPSAnMTExMTQxJzsgLy8gc3RhcnQtc3RvcAoJCSRjb2RlID0gc3RydG91cHBlcigkY29kZSk7CgkJJGVuY29kZSA9IGFycmF5KAoJCQljaHIoMCkgPT4gY2hyKDEzMSkuJ1UnLCBjaHIoMSkgPT4gY2hyKDEyOCkuJ0EnLCBjaHIoMikgPT4gY2hyKDEyOCkuJ0InLCBjaHIoMykgPT4gY2hyKDEyOCkuJ0MnLAoJCQljaHIoNCkgPT4gY2hyKDEyOCkuJ0QnLCBjaHIoNSkgPT4gY2hyKDEyOCkuJ0UnLCBjaHIoNikgPT4gY2hyKDEyOCkuJ0YnLCBjaHIoNykgPT4gY2hyKDEyOCkuJ0cnLAoJCQljaHIoOCkgPT4gY2hyKDEyOCkuJ0gnLCBjaHIoOSkgPT4gY2hyKDEyOCkuJ0knLCBjaHIoMTApID0+IGNocigxMjgpLidKJywgY2hyKDExKSA9PiAnwqNLJywKCQkJY2hyKDEyKSA9PiBjaHIoMTI4KS4nTCcsIGNocigxMykgPT4gY2hyKDEyOCkuJ00nLCBjaHIoMTQpID0+IGNocigxMjgpLidOJywgY2hyKDE1KSA9PiBjaHIoMTI4KS4nTycsCgkJCWNocigxNikgPT4gY2hyKDEyOCkuJ1AnLCBjaHIoMTcpID0+IGNocigxMjgpLidRJywgY2hyKDE4KSA9PiBjaHIoMTI4KS4nUicsIGNocigxOSkgPT4gY2hyKDEyOCkuJ1MnLAoJCQljaHIoMjApID0+IGNocigxMjgpLidUJywgY2hyKDIxKSA9PiBjaHIoMTI4KS4nVScsIGNocigyMikgPT4gY2hyKDEyOCkuJ1YnLCBjaHIoMjMpID0+IGNocigxMjgpLidXJywKCQkJY2hyKDI0KSA9PiBjaHIoMTI4KS4nWCcsIGNocigyNSkgPT4gY2hyKDEyOCkuJ1knLCBjaHIoMjYpID0+IGNocigxMjgpLidaJywgY2hyKDI3KSA9PiBjaHIoMTMxKS4nQScsCgkJCWNocigyOCkgPT4gY2hyKDEzMSkuJ0InLCBjaHIoMjkpID0+IGNocigxMzEpLidDJywgY2hyKDMwKSA9PiBjaHIoMTMxKS4nRCcsIGNocigzMSkgPT4gY2hyKDEzMSkuJ0UnLAoJCQljaHIoMzIpID0+ICcgJywgY2hyKDMzKSA9PiBjaHIoMTI5KS4nQScsIGNocigzNCkgPT4gY2hyKDEyOSkuJ0InLCBjaHIoMzUpID0+IGNocigxMjkpLidDJywKCQkJY2hyKDM2KSA9PiBjaHIoMTI5KS4nRCcsIGNocigzNykgPT4gY2hyKDEyOSkuJ0UnLCBjaHIoMzgpID0+IGNocigxMjkpLidGJywgY2hyKDM5KSA9PiBjaHIoMTI5KS4nRycsCgkJCWNocig0MCkgPT4gY2hyKDEyOSkuJ0gnLCBjaHIoNDEpID0+IGNocigxMjkpLidJJywgY2hyKDQyKSA9PiBjaHIoMTI5KS4nSicsIGNocig0MykgPT4gY2hyKDEyOSkuJ0snLAoJCQljaHIoNDQpID0+IGNocigxMjkpLidMJywgY2hyKDQ1KSA9PiAnLScsIGNocig0NikgPT4gJy4nLCBjaHIoNDcpID0+IGNocigxMjkpLidPJywKCQkJY2hyKDQ4KSA9PiAnMCcsIGNocig0OSkgPT4gJzEnLCBjaHIoNTApID0+ICcyJywgY2hyKDUxKSA9PiAnMycsCgkJCWNocig1MikgPT4gJzQnLCBjaHIoNTMpID0+ICc1JywgY2hyKDU0KSA9PiAnNicsIGNocig1NSkgPT4gJzcnLAoJCQljaHIoNTYpID0+ICc4JywgY2hyKDU3KSA9PiAnOScsIGNocig1OCkgPT4gY2hyKDEyOSkuJ1onLCBjaHIoNTkpID0+IGNocigxMzEpLidGJywKCQkJY2hyKDYwKSA9PiBjaHIoMTMxKS4nRycsIGNocig2MSkgPT4gY2hyKDEzMSkuJ0gnLCBjaHIoNjIpID0+IGNocigxMzEpLidJJywgY2hyKDYzKSA9PiBjaHIoMTMxKS4nSicsCgkJCWNocig2NCkgPT4gY2hyKDEzMSkuJ1YnLCBjaHIoNjUpID0+ICdBJywgY2hyKDY2KSA9PiAnQicsIGNocig2NykgPT4gJ0MnLAoJCQljaHIoNjgpID0+ICdEJywgY2hyKDY5KSA9PiAnRScsIGNocig3MCkgPT4gJ0YnLCBjaHIoNzEpID0+ICdHJywKCQkJY2hyKDcyKSA9PiAnSCcsIGNocig3MykgPT4gJ0knLCBjaHIoNzQpID0+ICdKJywgY2hyKDc1KSA9PiAnSycsCgkJCWNocig3NikgPT4gJ0wnLCBjaHIoNzcpID0+ICdNJywgY2hyKDc4KSA9PiAnTicsIGNocig3OSkgPT4gJ08nLAoJCQljaHIoODApID0+ICdQJywgY2hyKDgxKSA9PiAnUScsIGNocig4MikgPT4gJ1InLCBjaHIoODMpID0+ICdTJywKCQkJY2hyKDg0KSA9PiAnVCcsIGNocig4NSkgPT4gJ1UnLCBjaHIoODYpID0+ICdWJywgY2hyKDg3KSA9PiAnVycsCgkJCWNocig4OCkgPT4gJ1gnLCBjaHIoODkpID0+ICdZJywgY2hyKDkwKSA9PiAnWicsIGNocig5MSkgPT4gY2hyKDEzMSkuJ0snLAoJCQljaHIoOTIpID0+IGNocigxMzEpLidMJywgY2hyKDkzKSA9PiBjaHIoMTMxKS4nTScsIGNocig5NCkgPT4gY2hyKDEzMSkuJ04nLCBjaHIoOTUpID0+IGNocigxMzEpLidPJywKCQkJY2hyKDk2KSA9PiBjaHIoMTMxKS4nVycsIGNocig5NykgPT4gY2hyKDEzMCkuJ0EnLCBjaHIoOTgpID0+IGNocigxMzApLidCJywgY2hyKDk5KSA9PiBjaHIoMTMwKS4nQycsCgkJCWNocigxMDApID0+IGNocigxMzApLidEJywgY2hyKDEwMSkgPT4gY2hyKDEzMCkuJ0UnLCBjaHIoMTAyKSA9PiBjaHIoMTMwKS4nRicsIGNocigxMDMpID0+IGNocigxMzApLidHJywKCQkJY2hyKDEwNCkgPT4gY2hyKDEzMCkuJ0gnLCBjaHIoMTA1KSA9PiBjaHIoMTMwKS4nSScsIGNocigxMDYpID0+IGNocigxMzApLidKJywgY2hyKDEwNykgPT4gY2hyKDEzMCkuJ0snLAoJCQljaHIoMTA4KSA9PiBjaHIoMTMwKS4nTCcsIGNocigxMDkpID0+IGNocigxMzApLidNJywgY2hyKDExMCkgPT4gY2hyKDEzMCkuJ04nLCBjaHIoMTExKSA9PiBjaHIoMTMwKS4nTycsCgkJCWNocigxMTIpID0+IGNocigxMzApLidQJywgY2hyKDExMykgPT4gY2hyKDEzMCkuJ1EnLCBjaHIoMTE0KSA9PiBjaHIoMTMwKS4nUicsIGNocigxMTUpID0+IGNocigxMzApLidTJywKCQkJY2hyKDExNikgPT4gY2hyKDEzMCkuJ1QnLCBjaHIoMTE3KSA9PiBjaHIoMTMwKS4nVScsIGNocigxMTgpID0+IGNocigxMzApLidWJywgY2hyKDExOSkgPT4gY2hyKDEzMCkuJ1cnLAoJCQljaHIoMTIwKSA9PiBjaHIoMTMwKS4nWCcsIGNocigxMjEpID0+IGNocigxMzApLidZJywgY2hyKDEyMikgPT4gY2hyKDEzMCkuJ1onLCBjaHIoMTIzKSA9PiBjaHIoMTMxKS4nUCcsCgkJCWNocigxMjQpID0+IGNocigxMzEpLidRJywgY2hyKDEyNSkgPT4gY2hyKDEzMSkuJ1InLCBjaHIoMTI2KSA9PiBjaHIoMTMxKS4nUycsIGNocigxMjcpID0+IGNocigxMzEpLidUJyk7CgkJJGNvZGVfZXh0ID0gJyc7CgkJJGNsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCWZvciAoJGkgPSAwIDsgJGkgPCAkY2xlbjsgKyskaSkgewoJCQlpZiAob3JkKCRjb2RlWyRpXSkgPiAxMjcpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQkkY29kZV9leHQgLj0gJGVuY29kZVskY29kZVskaV1dOwoJCX0KCQkvLyBjaGVja3N1bQoJCSRjb2RlX2V4dCAuPSAkdGhpcy0+Y2hlY2tzdW1fY29kZTkzKCRjb2RlX2V4dCk7CgkJLy8gYWRkIHN0YXJ0IGFuZCBzdG9wIGNvZGVzCgkJJGNvZGUgPSAnKicuJGNvZGVfZXh0LicqJzsKCQkkYmFyYXJyYXkgPSBhcnJheSgnY29kZScgPT4gJGNvZGUsICdtYXh3JyA9PiAwLCAnbWF4aCcgPT4gMSwgJ2Jjb2RlJyA9PiBhcnJheSgpKTsKCQkkayA9IDA7CgkJJGNsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCWZvciAoJGkgPSAwOyAkaSA8ICRjbGVuOyArKyRpKSB7CgkJCSRjaGFyID0gb3JkKCRjb2RlWyRpXSk7CgkJCWlmKCFpc3NldCgkY2hyWyRjaGFyXSkpIHsKCQkJCS8vIGludmFsaWQgY2hhcmFjdGVyCgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJZm9yICgkaiA9IDA7ICRqIDwgNjsgKyskaikgewoJCQkJaWYgKCgkaiAlIDIpID09IDApIHsKCQkJCQkkdCA9IHRydWU7IC8vIGJhcgoJCQkJfSBlbHNlIHsKCQkJCQkkdCA9IGZhbHNlOyAvLyBzcGFjZQoJCQkJfQoJCQkJJHcgPSAkY2hyWyRjaGFyXVskal07CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGtdID0gYXJyYXkoJ3QnID0+ICR0LCAndycgPT4gJHcsICdoJyA9PiAxLCAncCcgPT4gMCk7CgkJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAkdzsKCQkJCSsrJGs7CgkJCX0KCQl9CgkJJGJhcmFycmF5WydiY29kZSddWyRrXSA9IGFycmF5KCd0JyA9PiB0cnVlLCAndycgPT4gMSwgJ2gnID0+IDEsICdwJyA9PiAwKTsKCQkkYmFyYXJyYXlbJ21heHcnXSArPSAxOwoJCSsrJGs7CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIENhbGN1bGF0ZSBDT0RFIDkzIGNoZWNrc3VtIChtb2R1bG8gNDcpLgoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEByZXR1cm4gc3RyaW5nIGNoZWNrc3VtIGNvZGUuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBjaGVja3N1bV9jb2RlOTMoJGNvZGUpIHsKCQkkY2hhcnMgPSBhcnJheSgKCQkJJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknLAoJCQknQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0knLCAnSicsICdLJywKCQkJJ0wnLCAnTScsICdOJywgJ08nLCAnUCcsICdRJywgJ1InLCAnUycsICdUJywgJ1UnLCAnVicsCgkJCSdXJywgJ1gnLCAnWScsICdaJywgJy0nLCAnLicsICcgJywgJyQnLCAnLycsICcrJywgJyUnLAoJCQknPCcsICc9JywgJz4nLCAnPycpOwoJCS8vIHRyYW5zbGF0ZSBzcGVjaWFsIGNoYXJhY3RlcnMKCQkkY29kZSA9IHN0cnRyKCRjb2RlLCBjaHIoMTI4KS5jaHIoMTMxKS5jaHIoMTI5KS5jaHIoMTMwKSwgJzw9Pj8nKTsKCQkkbGVuID0gc3RybGVuKCRjb2RlKTsKCQkvLyBjYWxjdWxhdGUgY2hlY2sgZGlnaXQgQwoJCSRwID0gMTsKCQkkY2hlY2sgPSAwOwoJCWZvciAoJGkgPSAoJGxlbiAtIDEpOyAkaSA+PSAwOyAtLSRpKSB7CgkJCSRrID0gYXJyYXlfa2V5cygkY2hhcnMsICRjb2RlWyRpXSk7CgkJCSRjaGVjayArPSAoJGtbMF0gKiAkcCk7CgkJCSsrJHA7CgkJCWlmICgkcCA+IDIwKSB7CgkJCQkkcCA9IDE7CgkJCX0KCQl9CgkJJGNoZWNrICU9IDQ3OwoJCSRjID0gJGNoYXJzWyRjaGVja107CgkJJGNvZGUgLj0gJGM7CgkJLy8gY2FsY3VsYXRlIGNoZWNrIGRpZ2l0IEsKCQkkcCA9IDE7CgkJJGNoZWNrID0gMDsKCQlmb3IgKCRpID0gJGxlbjsgJGkgPj0gMDsgLS0kaSkgewoJCQkkayA9IGFycmF5X2tleXMoJGNoYXJzLCAkY29kZVskaV0pOwoJCQkkY2hlY2sgKz0gKCRrWzBdICogJHApOwoJCQkrKyRwOwoJCQlpZiAoJHAgPiAxNSkgewoJCQkJJHAgPSAxOwoJCQl9CgkJfQoJCSRjaGVjayAlPSA0NzsKCQkkayA9ICRjaGFyc1skY2hlY2tdOwoJCSRjaGVja3N1bSA9ICRjLiRrOwoJCS8vIHJlc3RvIHJlc3BlY2lhbCBjaGFyYWN0ZXJzCgkJJGNoZWNrc3VtID0gc3RydHIoJGNoZWNrc3VtLCAnPD0+PycsIGNocigxMjgpLmNocigxMzEpLmNocigxMjkpLmNocigxMzApKTsKCQlyZXR1cm4gJGNoZWNrc3VtOwoJfQoKCS8qKgoJICogQ2hlY2tzdW0gZm9yIHN0YW5kYXJkIDIgb2YgNSBiYXJjb2Rlcy4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byBwcm9jZXNzLgoJICogQHJldHVybiBpbnQgY2hlY2tzdW0uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBjaGVja3N1bV9zMjUoJGNvZGUpIHsKCQkkbGVuID0gc3RybGVuKCRjb2RlKTsKCQkkc3VtID0gMDsKCQlmb3IgKCRpID0gMDsgJGkgPCAkbGVuOyAkaSs9MikgewoJCQkkc3VtICs9ICRjb2RlWyRpXTsKCQl9CgkJJHN1bSAqPSAzOwoJCWZvciAoJGkgPSAxOyAkaSA8ICRsZW47ICRpKz0yKSB7CgkJCSRzdW0gKz0gKCRjb2RlWyRpXSk7CgkJfQoJCSRyID0gJHN1bSAlIDEwOwoJCWlmKCRyID4gMCkgewoJCQkkciA9ICgxMCAtICRyKTsKCQl9CgkJcmV0dXJuICRyOwoJfQoKCS8qKgoJICogTVNJLgoJICogVmFyaWF0aW9uIG9mIFBsZXNzZXkgY29kZSwgd2l0aCBzaW1pbGFyIGFwcGxpY2F0aW9ucwoJICogQ29udGFpbnMgZGlnaXRzICgwIHRvIDkpIGFuZCBlbmNvZGVzIHRoZSBkYXRhIG9ubHkgaW4gdGhlIHdpZHRoIG9mIGJhcnMuCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gcmVwcmVzZW50LgoJICogQHBhcmFtIGJvb2xlYW4gJGNoZWNrc3VtIGlmIHRydWUgYWRkIGEgY2hlY2tzdW0gdG8gdGhlIGNvZGUgKG1vZHVsbyAxMSkKCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfbXNpKCRjb2RlLCAkY2hlY2tzdW09ZmFsc2UpIHsKCQkkY2hyWycwJ10gPSAnMTAwMTAwMTAwMTAwJzsKCQkkY2hyWycxJ10gPSAnMTAwMTAwMTAwMTEwJzsKCQkkY2hyWycyJ10gPSAnMTAwMTAwMTEwMTAwJzsKCQkkY2hyWyczJ10gPSAnMTAwMTAwMTEwMTEwJzsKCQkkY2hyWyc0J10gPSAnMTAwMTEwMTAwMTAwJzsKCQkkY2hyWyc1J10gPSAnMTAwMTEwMTAwMTEwJzsKCQkkY2hyWyc2J10gPSAnMTAwMTEwMTEwMTAwJzsKCQkkY2hyWyc3J10gPSAnMTAwMTEwMTEwMTEwJzsKCQkkY2hyWyc4J10gPSAnMTEwMTAwMTAwMTAwJzsKCQkkY2hyWyc5J10gPSAnMTEwMTAwMTAwMTEwJzsKCQkkY2hyWydBJ10gPSAnMTEwMTAwMTEwMTAwJzsKCQkkY2hyWydCJ10gPSAnMTEwMTAwMTEwMTEwJzsKCQkkY2hyWydDJ10gPSAnMTEwMTEwMTAwMTAwJzsKCQkkY2hyWydEJ10gPSAnMTEwMTEwMTAwMTEwJzsKCQkkY2hyWydFJ10gPSAnMTEwMTEwMTEwMTAwJzsKCQkkY2hyWydGJ10gPSAnMTEwMTEwMTEwMTEwJzsKCQlpZiAoJGNoZWNrc3VtKSB7CgkJCS8vIGFkZCBjaGVja3N1bQoJCQkkY2xlbiA9IHN0cmxlbigkY29kZSk7CgkJCSRwID0gMjsKCQkJJGNoZWNrID0gMDsKCQkJZm9yICgkaSA9ICgkY2xlbiAtIDEpOyAkaSA+PSAwOyAtLSRpKSB7CgkJCQkkY2hlY2sgKz0gKGhleGRlYygkY29kZVskaV0pICogJHApOwoJCQkJKyskcDsKCQkJCWlmICgkcCA+IDcpIHsKCQkJCQkkcCA9IDI7CgkJCQl9CgkJCX0KCQkJJGNoZWNrICU9IDExOwoJCQlpZiAoJGNoZWNrID4gMCkgewoJCQkJJGNoZWNrID0gMTEgLSAkY2hlY2s7CgkJCX0KCQkJJGNvZGUgLj0gJGNoZWNrOwoJCX0KCQkkc2VxID0gJzExMCc7IC8vIGxlZnQgZ3VhcmQKCQkkY2xlbiA9IHN0cmxlbigkY29kZSk7CgkJZm9yICgkaSA9IDA7ICRpIDwgJGNsZW47ICsrJGkpIHsKCQkJJGRpZ2l0ID0gJGNvZGVbJGldOwoJCQlpZiAoIWlzc2V0KCRjaHJbJGRpZ2l0XSkpIHsKCQkJCS8vIGludmFsaWQgY2hhcmFjdGVyCgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJJHNlcSAuPSAkY2hyWyRkaWdpdF07CgkJfQoJCSRzZXEgLj0gJzEwMDEnOyAvLyByaWdodCBndWFyZAoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAxLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCXJldHVybiAkdGhpcy0+Ymluc2VxX3RvX2FycmF5KCRzZXEsICRiYXJhcnJheSk7Cgl9CgoJLyoqCgkgKiBTdGFuZGFyZCAyIG9mIDUgYmFyY29kZXMuCgkgKiBVc2VkIGluIGFpcmxpbmUgdGlja2V0IG1hcmtpbmcsIHBob3RvZmluaXNoaW5nCgkgKiBDb250YWlucyBkaWdpdHMgKDAgdG8gOSkgYW5kIGVuY29kZXMgdGhlIGRhdGEgb25seSBpbiB0aGUgd2lkdGggb2YgYmFycy4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQuCgkgKiBAcGFyYW0gYm9vbGVhbiAkY2hlY2tzdW0gaWYgdHJ1ZSBhZGQgYSBjaGVja3N1bSB0byB0aGUgY29kZQoJICogQHJldHVybiBhcnJheSBiYXJjb2RlIHJlcHJlc2VudGF0aW9uLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gYmFyY29kZV9zMjUoJGNvZGUsICRjaGVja3N1bT1mYWxzZSkgewoJCSRjaHJbJzAnXSA9ICcxMDEwMTExMDExMTAxMCc7CgkJJGNoclsnMSddID0gJzExMTAxMDEwMTAxMTEwJzsKCQkkY2hyWycyJ10gPSAnMTAxMTEwMTAxMDExMTAnOwoJCSRjaHJbJzMnXSA9ICcxMTEwMTExMDEwMTAxMCc7CgkJJGNoclsnNCddID0gJzEwMTAxMTEwMTAxMTEwJzsKCQkkY2hyWyc1J10gPSAnMTExMDEwMTExMDEwMTAnOwoJCSRjaHJbJzYnXSA9ICcxMDExMTAxMTEwMTAxMCc7CgkJJGNoclsnNyddID0gJzEwMTAxMDExMTAxMTEwJzsKCQkkY2hyWyc4J10gPSAnMTExMDEwMTAxMTEwMTAnOwoJCSRjaHJbJzknXSA9ICcxMDExMTAxMDExMTAxMCc7CgkJaWYgKCRjaGVja3N1bSkgewoJCQkvLyBhZGQgY2hlY2tzdW0KCQkJJGNvZGUgLj0gJHRoaXMtPmNoZWNrc3VtX3MyNSgkY29kZSk7CgkJfQoJCWlmKChzdHJsZW4oJGNvZGUpICUgMikgIT0gMCkgewoJCQkvLyBhZGQgbGVhZGluZyB6ZXJvIGlmIGNvZGUtbGVuZ3RoIGlzIG9kZAoJCQkkY29kZSA9ICcwJy4kY29kZTsKCQl9CgkJJHNlcSA9ICcxMTEwMTExMDEwJzsKCQkkY2xlbiA9IHN0cmxlbigkY29kZSk7CgkJZm9yICgkaSA9IDA7ICRpIDwgJGNsZW47ICsrJGkpIHsKCQkJJGRpZ2l0ID0gJGNvZGVbJGldOwoJCQlpZiAoIWlzc2V0KCRjaHJbJGRpZ2l0XSkpIHsKCQkJCS8vIGludmFsaWQgY2hhcmFjdGVyCgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJJHNlcSAuPSAkY2hyWyRkaWdpdF07CgkJfQoJCSRzZXEgLj0gJzExMTAxMDExMSc7CgkJJGJhcmFycmF5ID0gYXJyYXkoJ2NvZGUnID0+ICRjb2RlLCAnbWF4dycgPT4gMCwgJ21heGgnID0+IDEsICdiY29kZScgPT4gYXJyYXkoKSk7CgkJcmV0dXJuICR0aGlzLT5iaW5zZXFfdG9fYXJyYXkoJHNlcSwgJGJhcmFycmF5KTsKCX0KCgkvKioKCSAqIENvbnZlcnQgYmluYXJ5IGJhcmNvZGUgc2VxdWVuY2UgdG8gV2Fybm9ja1BERiBiYXJjb2RlIGFycmF5LgoJICogQHBhcmFtIHN0cmluZyAkc2VxIGJhcmNvZGUgYXMgYmluYXJ5IHNlcXVlbmNlLgoJICogQHBhcmFtIGFycmF5ICRiYXJhcnJheSBiYXJjb2RlIGFycmF5IHRvIGZpbGwgdXAKCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJpbnNlcV90b19hcnJheSgkc2VxLCAkYmFyYXJyYXkpIHsKCQkkbGVuID0gc3RybGVuKCRzZXEpOwoJCSR3ID0gMDsKCQkkayA9IDA7CgkJZm9yICgkaSA9IDA7ICRpIDwgJGxlbjsgKyskaSkgewoJCQkkdyArPSAxOwoJCQlpZiAoKCRpID09ICgkbGVuIC0gMSkpIE9SICgoJGkgPCAoJGxlbiAtIDEpKSBBTkQgKCRzZXFbJGldICE9ICRzZXFbKCRpKzEpXSkpKSB7CgkJCQlpZiAoJHNlcVskaV0gPT0gJzEnKSB7CgkJCQkJJHQgPSB0cnVlOyAvLyBiYXIKCQkJCX0gZWxzZSB7CgkJCQkJJHQgPSBmYWxzZTsgLy8gc3BhY2UKCQkJCX0KCQkJCSRiYXJhcnJheVsnYmNvZGUnXVska10gPSBhcnJheSgndCcgPT4gJHQsICd3JyA9PiAkdywgJ2gnID0+IDEsICdwJyA9PiAwKTsKCQkJCSRiYXJhcnJheVsnbWF4dyddICs9ICR3OwoJCQkJKyskazsKCQkJCSR3ID0gMDsKCQkJfQoJCX0KCQlyZXR1cm4gJGJhcmFycmF5OwoJfQoKCS8qKgoJICogSW50ZXJsZWF2ZWQgMiBvZiA1IGJhcmNvZGVzLgoJICogQ29tcGFjdCBudW1lcmljIGNvZGUsIHdpZGVseSB1c2VkIGluIGluZHVzdHJ5LCBhaXIgY2FyZ28KCSAqIENvbnRhaW5zIGRpZ2l0cyAoMCB0byA5KSBhbmQgZW5jb2RlcyB0aGUgZGF0YSBpbiB0aGUgd2lkdGggb2YgYm90aCBiYXJzIGFuZCBzcGFjZXMuCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gcmVwcmVzZW50LgoJICogQHBhcmFtIGJvb2xlYW4gJGNoZWNrc3VtIGlmIHRydWUgYWRkIGEgY2hlY2tzdW0gdG8gdGhlIGNvZGUKCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfaTI1KCRjb2RlLCAkY2hlY2tzdW09ZmFsc2UpIHsKCQkkY2hyWycwJ10gPSAnMTEyMjEnOwoJCSRjaHJbJzEnXSA9ICcyMTExMic7CgkJJGNoclsnMiddID0gJzEyMTEyJzsKCQkkY2hyWyczJ10gPSAnMjIxMTEnOwoJCSRjaHJbJzQnXSA9ICcxMTIxMic7CgkJJGNoclsnNSddID0gJzIxMjExJzsKCQkkY2hyWyc2J10gPSAnMTIyMTEnOwoJCSRjaHJbJzcnXSA9ICcxMTEyMic7CgkJJGNoclsnOCddID0gJzIxMTIxJzsKCQkkY2hyWyc5J10gPSAnMTIxMjEnOwoJCSRjaHJbJ0EnXSA9ICcxMSc7CgkJJGNoclsnWiddID0gJzIxJzsKCQlpZiAoJGNoZWNrc3VtKSB7CgkJCS8vIGFkZCBjaGVja3N1bQoJCQkkY29kZSAuPSAkdGhpcy0+Y2hlY2tzdW1fczI1KCRjb2RlKTsKCQl9CgkJaWYoKHN0cmxlbigkY29kZSkgJSAyKSAhPSAwKSB7CgkJCS8vIGFkZCBsZWFkaW5nIHplcm8gaWYgY29kZS1sZW5ndGggaXMgb2RkCgkJCSRjb2RlID0gJzAnLiRjb2RlOwoJCX0KCQkvLyBhZGQgc3RhcnQgYW5kIHN0b3AgY29kZXMKCQkkY29kZSA9ICdBQScuc3RydG9sb3dlcigkY29kZSkuJ1pBJzsKCgkJJGJhcmFycmF5ID0gYXJyYXkoJ2NvZGUnID0+ICRjb2RlLCAnbWF4dycgPT4gMCwgJ21heGgnID0+IDEsICdiY29kZScgPT4gYXJyYXkoKSk7CgkJJGsgPSAwOwoJCSRjbGVuID0gc3RybGVuKCRjb2RlKTsKCQlmb3IgKCRpID0gMDsgJGkgPCAkY2xlbjsgJGkgPSAoJGkgKyAyKSkgewoJCQkkY2hhcl9iYXIgPSAkY29kZVskaV07CgkJCSRjaGFyX3NwYWNlID0gJGNvZGVbJGkrMV07CgkJCWlmKCghaXNzZXQoJGNoclskY2hhcl9iYXJdKSkgT1IgKCFpc3NldCgkY2hyWyRjaGFyX3NwYWNlXSkpKSB7CgkJCQkvLyBpbnZhbGlkIGNoYXJhY3RlcgoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCS8vIGNyZWF0ZSBhIGJhci1zcGFjZSBzZXF1ZW5jZQoJCQkkc2VxID0gJyc7CgkJCSRjaHJsZW4gPSBzdHJsZW4oJGNoclskY2hhcl9iYXJdKTsKCQkJZm9yICgkcyA9IDA7ICRzIDwgJGNocmxlbjsgJHMrKyl7CgkJCQkkc2VxIC49ICRjaHJbJGNoYXJfYmFyXVskc10gLiAkY2hyWyRjaGFyX3NwYWNlXVskc107CgkJCX0KCQkJJHNlcWxlbiA9IHN0cmxlbigkc2VxKTsKCQkJZm9yICgkaiA9IDA7ICRqIDwgJHNlcWxlbjsgKyskaikgewoJCQkJaWYgKCgkaiAlIDIpID09IDApIHsKCQkJCQkkdCA9IHRydWU7IC8vIGJhcgoJCQkJfSBlbHNlIHsKCQkJCQkkdCA9IGZhbHNlOyAvLyBzcGFjZQoJCQkJfQoJCQkJJHcgPSAoZmxvYXQpJHNlcVskal07CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGtdID0gYXJyYXkoJ3QnID0+ICR0LCAndycgPT4gJHcsICdoJyA9PiAxLCAncCcgPT4gMCk7CgkJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAkdzsKCQkJCSsrJGs7CgkJCX0KCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIEMxMjggYmFyY29kZXMuCgkgKiBWZXJ5IGNhcGFibGUgY29kZSwgZXhjZWxsZW50IGRlbnNpdHksIGhpZ2ggcmVsaWFiaWxpdHk7IGluIHZlcnkgd2lkZSB1c2Ugd29ybGQtd2lkZQoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEBwYXJhbSBzdHJpbmcgJHR5cGUgYmFyY29kZSB0eXBlOiBBLCBCLCBDIG9yIGVtcHR5IGZvciBhdXRvbWF0aWMgc3dpdGNoIChBVVRPIG1vZGUpCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX2MxMjgoJGNvZGUsICR0eXBlPScnKSB7CgkJJGNociA9IGFycmF5KAoJCQknMjEyMjIyJywgLyogMDAgKi8KCQkJJzIyMjEyMicsIC8qIDAxICovCgkJCScyMjIyMjEnLCAvKiAwMiAqLwoJCQknMTIxMjIzJywgLyogMDMgKi8KCQkJJzEyMTMyMicsIC8qIDA0ICovCgkJCScxMzEyMjInLCAvKiAwNSAqLwoJCQknMTIyMjEzJywgLyogMDYgKi8KCQkJJzEyMjMxMicsIC8qIDA3ICovCgkJCScxMzIyMTInLCAvKiAwOCAqLwoJCQknMjIxMjEzJywgLyogMDkgKi8KCQkJJzIyMTMxMicsIC8qIDEwICovCgkJCScyMzEyMTInLCAvKiAxMSAqLwoJCQknMTEyMjMyJywgLyogMTIgKi8KCQkJJzEyMjEzMicsIC8qIDEzICovCgkJCScxMjIyMzEnLCAvKiAxNCAqLwoJCQknMTEzMjIyJywgLyogMTUgKi8KCQkJJzEyMzEyMicsIC8qIDE2ICovCgkJCScxMjMyMjEnLCAvKiAxNyAqLwoJCQknMjIzMjExJywgLyogMTggKi8KCQkJJzIyMTEzMicsIC8qIDE5ICovCgkJCScyMjEyMzEnLCAvKiAyMCAqLwoJCQknMjEzMjEyJywgLyogMjEgKi8KCQkJJzIyMzExMicsIC8qIDIyICovCgkJCSczMTIxMzEnLCAvKiAyMyAqLwoJCQknMzExMjIyJywgLyogMjQgKi8KCQkJJzMyMTEyMicsIC8qIDI1ICovCgkJCSczMjEyMjEnLCAvKiAyNiAqLwoJCQknMzEyMjEyJywgLyogMjcgKi8KCQkJJzMyMjExMicsIC8qIDI4ICovCgkJCSczMjIyMTEnLCAvKiAyOSAqLwoJCQknMjEyMTIzJywgLyogMzAgKi8KCQkJJzIxMjMyMScsIC8qIDMxICovCgkJCScyMzIxMjEnLCAvKiAzMiAqLwoJCQknMTExMzIzJywgLyogMzMgKi8KCQkJJzEzMTEyMycsIC8qIDM0ICovCgkJCScxMzEzMjEnLCAvKiAzNSAqLwoJCQknMTEyMzEzJywgLyogMzYgKi8KCQkJJzEzMjExMycsIC8qIDM3ICovCgkJCScxMzIzMTEnLCAvKiAzOCAqLwoJCQknMjExMzEzJywgLyogMzkgKi8KCQkJJzIzMTExMycsIC8qIDQwICovCgkJCScyMzEzMTEnLCAvKiA0MSAqLwoJCQknMTEyMTMzJywgLyogNDIgKi8KCQkJJzExMjMzMScsIC8qIDQzICovCgkJCScxMzIxMzEnLCAvKiA0NCAqLwoJCQknMTEzMTIzJywgLyogNDUgKi8KCQkJJzExMzMyMScsIC8qIDQ2ICovCgkJCScxMzMxMjEnLCAvKiA0NyAqLwoJCQknMzEzMTIxJywgLyogNDggKi8KCQkJJzIxMTMzMScsIC8qIDQ5ICovCgkJCScyMzExMzEnLCAvKiA1MCAqLwoJCQknMjEzMTEzJywgLyogNTEgKi8KCQkJJzIxMzMxMScsIC8qIDUyICovCgkJCScyMTMxMzEnLCAvKiA1MyAqLwoJCQknMzExMTIzJywgLyogNTQgKi8KCQkJJzMxMTMyMScsIC8qIDU1ICovCgkJCSczMzExMjEnLCAvKiA1NiAqLwoJCQknMzEyMTEzJywgLyogNTcgKi8KCQkJJzMxMjMxMScsIC8qIDU4ICovCgkJCSczMzIxMTEnLCAvKiA1OSAqLwoJCQknMzE0MTExJywgLyogNjAgKi8KCQkJJzIyMTQxMScsIC8qIDYxICovCgkJCSc0MzExMTEnLCAvKiA2MiAqLwoJCQknMTExMjI0JywgLyogNjMgKi8KCQkJJzExMTQyMicsIC8qIDY0ICovCgkJCScxMjExMjQnLCAvKiA2NSAqLwoJCQknMTIxNDIxJywgLyogNjYgKi8KCQkJJzE0MTEyMicsIC8qIDY3ICovCgkJCScxNDEyMjEnLCAvKiA2OCAqLwoJCQknMTEyMjE0JywgLyogNjkgKi8KCQkJJzExMjQxMicsIC8qIDcwICovCgkJCScxMjIxMTQnLCAvKiA3MSAqLwoJCQknMTIyNDExJywgLyogNzIgKi8KCQkJJzE0MjExMicsIC8qIDczICovCgkJCScxNDIyMTEnLCAvKiA3NCAqLwoJCQknMjQxMjExJywgLyogNzUgKi8KCQkJJzIyMTExNCcsIC8qIDc2ICovCgkJCSc0MTMxMTEnLCAvKiA3NyAqLwoJCQknMjQxMTEyJywgLyogNzggKi8KCQkJJzEzNDExMScsIC8qIDc5ICovCgkJCScxMTEyNDInLCAvKiA4MCAqLwoJCQknMTIxMTQyJywgLyogODEgKi8KCQkJJzEyMTI0MScsIC8qIDgyICovCgkJCScxMTQyMTInLCAvKiA4MyAqLwoJCQknMTI0MTEyJywgLyogODQgKi8KCQkJJzEyNDIxMScsIC8qIDg1ICovCgkJCSc0MTEyMTInLCAvKiA4NiAqLwoJCQknNDIxMTEyJywgLyogODcgKi8KCQkJJzQyMTIxMScsIC8qIDg4ICovCgkJCScyMTIxNDEnLCAvKiA4OSAqLwoJCQknMjE0MTIxJywgLyogOTAgKi8KCQkJJzQxMjEyMScsIC8qIDkxICovCgkJCScxMTExNDMnLCAvKiA5MiAqLwoJCQknMTExMzQxJywgLyogOTMgKi8KCQkJJzEzMTE0MScsIC8qIDk0ICovCgkJCScxMTQxMTMnLCAvKiA5NSAqLwoJCQknMTE0MzExJywgLyogOTYgKi8KCQkJJzQxMTExMycsIC8qIDk3ICovCgkJCSc0MTEzMTEnLCAvKiA5OCAqLwoJCQknMTEzMTQxJywgLyogOTkgKi8KCQkJJzExNDEzMScsIC8qIDEwMCAqLwoJCQknMzExMTQxJywgLyogMTAxICovCgkJCSc0MTExMzEnLCAvKiAxMDIgKi8KCQkJJzIxMTQxMicsIC8qIDEwMyBTVEFSVCBBICovCgkJCScyMTEyMTQnLCAvKiAxMDQgU1RBUlQgQiAqLwoJCQknMjExMjMyJywgLyogMTA1IFNUQVJUIEMgKi8KCQkJJzIzMzExMScsIC8qIFNUT1AgKi8KCQkJJzIwMDAwMCcgIC8qIEVORCAqLwoJCSk7CgkJLy8gQVNDSUkgY2hhcmFjdGVycyBmb3IgY29kZSBBIChBU0NJSSAwMCAtIDk1KQoJCSRrZXlzX2EgPSAnICEiIyQlJlwnKCkqKywtLi8wMTIzNDU2Nzg5Ojs8PT4/QEFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaW1xcXV5fJzsKCQkka2V5c19hIC49IGNocigwKS5jaHIoMSkuY2hyKDIpLmNocigzKS5jaHIoNCkuY2hyKDUpLmNocig2KS5jaHIoNykuY2hyKDgpLmNocig5KTsKCQkka2V5c19hIC49IGNocigxMCkuY2hyKDExKS5jaHIoMTIpLmNocigxMykuY2hyKDE0KS5jaHIoMTUpLmNocigxNikuY2hyKDE3KS5jaHIoMTgpLmNocigxOSk7CgkJJGtleXNfYSAuPSBjaHIoMjApLmNocigyMSkuY2hyKDIyKS5jaHIoMjMpLmNocigyNCkuY2hyKDI1KS5jaHIoMjYpLmNocigyNykuY2hyKDI4KS5jaHIoMjkpOwoJCSRrZXlzX2EgLj0gY2hyKDMwKS5jaHIoMzEpOwoJCS8vIEFTQ0lJIGNoYXJhY3RlcnMgZm9yIGNvZGUgQiAoQVNDSUkgMzIgLSAxMjcpCgkJJGtleXNfYiA9ICcgISIjJCUmXCcoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj9AQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXFxdXl9gYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXp7fH1+Jy5jaHIoMTI3KTsKCQkvLyBzcGVjaWFsIGNvZGVzCgkJJGZuY19hID0gYXJyYXkoMjQxID0+IDEwMiwgMjQyID0+IDk3LCAyNDMgPT4gOTYsIDI0NCA9PiAxMDEpOwoJCSRmbmNfYiA9IGFycmF5KDI0MSA9PiAxMDIsIDI0MiA9PiA5NywgMjQzID0+IDk2LCAyNDQgPT4gMTAwKTsKCQkvLyBhcnJheSBvZiBzeW1ib2xzCgkJJGNvZGVfZGF0YSA9IGFycmF5KCk7CgkJLy8gbGVuZ3RoIG9mIHRoZSBjb2RlCgkJJGxlbiA9IHN0cmxlbigkY29kZSk7CgkJc3dpdGNoKHN0cnRvdXBwZXIoJHR5cGUpKSB7CgkJCWNhc2UgJ0EnOiB7IC8vIE1PREUgQQoJCQkJJHN0YXJ0aWQgPSAxMDM7CgkJCQlmb3IgKCRpID0gMDsgJGkgPCAkbGVuOyArKyRpKSB7CgkJCQkJJGNoYXIgPSAkY29kZVskaV07CgkJCQkJJGNoYXJfaWQgPSBvcmQoJGNoYXIpOwoJCQkJCWlmICgoJGNoYXJfaWQgPj0gMjQxKSBBTkQgKCRjaGFyX2lkIDw9IDI0NCkpIHsKCQkJCQkJJGNvZGVfZGF0YVtdID0gJGZuY19hWyRjaGFyX2lkXTsKCQkJCQl9IGVsc2VpZiAoKCRjaGFyX2lkID49IDApIEFORCAoJGNoYXJfaWQgPD0gOTUpKSB7CgkJCQkJCSRjb2RlX2RhdGFbXSA9IHN0cnBvcygka2V5c19hLCAkY2hhcik7CgkJCQkJfSBlbHNlIHsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0KCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgJ0InOiB7IC8vIE1PREUgQgoJCQkJJHN0YXJ0aWQgPSAxMDQ7CgkJCQlmb3IgKCRpID0gMDsgJGkgPCAkbGVuOyArKyRpKSB7CgkJCQkJJGNoYXIgPSAkY29kZVskaV07CgkJCQkJJGNoYXJfaWQgPSBvcmQoJGNoYXIpOwoJCQkJCWlmICgoJGNoYXJfaWQgPj0gMjQxKSBBTkQgKCRjaGFyX2lkIDw9IDI0NCkpIHsKCQkJCQkJJGNvZGVfZGF0YVtdID0gJGZuY19iWyRjaGFyX2lkXTsKCQkJCQl9IGVsc2VpZiAoKCRjaGFyX2lkID49IDMyKSBBTkQgKCRjaGFyX2lkIDw9IDEyNykpIHsKCQkJCQkJJGNvZGVfZGF0YVtdID0gc3RycG9zKCRrZXlzX2IsICRjaGFyKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfQoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAnQyc6IHsgLy8gTU9ERSBDCgkJCQkkc3RhcnRpZCA9IDEwNTsKCQkJCWlmIChvcmQoJGNvZGVbMF0pID09IDI0MSkgewoJCQkJCSRjb2RlX2RhdGFbXSA9IDEwMjsKCQkJCQkkY29kZSA9IHN1YnN0cigkY29kZSwgMSk7CgkJCQkJLS0kbGVuOwoJCQkJfQoJCQkJaWYgKCgkbGVuICUgMikgIT0gMCkgewoJCQkJCS8vIHRoZSBsZW5ndGggbXVzdCBiZSBldmVuCgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQkJZm9yICgkaSA9IDA7ICRpIDwgJGxlbjsgJGkrPTIpIHsKCQkJCQkkY2hybnVtID0gJGNvZGVbJGldLiRjb2RlWyRpKzFdOwoJCQkJCWlmIChwcmVnX21hdGNoKCcvKFswLTldezJ9KS8nLCAkY2hybnVtKSA+IDApIHsKCQkJCQkJJGNvZGVfZGF0YVtdID0gaW50dmFsKCRjaHJudW0pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9CgkJCQlicmVhazsKCQkJfQoJCQlkZWZhdWx0OiB7IC8vIE1PREUgQVVUTwoJCQkJLy8gc3BsaXQgY29kZSBpbnRvIHNlcXVlbmNlcwoJCQkJJHNlcXVlbmNlID0gYXJyYXkoKTsKCQkJCS8vIGdldCBudW1lcmljIHNlcXVlbmNlcyAoaWYgYW55KQoJCQkJJG51bXNlcSA9IGFycmF5KCk7CgkJCQlwcmVnX21hdGNoX2FsbCgnLyhbMC05XXs0LH0pLycsICRjb2RlLCAkbnVtc2VxLCBQUkVHX09GRlNFVF9DQVBUVVJFKTsKCQkJCWlmIChpc3NldCgkbnVtc2VxWzFdKSBBTkQgIWVtcHR5KCRudW1zZXFbMV0pKSB7CgkJCQkJJGVuZF9vZmZzZXQgPSAwOwoJCQkJCWZvcmVhY2ggKCRudW1zZXFbMV0gYXMgJHZhbCkgewoJCQkJCQkkb2Zmc2V0ID0gJHZhbFsxXTsKCQkJCQkJaWYgKCRvZmZzZXQgPiAkZW5kX29mZnNldCkgewoJCQkJCQkJLy8gbm9uIG51bWVyaWMgc2VxdWVuY2UKCQkJCQkJCSRzZXF1ZW5jZSA9IGFycmF5X21lcmdlKCRzZXF1ZW5jZSwgJHRoaXMtPmdldDEyOEFCc2VxdWVuY2Uoc3Vic3RyKCRjb2RlLCAkZW5kX29mZnNldCwgKCRvZmZzZXQgLSAkZW5kX29mZnNldCkpKSk7CgkJCQkJCX0KCQkJCQkJLy8gbnVtZXJpYyBzZXF1ZW5jZQoJCQkJCQkkc2xlbiA9IHN0cmxlbigkdmFsWzBdKTsKCQkJCQkJaWYgKCgkc2xlbiAlIDIpICE9IDApIHsKCQkJCQkJCS8vIHRoZSBsZW5ndGggbXVzdCBiZSBldmVuCgkJCQkJCQktLSRzbGVuOwoJCQkJCQl9CgkJCQkJCSRzZXF1ZW5jZVtdID0gYXJyYXkoJ0MnLCBzdWJzdHIoJGNvZGUsICRvZmZzZXQsICRzbGVuKSwgJHNsZW4pOwoJCQkJCQkkZW5kX29mZnNldCA9ICRvZmZzZXQgKyAkc2xlbjsKCQkJCQl9CgkJCQkJaWYgKCRlbmRfb2Zmc2V0IDwgJGxlbikgewoJCQkJCQkkc2VxdWVuY2UgPSBhcnJheV9tZXJnZSgkc2VxdWVuY2UsICR0aGlzLT5nZXQxMjhBQnNlcXVlbmNlKHN1YnN0cigkY29kZSwgJGVuZF9vZmZzZXQpKSk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQkvLyB0ZXh0IGNvZGUgKG5vbiBDIG1vZGUpCgkJCQkJJHNlcXVlbmNlID0gYXJyYXlfbWVyZ2UoJHNlcXVlbmNlLCAkdGhpcy0+Z2V0MTI4QUJzZXF1ZW5jZSgkY29kZSkpOwoJCQkJfQoJCQkJLy8gcHJvY2VzcyB0aGUgc2VxdWVuY2UKCQkJCWZvcmVhY2ggKCRzZXF1ZW5jZSBhcyAka2V5ID0+ICRzZXEpIHsKCQkJCQlzd2l0Y2goJHNlcVswXSkgewoJCQkJCQljYXNlICdBJzogewoJCQkJCQkJaWYgKCRrZXkgPT0gMCkgewoJCQkJCQkJCSRzdGFydGlkID0gMTAzOwoJCQkJCQkJfSBlbHNlaWYgKCRzZXF1ZW5jZVsoJGtleSAtIDEpXVswXSAhPSAnQScpIHsKCQkJCQkJCQlpZiAoKCRzZXFbMl0gPT0gMSkgQU5EICgka2V5ID4gMCkgQU5EICgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bMF0gPT0gJ0InKSBBTkQgKCFpc3NldCgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bM10pKSkgewoJCQkJCQkJCQkvLyBzaW5nbGUgY2hhcmFjdGVyIHNoaWZ0CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IDk4OwoJCQkJCQkJCQkvLyBtYXJrIHNoaWZ0CgkJCQkJCQkJCSRzZXF1ZW5jZVska2V5XVszXSA9IHRydWU7CgkJCQkJCQkJfSBlbHNlaWYgKCFpc3NldCgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bM10pKSB7CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IDEwMTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQlmb3IgKCRpID0gMDsgJGkgPCAkc2VxWzJdOyArKyRpKSB7CgkJCQkJCQkJJGNoYXIgPSAkc2VxWzFdWyRpXTsKCQkJCQkJCQkkY2hhcl9pZCA9IG9yZCgkY2hhcik7CgkJCQkJCQkJaWYgKCgkY2hhcl9pZCA+PSAyNDEpIEFORCAoJGNoYXJfaWQgPD0gMjQ0KSkgewoJCQkJCQkJCQkkY29kZV9kYXRhW10gPSAkZm5jX2FbJGNoYXJfaWRdOwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IHN0cnBvcygka2V5c19hLCAkY2hhcik7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJY2FzZSAnQic6IHsKCQkJCQkJCWlmICgka2V5ID09IDApIHsKCQkJCQkJCQkkdG1wY2hyID0gb3JkKCRzZXFbMV1bMF0pOwoJCQkJCQkJCWlmICgoJHNlcVsyXSA9PSAxKSBBTkQgKCR0bXBjaHIgPj0gMjQxKSBBTkQgKCR0bXBjaHIgPD0gMjQ0KSBBTkQgaXNzZXQoJHNlcXVlbmNlWygka2V5ICsgMSldKSBBTkQgKCRzZXF1ZW5jZVsoJGtleSArIDEpXVswXSAhPSAnQicpKSB7CgkJCQkJCQkJCXN3aXRjaCAoJHNlcXVlbmNlWygka2V5ICsgMSldWzBdKSB7CgkJCQkJCQkJCQljYXNlICdBJzogewoJCQkJCQkJCQkJCSRzdGFydGlkID0gMTAzOwoJCQkJCQkJCQkJCSRzZXF1ZW5jZVska2V5XVswXSA9ICdBJzsKCQkJCQkJCQkJCQkkY29kZV9kYXRhW10gPSAkZm5jX2FbJHRtcGNocl07CgkJCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCQljYXNlICdDJzogewoJCQkJCQkJCQkJCSRzdGFydGlkID0gMTA1OwoJCQkJCQkJCQkJCSRzZXF1ZW5jZVska2V5XVswXSA9ICdDJzsKCQkJCQkJCQkJCQkkY29kZV9kYXRhW10gPSAkZm5jX2FbJHRtcGNocl07CgkJCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJCQl9CgkJCQkJCQkJCX0KCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJJHN0YXJ0aWQgPSAxMDQ7CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlaWYgKCRzZXF1ZW5jZVsoJGtleSAtIDEpXVswXSAhPSAnQicpIHsKCQkJCQkJCQlpZiAoKCRzZXFbMl0gPT0gMSkgQU5EICgka2V5ID4gMCkgQU5EICgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bMF0gPT0gJ0EnKSBBTkQgKCFpc3NldCgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bM10pKSkgewoJCQkJCQkJCQkvLyBzaW5nbGUgY2hhcmFjdGVyIHNoaWZ0CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IDk4OwoJCQkJCQkJCQkvLyBtYXJrIHNoaWZ0CgkJCQkJCQkJCSRzZXF1ZW5jZVska2V5XVszXSA9IHRydWU7CgkJCQkJCQkJfSBlbHNlaWYgKCFpc3NldCgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bM10pKSB7CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IDEwMDsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQlmb3IgKCRpID0gMDsgJGkgPCAkc2VxWzJdOyArKyRpKSB7CgkJCQkJCQkJJGNoYXIgPSAkc2VxWzFdWyRpXTsKCQkJCQkJCQkkY2hhcl9pZCA9IG9yZCgkY2hhcik7CgkJCQkJCQkJaWYgKCgkY2hhcl9pZCA+PSAyNDEpIEFORCAoJGNoYXJfaWQgPD0gMjQ0KSkgewoJCQkJCQkJCQkkY29kZV9kYXRhW10gPSAkZm5jX2JbJGNoYXJfaWRdOwoJCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IHN0cnBvcygka2V5c19iLCAkY2hhcik7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQkJY2FzZSAnQyc6IHsKCQkJCQkJCWlmICgka2V5ID09IDApIHsKCQkJCQkJCQkkc3RhcnRpZCA9IDEwNTsKCQkJCQkJCX0gZWxzZWlmICgkc2VxdWVuY2VbKCRrZXkgLSAxKV1bMF0gIT0gJ0MnKSB7CgkJCQkJCQkJJGNvZGVfZGF0YVtdID0gOTk7CgkJCQkJCQl9CgkJCQkJCQlmb3IgKCRpID0gMDsgJGkgPCAkc2VxWzJdOyAkaSs9MikgewoJCQkJCQkJCSRjaHJudW0gPSAkc2VxWzFdWyRpXS4kc2VxWzFdWyRpKzFdOwoJCQkJCQkJCSRjb2RlX2RhdGFbXSA9IGludHZhbCgkY2hybnVtKTsKCQkJCQkJCX0KCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCS8vIGNhbGN1bGF0ZSBjaGVjayBjaGFyYWN0ZXIKCQkkc3VtID0gJHN0YXJ0aWQ7CgkJZm9yZWFjaCAoJGNvZGVfZGF0YSBhcyAka2V5ID0+ICR2YWwpIHsKCQkJJHN1bSArPSAoJHZhbCAqICgka2V5ICsgMSkpOwoJCX0KCQkvLyBhZGQgY2hlY2sgY2hhcmFjdGVyCgkJJGNvZGVfZGF0YVtdID0gKCRzdW0gJSAxMDMpOwoJCS8vIGFkZCBzdG9wIHNlcXVlbmNlCgkJJGNvZGVfZGF0YVtdID0gMTA2OwoJCSRjb2RlX2RhdGFbXSA9IDEwNzsKCQkvLyBhZGQgc3RhcnQgY29kZSBhdCB0aGUgYmVnaW5uaW5nCgkJYXJyYXlfdW5zaGlmdCgkY29kZV9kYXRhLCAkc3RhcnRpZCk7CgkJLy8gYnVpbGQgYmFyY29kZSBhcnJheQoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAxLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCWZvcmVhY2ggKCRjb2RlX2RhdGEgYXMgJHZhbCkgewoJCQkkc2VxID0gJGNoclskdmFsXTsKCQkJZm9yICgkaiA9IDA7ICRqIDwgNjsgKyskaikgewoJCQkJaWYgKCgkaiAlIDIpID09IDApIHsKCQkJCQkkdCA9IHRydWU7IC8vIGJhcgoJCQkJfSBlbHNlIHsKCQkJCQkkdCA9IGZhbHNlOyAvLyBzcGFjZQoJCQkJfQoJCQkJJHcgPSAoZmxvYXQpJHNlcVskal07CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bXSA9IGFycmF5KCd0JyA9PiAkdCwgJ3cnID0+ICR3LCAnaCcgPT4gMSwgJ3AnID0+IDApOwoJCQkJJGJhcmFycmF5WydtYXh3J10gKz0gJHc7CgkJCX0KCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIFNwbGl0IHRleHQgY29kZSBpbiBBL0Igc2VxdWVuY2UgZm9yIDEyOCBjb2RlCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gc3BsaXQuCgkgKiBAcmV0dXJuIGFycmF5IHNlcXVlbmNlCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXQxMjhBQnNlcXVlbmNlKCRjb2RlKSB7CgkJJGxlbiA9IHN0cmxlbigkY29kZSk7CgkJJHNlcXVlbmNlID0gYXJyYXkoKTsKCQkvLyBnZXQgQSBzZXF1ZW5jZXMgKGlmIGFueSkKCQkkbnVtc2VxID0gYXJyYXkoKTsKCQlwcmVnX21hdGNoX2FsbCgnLyhbXDAtXDMxXSkvJywgJGNvZGUsICRudW1zZXEsIFBSRUdfT0ZGU0VUX0NBUFRVUkUpOwoJCWlmIChpc3NldCgkbnVtc2VxWzFdKSBBTkQgIWVtcHR5KCRudW1zZXFbMV0pKSB7CgkJCSRlbmRfb2Zmc2V0ID0gMDsKCQkJZm9yZWFjaCAoJG51bXNlcVsxXSBhcyAkdmFsKSB7CgkJCQkkb2Zmc2V0ID0gJHZhbFsxXTsKCQkJCWlmICgkb2Zmc2V0ID4gJGVuZF9vZmZzZXQpIHsKCQkJCQkvLyBCIHNlcXVlbmNlCgkJCQkJJHNlcXVlbmNlW10gPSBhcnJheSgnQicsIHN1YnN0cigkY29kZSwgJGVuZF9vZmZzZXQsICgkb2Zmc2V0IC0gJGVuZF9vZmZzZXQpKSwgKCRvZmZzZXQgLSAkZW5kX29mZnNldCkpOwoJCQkJfQoJCQkJLy8gQSBzZXF1ZW5jZQoJCQkJJHNsZW4gPSBzdHJsZW4oJHZhbFswXSk7CgkJCQkkc2VxdWVuY2VbXSA9IGFycmF5KCdBJywgc3Vic3RyKCRjb2RlLCAkb2Zmc2V0LCAkc2xlbiksICRzbGVuKTsKCQkJCSRlbmRfb2Zmc2V0ID0gJG9mZnNldCArICRzbGVuOwoJCQl9CgkJCWlmICgkZW5kX29mZnNldCA8ICRsZW4pIHsKCQkJCSRzZXF1ZW5jZVtdID0gYXJyYXkoJ0InLCBzdWJzdHIoJGNvZGUsICRlbmRfb2Zmc2V0KSwgKCRsZW4gLSAkZW5kX29mZnNldCkpOwoJCQl9CgkJfSBlbHNlIHsKCQkJLy8gb25seSBCIHNlcXVlbmNlCgkJCSRzZXF1ZW5jZVtdID0gYXJyYXkoJ0InLCAkY29kZSwgJGxlbik7CgkJfQoJCXJldHVybiAkc2VxdWVuY2U7Cgl9CgoJLyoqCgkgKiBFQU4xMyBhbmQgVVBDLUEgYmFyY29kZXMuCgkgKiBFQU4xMzogRXVyb3BlYW4gQXJ0aWNsZSBOdW1iZXJpbmcgaW50ZXJuYXRpb25hbCByZXRhaWwgcHJvZHVjdCBjb2RlCgkgKiBVUEMtQTogVW5pdmVyc2FsIHByb2R1Y3QgY29kZSBzZWVuIG9uIGFsbW9zdCBhbGwgcmV0YWlsIHByb2R1Y3RzIGluIHRoZSBVU0EgYW5kIENhbmFkYQoJICogVVBDLUU6IFNob3J0IHZlcnNpb24gb2YgVVBDIHN5bWJvbAoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEBwYXJhbSBzdHJpbmcgJGxlbiBiYXJjb2RlIHR5cGU6IDYgPSBVUEMtRSwgOCA9IEVBTjgsIDEzID0gRUFOMTMsIDEyID0gVVBDLUEKCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfZWFudXBjKCRjb2RlLCAkbGVuPTEzKSB7CgkJJHVwY2UgPSBmYWxzZTsKCQlpZiAoJGxlbiA9PSA2KSB7CgkJCSRsZW4gPSAxMjsgLy8gVVBDLUEKCQkJJHVwY2UgPSB0cnVlOyAvLyBVUEMtRSBtb2RlCgkJfQoJCSRkYXRhX2xlbiA9ICRsZW4gLSAxOwoJCS8vUGFkZGluZwoJCSRjb2RlID0gc3RyX3BhZCgkY29kZSwgJGRhdGFfbGVuLCAnMCcsIFNUUl9QQURfTEVGVCk7CgkJJGNvZGVfbGVuID0gc3RybGVuKCRjb2RlKTsKCQkvLyBjYWxjdWxhdGUgY2hlY2sgZGlnaXQKCQkkc3VtX2EgPSAwOwoJCWZvciAoJGkgPSAxOyAkaSA8ICRkYXRhX2xlbjsgJGkrPTIpIHsKCQkJJHN1bV9hICs9ICRjb2RlWyRpXTsKCQl9CgkJaWYgKCRsZW4gPiAxMikgewoJCQkkc3VtX2EgKj0gMzsKCQl9CgkJJHN1bV9iID0gMDsKCQlmb3IgKCRpID0gMDsgJGkgPCAkZGF0YV9sZW47ICRpKz0yKSB7CgkJCSRzdW1fYiArPSAoJGNvZGVbJGldKTsKCQl9CgkJaWYgKCRsZW4gPCAxMykgewoJCQkkc3VtX2IgKj0gMzsKCQl9CgkJJHIgPSAoJHN1bV9hICsgJHN1bV9iKSAlIDEwOwoJCWlmKCRyID4gMCkgewoJCQkkciA9ICgxMCAtICRyKTsKCQl9CgkJaWYgKCRjb2RlX2xlbiA9PSAkZGF0YV9sZW4pIHsKCQkJLy8gYWRkIGNoZWNrIGRpZ2l0CgkJCSRjb2RlIC49ICRyOwoJCX0gZWxzZWlmICgkciAhPT0gaW50dmFsKCRjb2RlWyRkYXRhX2xlbl0pKSB7CgkJCS8vIHdyb25nIGNoZWNrZGlnaXQKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlpZiAoJGxlbiA9PSAxMikgewoJCQkvLyBVUEMtQQoJCQkkY29kZSA9ICcwJy4kY29kZTsKCQkJKyskbGVuOwoJCX0KCQlpZiAoJHVwY2UpIHsKCQkJLy8gY29udmVydCBVUEMtQSB0byBVUEMtRQoJCQkkdG1wID0gc3Vic3RyKCRjb2RlLCA0LCAzKTsKCQkJaWYgKCgkdG1wID09ICcwMDAnKSBPUiAoJHRtcCA9PSAnMTAwJykgT1IgKCR0bXAgPT0gJzIwMCcpKSB7CgkJCQkvLyBtYW51ZmFjdHVyZXIgY29kZSBlbmRzIGluIDAwMCwgMTAwLCBvciAyMDAKCQkJCSR1cGNlX2NvZGUgPSBzdWJzdHIoJGNvZGUsIDIsIDIpLnN1YnN0cigkY29kZSwgOSwgMykuc3Vic3RyKCRjb2RlLCA0LCAxKTsKCQkJfSBlbHNlIHsKCQkJCSR0bXAgPSBzdWJzdHIoJGNvZGUsIDUsIDIpOwoJCQkJaWYgKCR0bXAgPT0gJzAwJykgewoJCQkJCS8vIG1hbnVmYWN0dXJlciBjb2RlIGVuZHMgaW4gMDAKCQkJCQkkdXBjZV9jb2RlID0gc3Vic3RyKCRjb2RlLCAyLCAzKS5zdWJzdHIoJGNvZGUsIDEwLCAyKS4nMyc7CgkJCQl9IGVsc2UgewoJCQkJCSR0bXAgPSBzdWJzdHIoJGNvZGUsIDYsIDEpOwoJCQkJCWlmICgkdG1wID09ICcwJykgewoJCQkJCQkvLyBtYW51ZmFjdHVyZXIgY29kZSBlbmRzIGluIDAKCQkJCQkJJHVwY2VfY29kZSA9IHN1YnN0cigkY29kZSwgMiwgNCkuc3Vic3RyKCRjb2RlLCAxMSwgMSkuJzQnOwoJCQkJCX0gZWxzZSB7CgkJCQkJCS8vIG1hbnVmYWN0dXJlciBjb2RlIGRvZXMgbm90IGVuZCBpbiB6ZXJvCgkJCQkJCSR1cGNlX2NvZGUgPSBzdWJzdHIoJGNvZGUsIDIsIDUpLnN1YnN0cigkY29kZSwgMTEsIDEpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQkvL0NvbnZlcnQgZGlnaXRzIHRvIGJhcnMKCQkkY29kZXMgPSBhcnJheSgKCQkJJ0EnPT5hcnJheSggLy8gbGVmdCBvZGQgcGFyaXR5CgkJCQknMCc9PicwMDAxMTAxJywKCQkJCScxJz0+JzAwMTEwMDEnLAoJCQkJJzInPT4nMDAxMDAxMScsCgkJCQknMyc9PicwMTExMTAxJywKCQkJCSc0Jz0+JzAxMDAwMTEnLAoJCQkJJzUnPT4nMDExMDAwMScsCgkJCQknNic9PicwMTAxMTExJywKCQkJCSc3Jz0+JzAxMTEwMTEnLAoJCQkJJzgnPT4nMDExMDExMScsCgkJCQknOSc9PicwMDAxMDExJyksCgkJCSdCJz0+YXJyYXkoIC8vIGxlZnQgZXZlbiBwYXJpdHkKCQkJCScwJz0+JzAxMDAxMTEnLAoJCQkJJzEnPT4nMDExMDAxMScsCgkJCQknMic9PicwMDExMDExJywKCQkJCSczJz0+JzAxMDAwMDEnLAoJCQkJJzQnPT4nMDAxMTEwMScsCgkJCQknNSc9PicwMTExMDAxJywKCQkJCSc2Jz0+JzAwMDAxMDEnLAoJCQkJJzcnPT4nMDAxMDAwMScsCgkJCQknOCc9PicwMDAxMDAxJywKCQkJCSc5Jz0+JzAwMTAxMTEnKSwKCQkJJ0MnPT5hcnJheSggLy8gcmlnaHQKCQkJCScwJz0+JzExMTAwMTAnLAoJCQkJJzEnPT4nMTEwMDExMCcsCgkJCQknMic9PicxMTAxMTAwJywKCQkJCSczJz0+JzEwMDAwMTAnLAoJCQkJJzQnPT4nMTAxMTEwMCcsCgkJCQknNSc9PicxMDAxMTEwJywKCQkJCSc2Jz0+JzEwMTAwMDAnLAoJCQkJJzcnPT4nMTAwMDEwMCcsCgkJCQknOCc9PicxMDAxMDAwJywKCQkJCSc5Jz0+JzExMTAxMDAnKQoJCSk7CgkJJHBhcml0aWVzID0gYXJyYXkoCgkJCScwJz0+YXJyYXkoJ0EnLCdBJywnQScsJ0EnLCdBJywnQScpLAoJCQknMSc9PmFycmF5KCdBJywnQScsJ0InLCdBJywnQicsJ0InKSwKCQkJJzInPT5hcnJheSgnQScsJ0EnLCdCJywnQicsJ0EnLCdCJyksCgkJCSczJz0+YXJyYXkoJ0EnLCdBJywnQicsJ0InLCdCJywnQScpLAoJCQknNCc9PmFycmF5KCdBJywnQicsJ0EnLCdBJywnQicsJ0InKSwKCQkJJzUnPT5hcnJheSgnQScsJ0InLCdCJywnQScsJ0EnLCdCJyksCgkJCSc2Jz0+YXJyYXkoJ0EnLCdCJywnQicsJ0InLCdBJywnQScpLAoJCQknNyc9PmFycmF5KCdBJywnQicsJ0EnLCdCJywnQScsJ0InKSwKCQkJJzgnPT5hcnJheSgnQScsJ0InLCdBJywnQicsJ0InLCdBJyksCgkJCSc5Jz0+YXJyYXkoJ0EnLCdCJywnQicsJ0EnLCdCJywnQScpCgkJKTsKCQkkdXBjZV9wYXJpdGllcyA9IGFycmF5KCk7CgkJJHVwY2VfcGFyaXRpZXNbMF0gPSBhcnJheSgKCQkJJzAnPT5hcnJheSgnQicsJ0InLCdCJywnQScsJ0EnLCdBJyksCgkJCScxJz0+YXJyYXkoJ0InLCdCJywnQScsJ0InLCdBJywnQScpLAoJCQknMic9PmFycmF5KCdCJywnQicsJ0EnLCdBJywnQicsJ0EnKSwKCQkJJzMnPT5hcnJheSgnQicsJ0InLCdBJywnQScsJ0EnLCdCJyksCgkJCSc0Jz0+YXJyYXkoJ0InLCdBJywnQicsJ0InLCdBJywnQScpLAoJCQknNSc9PmFycmF5KCdCJywnQScsJ0EnLCdCJywnQicsJ0EnKSwKCQkJJzYnPT5hcnJheSgnQicsJ0EnLCdBJywnQScsJ0InLCdCJyksCgkJCSc3Jz0+YXJyYXkoJ0InLCdBJywnQicsJ0EnLCdCJywnQScpLAoJCQknOCc9PmFycmF5KCdCJywnQScsJ0InLCdBJywnQScsJ0InKSwKCQkJJzknPT5hcnJheSgnQicsJ0EnLCdBJywnQicsJ0EnLCdCJykKCQkpOwoJCSR1cGNlX3Bhcml0aWVzWzFdID0gYXJyYXkoCgkJCScwJz0+YXJyYXkoJ0EnLCdBJywnQScsJ0InLCdCJywnQicpLAoJCQknMSc9PmFycmF5KCdBJywnQScsJ0InLCdBJywnQicsJ0InKSwKCQkJJzInPT5hcnJheSgnQScsJ0EnLCdCJywnQicsJ0EnLCdCJyksCgkJCSczJz0+YXJyYXkoJ0EnLCdBJywnQicsJ0InLCdCJywnQScpLAoJCQknNCc9PmFycmF5KCdBJywnQicsJ0EnLCdBJywnQicsJ0InKSwKCQkJJzUnPT5hcnJheSgnQScsJ0InLCdCJywnQScsJ0EnLCdCJyksCgkJCSc2Jz0+YXJyYXkoJ0EnLCdCJywnQicsJ0InLCdBJywnQScpLAoJCQknNyc9PmFycmF5KCdBJywnQicsJ0EnLCdCJywnQScsJ0InKSwKCQkJJzgnPT5hcnJheSgnQScsJ0InLCdBJywnQicsJ0InLCdBJyksCgkJCSc5Jz0+YXJyYXkoJ0EnLCdCJywnQicsJ0EnLCdCJywnQScpCgkJKTsKCQkkayA9IDA7CgkJJHNlcSA9ICcxMDEnOyAvLyBsZWZ0IGd1YXJkIGJhcgoJCWlmICgkdXBjZSkgewoJCQkkYmFyYXJyYXkgPSBhcnJheSgnY29kZScgPT4gJHVwY2VfY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAxLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCQkkcCA9ICR1cGNlX3Bhcml0aWVzWyRjb2RlWzFdXVskcl07CgkJCWZvciAoJGkgPSAwOyAkaSA8IDY7ICsrJGkpIHsKCQkJCSRzZXEgLj0gJGNvZGVzWyRwWyRpXV1bJHVwY2VfY29kZVskaV1dOwoJCQl9CgkJCSRzZXEgLj0gJzAxMDEwMSc7IC8vIHJpZ2h0IGd1YXJkIGJhcgoJCX0gZWxzZSB7CgkJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAxLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCQkkaGFsZl9sZW4gPSBpbnR2YWwoY2VpbCgkbGVuIC8gMikpOwoJCQlpZiAoJGxlbiA9PSA4KSB7CgkJCQlmb3IgKCRpID0gMDsgJGkgPCAkaGFsZl9sZW47ICsrJGkpIHsKCQkJCQkkc2VxIC49ICRjb2Rlc1snQSddWyRjb2RlWyRpXV07CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQkkcCA9ICRwYXJpdGllc1skY29kZVswXV07CgkJCQlmb3IgKCRpID0gMTsgJGkgPCAkaGFsZl9sZW47ICsrJGkpIHsKCQkJCQkkc2VxIC49ICRjb2Rlc1skcFskaS0xXV1bJGNvZGVbJGldXTsKCQkJCX0KCQkJfQoJCQkkc2VxIC49ICcwMTAxMCc7IC8vIGNlbnRlciBndWFyZCBiYXIKCQkJZm9yICgkaSA9ICRoYWxmX2xlbjsgJGkgPCAkbGVuOyArKyRpKSB7CgkJCQkkc2VxIC49ICRjb2Rlc1snQyddWyRjb2RlWyRpXV07CgkJCX0KCQkJJHNlcSAuPSAnMTAxJzsgLy8gcmlnaHQgZ3VhcmQgYmFyCgkJfQoJCSRjbGVuID0gc3RybGVuKCRzZXEpOwoJCSR3ID0gMDsKCQlmb3IgKCRpID0gMDsgJGkgPCAkY2xlbjsgKyskaSkgewoJCQkkdyArPSAxOwoJCQlpZiAoKCRpID09ICgkY2xlbiAtIDEpKSBPUiAoKCRpIDwgKCRjbGVuIC0gMSkpIEFORCAoJHNlcVskaV0gIT0gJHNlcVskaSsxXSkpKSB7CgkJCQlpZiAoJHNlcVskaV0gPT0gJzEnKSB7CgkJCQkJJHQgPSB0cnVlOyAvLyBiYXIKCQkJCX0gZWxzZSB7CgkJCQkJJHQgPSBmYWxzZTsgLy8gc3BhY2UKCQkJCX0KCQkJCSRiYXJhcnJheVsnYmNvZGUnXVska10gPSBhcnJheSgndCcgPT4gJHQsICd3JyA9PiAkdywgJ2gnID0+IDEsICdwJyA9PiAwKTsKCQkJCSRiYXJhcnJheVsnbWF4dyddICs9ICR3OwoJCQkJKyskazsKCQkJCSR3ID0gMDsKCQkJfQoJCX0KCQlyZXR1cm4gJGJhcmFycmF5OwoJfQoKCS8qKgoJICogVVBDLUJhc2VkIEV4dGVuc2lvbnMKCSAqIDItRGlnaXQgRXh0LjogVXNlZCB0byBpbmRpY2F0ZSBtYWdhemluZXMgYW5kIG5ld3NwYXBlciBpc3N1ZSBudW1iZXJzCgkgKiA1LURpZ2l0IEV4dC46IFVzZWQgdG8gbWFyayBzdWdnZXN0ZWQgcmV0YWlsIHByaWNlIG9mIGJvb2tzCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gcmVwcmVzZW50LgoJICogQHBhcmFtIHN0cmluZyAkbGVuIGJhcmNvZGUgdHlwZTogMiA9IDItRGlnaXQsIDUgPSA1LURpZ2l0CgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX2VhbmV4dCgkY29kZSwgJGxlbj01KSB7CgkJLy9QYWRkaW5nCgkJJGNvZGUgPSBzdHJfcGFkKCRjb2RlLCAkbGVuLCAnMCcsIFNUUl9QQURfTEVGVCk7CgkJLy8gY2FsY3VsYXRlIGNoZWNrIGRpZ2l0CgkJaWYgKCRsZW4gPT0gMikgewoJCQkkciA9ICRjb2RlICUgNDsKCQl9IGVsc2VpZiAoJGxlbiA9PSA1KSB7CgkJCSRyID0gKDMgKiAoJGNvZGVbMF0gKyAkY29kZVsyXSArICRjb2RlWzRdKSkgKyAoOSAqICgkY29kZVsxXSArICRjb2RlWzNdKSk7CgkJCSRyICU9IDEwOwoJCX0gZWxzZSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJLy9Db252ZXJ0IGRpZ2l0cyB0byBiYXJzCgkJJGNvZGVzID0gYXJyYXkoCgkJCSdBJz0+YXJyYXkoIC8vIGxlZnQgb2RkIHBhcml0eQoJCQkJJzAnPT4nMDAwMTEwMScsCgkJCQknMSc9PicwMDExMDAxJywKCQkJCScyJz0+JzAwMTAwMTEnLAoJCQkJJzMnPT4nMDExMTEwMScsCgkJCQknNCc9PicwMTAwMDExJywKCQkJCSc1Jz0+JzAxMTAwMDEnLAoJCQkJJzYnPT4nMDEwMTExMScsCgkJCQknNyc9PicwMTExMDExJywKCQkJCSc4Jz0+JzAxMTAxMTEnLAoJCQkJJzknPT4nMDAwMTAxMScpLAoJCQknQic9PmFycmF5KCAvLyBsZWZ0IGV2ZW4gcGFyaXR5CgkJCQknMCc9PicwMTAwMTExJywKCQkJCScxJz0+JzAxMTAwMTEnLAoJCQkJJzInPT4nMDAxMTAxMScsCgkJCQknMyc9PicwMTAwMDAxJywKCQkJCSc0Jz0+JzAwMTExMDEnLAoJCQkJJzUnPT4nMDExMTAwMScsCgkJCQknNic9PicwMDAwMTAxJywKCQkJCSc3Jz0+JzAwMTAwMDEnLAoJCQkJJzgnPT4nMDAwMTAwMScsCgkJCQknOSc9PicwMDEwMTExJykKCQkpOwoJCSRwYXJpdGllcyA9IGFycmF5KCk7CgkJJHBhcml0aWVzWzJdID0gYXJyYXkoCgkJCScwJz0+YXJyYXkoJ0EnLCdBJyksCgkJCScxJz0+YXJyYXkoJ0EnLCdCJyksCgkJCScyJz0+YXJyYXkoJ0InLCdBJyksCgkJCSczJz0+YXJyYXkoJ0InLCdCJykKCQkpOwoJCSRwYXJpdGllc1s1XSA9IGFycmF5KAoJCQknMCc9PmFycmF5KCdCJywnQicsJ0EnLCdBJywnQScpLAoJCQknMSc9PmFycmF5KCdCJywnQScsJ0InLCdBJywnQScpLAoJCQknMic9PmFycmF5KCdCJywnQScsJ0EnLCdCJywnQScpLAoJCQknMyc9PmFycmF5KCdCJywnQScsJ0EnLCdBJywnQicpLAoJCQknNCc9PmFycmF5KCdBJywnQicsJ0InLCdBJywnQScpLAoJCQknNSc9PmFycmF5KCdBJywnQScsJ0InLCdCJywnQScpLAoJCQknNic9PmFycmF5KCdBJywnQScsJ0EnLCdCJywnQicpLAoJCQknNyc9PmFycmF5KCdBJywnQicsJ0EnLCdCJywnQScpLAoJCQknOCc9PmFycmF5KCdBJywnQicsJ0EnLCdBJywnQicpLAoJCQknOSc9PmFycmF5KCdBJywnQScsJ0InLCdBJywnQicpCgkJKTsKCQkkcCA9ICRwYXJpdGllc1skbGVuXVskcl07CgkJJHNlcSA9ICcxMDExJzsgLy8gbGVmdCBndWFyZCBiYXIKCQkkc2VxIC49ICRjb2Rlc1skcFswXV1bJGNvZGVbMF1dOwoJCWZvciAoJGkgPSAxOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJJHNlcSAuPSAnMDEnOyAvLyBzZXBhcmF0b3IKCQkJJHNlcSAuPSAkY29kZXNbJHBbJGldXVskY29kZVskaV1dOwoJCX0KCQkkYmFyYXJyYXkgPSBhcnJheSgnY29kZScgPT4gJGNvZGUsICdtYXh3JyA9PiAwLCAnbWF4aCcgPT4gMSwgJ2Jjb2RlJyA9PiBhcnJheSgpKTsKCQlyZXR1cm4gJHRoaXMtPmJpbnNlcV90b19hcnJheSgkc2VxLCAkYmFyYXJyYXkpOwoJfQoKCS8qKgoJICogUE9TVE5FVCBhbmQgUExBTkVUIGJhcmNvZGVzLgoJICogVXNlZCBieSBVLlMuIFBvc3RhbCBTZXJ2aWNlIGZvciBhdXRvbWF0ZWQgbWFpbCBzb3J0aW5nCgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIHppcCBjb2RlIHRvIHJlcHJlc2VudC4gTXVzdCBiZSBhIHN0cmluZyBjb250YWluaW5nIGEgemlwIGNvZGUgb2YgdGhlIGZvcm0gREREREQgb3IgREREREQtRERERC4KCSAqIEBwYXJhbSBib29sZWFuICRwbGFuZXQgaWYgdHJ1ZSBwcmludCB0aGUgUExBTkVUIGJhcmNvZGUsIG90aGVyd2lzZSBwcmludCBQT1NUTkVUCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX3Bvc3RuZXQoJGNvZGUsICRwbGFuZXQ9ZmFsc2UpIHsKCQkvLyBiYXIgbGVuZ3RoCgkJaWYgKCRwbGFuZXQpIHsKCQkJJGJhcmxlbiA9IEFycmF5KAoJCQkJMCA9PiBBcnJheSgxLDEsMiwyLDIpLAoJCQkJMSA9PiBBcnJheSgyLDIsMiwxLDEpLAoJCQkJMiA9PiBBcnJheSgyLDIsMSwyLDEpLAoJCQkJMyA9PiBBcnJheSgyLDIsMSwxLDIpLAoJCQkJNCA9PiBBcnJheSgyLDEsMiwyLDEpLAoJCQkJNSA9PiBBcnJheSgyLDEsMiwxLDIpLAoJCQkJNiA9PiBBcnJheSgyLDEsMSwyLDIpLAoJCQkJNyA9PiBBcnJheSgxLDIsMiwyLDEpLAoJCQkJOCA9PiBBcnJheSgxLDIsMiwxLDIpLAoJCQkJOSA9PiBBcnJheSgxLDIsMSwyLDIpCgkJCSk7CgkJfSBlbHNlIHsKCQkJJGJhcmxlbiA9IEFycmF5KAoJCQkJMCA9PiBBcnJheSgyLDIsMSwxLDEpLAoJCQkJMSA9PiBBcnJheSgxLDEsMSwyLDIpLAoJCQkJMiA9PiBBcnJheSgxLDEsMiwxLDIpLAoJCQkJMyA9PiBBcnJheSgxLDEsMiwyLDEpLAoJCQkJNCA9PiBBcnJheSgxLDIsMSwxLDIpLAoJCQkJNSA9PiBBcnJheSgxLDIsMSwyLDEpLAoJCQkJNiA9PiBBcnJheSgxLDIsMiwxLDEpLAoJCQkJNyA9PiBBcnJheSgyLDEsMSwxLDIpLAoJCQkJOCA9PiBBcnJheSgyLDEsMSwyLDEpLAoJCQkJOSA9PiBBcnJheSgyLDEsMiwxLDEpCgkJCSk7CgkJfQoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAyLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCSRrID0gMDsKCQkkY29kZSA9IHN0cl9yZXBsYWNlKCctJywgJycsICRjb2RlKTsKCQkkY29kZSA9IHN0cl9yZXBsYWNlKCcgJywgJycsICRjb2RlKTsKCQkkbGVuID0gc3RybGVuKCRjb2RlKTsKCQkvLyBjYWxjdWxhdGUgY2hlY2tzdW0KCQkkc3VtID0gMDsKCQlmb3IgKCRpID0gMDsgJGkgPCAkbGVuOyArKyRpKSB7CgkJCSRzdW0gKz0gaW50dmFsKCRjb2RlWyRpXSk7CgkJfQoJCSRjaGtkID0gKCRzdW0gJSAxMCk7CgkJaWYoJGNoa2QgPiAwKSB7CgkJCSRjaGtkID0gKDEwIC0gJGNoa2QpOwoJCX0KCQkkY29kZSAuPSAkY2hrZDsKCQkkbGVuID0gc3RybGVuKCRjb2RlKTsKCQkvLyBzdGFydCBiYXIKCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMSwgJ3cnID0+IDEsICdoJyA9PiAyLCAncCcgPT4gMCk7CgkJJGJhcmFycmF5WydiY29kZSddWyRrKytdID0gYXJyYXkoJ3QnID0+IDAsICd3JyA9PiAxLCAnaCcgPT4gMiwgJ3AnID0+IDApOwoJCSRiYXJhcnJheVsnbWF4dyddICs9IDI7CgkJZm9yICgkaSA9IDA7ICRpIDwgJGxlbjsgKyskaSkgewoJCQlmb3IgKCRqID0gMDsgJGogPCA1OyArKyRqKSB7CgkJCQkkaCA9ICRiYXJsZW5bJGNvZGVbJGldXVskal07CgkJCQkkcCA9IGZsb29yKDEgLyAkaCk7CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMSwgJ3cnID0+IDEsICdoJyA9PiAkaCwgJ3AnID0+ICRwKTsKCQkJCSRiYXJhcnJheVsnYmNvZGUnXVskaysrXSA9IGFycmF5KCd0JyA9PiAwLCAndycgPT4gMSwgJ2gnID0+IDIsICdwJyA9PiAwKTsKCQkJCSRiYXJhcnJheVsnbWF4dyddICs9IDI7CgkJCX0KCQl9CgkJLy8gZW5kIGJhcgoJCSRiYXJhcnJheVsnYmNvZGUnXVskaysrXSA9IGFycmF5KCd0JyA9PiAxLCAndycgPT4gMSwgJ2gnID0+IDIsICdwJyA9PiAwKTsKCQkkYmFyYXJyYXlbJ21heHcnXSArPSAxOwoJCXJldHVybiAkYmFyYXJyYXk7Cgl9CgoJLyoqCgkgKiBSTVM0Q0MgLSBDQkMgLSBLSVgKCSAqIFJNUzRDQyAoUm95YWwgTWFpbCA0LXN0YXRlIEN1c3RvbWVyIENvZGUpIC0gQ0JDIChDdXN0b21lciBCYXIgQ29kZSkgLSBLSVggKEtsYW50IGluZGV4IC0gQ3VzdG9tZXIgaW5kZXgpCgkgKiBSTTRTQ0MgaXMgdGhlIG5hbWUgb2YgdGhlIGJhcmNvZGUgc3ltYm9sb2d5IHVzZWQgYnkgdGhlIFJveWFsIE1haWwgZm9yIGl0cyBDbGVhbm1haWwgc2VydmljZS4KCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byBwcmludAoJICogQHBhcmFtIGJvb2xlYW4gJGtpeCBpZiB0cnVlIHByaW50cyB0aGUgS0lYIHZhcmlhdGlvbiAoZG9lc24ndCB1c2UgdGhlIHN0YXJ0IGFuZCBlbmQgc3ltYm9scywgYW5kIHRoZSBjaGVja3N1bSkgLSBpbiB0aGlzIGNhc2UgdGhlIGhvdXNlIG51bWJlciBtdXN0IGJlIHN1ZmZpY2VkIHdpdGggYW4gWCBhbmQgcGxhY2VkIGF0IHRoZSBlbmQgb2YgdGhlIGNvZGUuCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX3JtczRjYygkY29kZSwgJGtpeD1mYWxzZSkgewoJCSRub3RraXggPSAhJGtpeDsKCQkvLyBiYXIgbW9kZQoJCS8vIDEgPSBwb3MgMSwgbGVuZ3RoIDIKCQkvLyAyID0gcG9zIDEsIGxlbmd0aCAzCgkJLy8gMyA9IHBvcyAyLCBsZW5ndGggMQoJCS8vIDQgPSBwb3MgMiwgbGVuZ3RoIDIKCQkkYmFybW9kZSA9IGFycmF5KAoJCQknMCcgPT4gYXJyYXkoMywzLDIsMiksCgkJCScxJyA9PiBhcnJheSgzLDQsMSwyKSwKCQkJJzInID0+IGFycmF5KDMsNCwyLDEpLAoJCQknMycgPT4gYXJyYXkoNCwzLDEsMiksCgkJCSc0JyA9PiBhcnJheSg0LDMsMiwxKSwKCQkJJzUnID0+IGFycmF5KDQsNCwxLDEpLAoJCQknNicgPT4gYXJyYXkoMywxLDQsMiksCgkJCSc3JyA9PiBhcnJheSgzLDIsMywyKSwKCQkJJzgnID0+IGFycmF5KDMsMiw0LDEpLAoJCQknOScgPT4gYXJyYXkoNCwxLDMsMiksCgkJCSdBJyA9PiBhcnJheSg0LDEsNCwxKSwKCQkJJ0InID0+IGFycmF5KDQsMiwzLDEpLAoJCQknQycgPT4gYXJyYXkoMywxLDIsNCksCgkJCSdEJyA9PiBhcnJheSgzLDIsMSw0KSwKCQkJJ0UnID0+IGFycmF5KDMsMiwyLDMpLAoJCQknRicgPT4gYXJyYXkoNCwxLDEsNCksCgkJCSdHJyA9PiBhcnJheSg0LDEsMiwzKSwKCQkJJ0gnID0+IGFycmF5KDQsMiwxLDMpLAoJCQknSScgPT4gYXJyYXkoMSwzLDQsMiksCgkJCSdKJyA9PiBhcnJheSgxLDQsMywyKSwKCQkJJ0snID0+IGFycmF5KDEsNCw0LDEpLAoJCQknTCcgPT4gYXJyYXkoMiwzLDMsMiksCgkJCSdNJyA9PiBhcnJheSgyLDMsNCwxKSwKCQkJJ04nID0+IGFycmF5KDIsNCwzLDEpLAoJCQknTycgPT4gYXJyYXkoMSwzLDIsNCksCgkJCSdQJyA9PiBhcnJheSgxLDQsMSw0KSwKCQkJJ1EnID0+IGFycmF5KDEsNCwyLDMpLAoJCQknUicgPT4gYXJyYXkoMiwzLDEsNCksCgkJCSdTJyA9PiBhcnJheSgyLDMsMiwzKSwKCQkJJ1QnID0+IGFycmF5KDIsNCwxLDMpLAoJCQknVScgPT4gYXJyYXkoMSwxLDQsNCksCgkJCSdWJyA9PiBhcnJheSgxLDIsMyw0KSwKCQkJJ1cnID0+IGFycmF5KDEsMiw0LDMpLAoJCQknWCcgPT4gYXJyYXkoMiwxLDMsNCksCgkJCSdZJyA9PiBhcnJheSgyLDEsNCwzKSwKCQkJJ1onID0+IGFycmF5KDIsMiwzLDMpCgkJKTsKCQkkY29kZSA9IHN0cnRvdXBwZXIoJGNvZGUpOwoJCSRsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAzLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCWlmICgkbm90a2l4KSB7CgkJCS8vIHRhYmxlIGZvciBjaGVja3N1bSBjYWxjdWxhdGlvbiAocm93LGNvbCkKCQkJJGNoZWNrdGFibGUgPSBhcnJheSgKCQkJCScwJyA9PiBhcnJheSgxLDEpLAoJCQkJJzEnID0+IGFycmF5KDEsMiksCgkJCQknMicgPT4gYXJyYXkoMSwzKSwKCQkJCSczJyA9PiBhcnJheSgxLDQpLAoJCQkJJzQnID0+IGFycmF5KDEsNSksCgkJCQknNScgPT4gYXJyYXkoMSwwKSwKCQkJCSc2JyA9PiBhcnJheSgyLDEpLAoJCQkJJzcnID0+IGFycmF5KDIsMiksCgkJCQknOCcgPT4gYXJyYXkoMiwzKSwKCQkJCSc5JyA9PiBhcnJheSgyLDQpLAoJCQkJJ0EnID0+IGFycmF5KDIsNSksCgkJCQknQicgPT4gYXJyYXkoMiwwKSwKCQkJCSdDJyA9PiBhcnJheSgzLDEpLAoJCQkJJ0QnID0+IGFycmF5KDMsMiksCgkJCQknRScgPT4gYXJyYXkoMywzKSwKCQkJCSdGJyA9PiBhcnJheSgzLDQpLAoJCQkJJ0cnID0+IGFycmF5KDMsNSksCgkJCQknSCcgPT4gYXJyYXkoMywwKSwKCQkJCSdJJyA9PiBhcnJheSg0LDEpLAoJCQkJJ0onID0+IGFycmF5KDQsMiksCgkJCQknSycgPT4gYXJyYXkoNCwzKSwKCQkJCSdMJyA9PiBhcnJheSg0LDQpLAoJCQkJJ00nID0+IGFycmF5KDQsNSksCgkJCQknTicgPT4gYXJyYXkoNCwwKSwKCQkJCSdPJyA9PiBhcnJheSg1LDEpLAoJCQkJJ1AnID0+IGFycmF5KDUsMiksCgkJCQknUScgPT4gYXJyYXkoNSwzKSwKCQkJCSdSJyA9PiBhcnJheSg1LDQpLAoJCQkJJ1MnID0+IGFycmF5KDUsNSksCgkJCQknVCcgPT4gYXJyYXkoNSwwKSwKCQkJCSdVJyA9PiBhcnJheSgwLDEpLAoJCQkJJ1YnID0+IGFycmF5KDAsMiksCgkJCQknVycgPT4gYXJyYXkoMCwzKSwKCQkJCSdYJyA9PiBhcnJheSgwLDQpLAoJCQkJJ1knID0+IGFycmF5KDAsNSksCgkJCQknWicgPT4gYXJyYXkoMCwwKQoJCQkpOwoJCQkkcm93ID0gMDsKCQkJJGNvbCA9IDA7CgkJCWZvciAoJGkgPSAwOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJCSRyb3cgKz0gJGNoZWNrdGFibGVbJGNvZGVbJGldXVswXTsKCQkJCSRjb2wgKz0gJGNoZWNrdGFibGVbJGNvZGVbJGldXVsxXTsKCQkJfQoJCQkkcm93ICU9IDY7CgkJCSRjb2wgJT0gNjsKCQkJJGNoayA9IGFycmF5X2tleXMoJGNoZWNrdGFibGUsIGFycmF5KCRyb3csJGNvbCkpOwoJCQkkY29kZSAuPSAkY2hrWzBdOwoJCQkrKyRsZW47CgkJfQoJCSRrID0gMDsKCQlpZiAoJG5vdGtpeCkgewoJCQkvLyBzdGFydCBiYXIKCQkJJGJhcmFycmF5WydiY29kZSddWyRrKytdID0gYXJyYXkoJ3QnID0+IDEsICd3JyA9PiAxLCAnaCcgPT4gMiwgJ3AnID0+IDApOwoJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMCwgJ3cnID0+IDEsICdoJyA9PiAyLCAncCcgPT4gMCk7CgkJCSRiYXJhcnJheVsnbWF4dyddICs9IDI7CgkJfQoJCWZvciAoJGkgPSAwOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJZm9yICgkaiA9IDA7ICRqIDwgNDsgKyskaikgewoJCQkJc3dpdGNoICgkYmFybW9kZVskY29kZVskaV1dWyRqXSkgewoJCQkJCWNhc2UgMTogewoJCQkJCQkkcCA9IDA7CgkJCQkJCSRoID0gMjsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgMjogewoJCQkJCQkkcCA9IDA7CgkJCQkJCSRoID0gMzsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgMzogewoJCQkJCQkkcCA9IDE7CgkJCQkJCSRoID0gMTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgNDogewoJCQkJCQkkcCA9IDE7CgkJCQkJCSRoID0gMjsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQkJJGJhcmFycmF5WydiY29kZSddWyRrKytdID0gYXJyYXkoJ3QnID0+IDEsICd3JyA9PiAxLCAnaCcgPT4gJGgsICdwJyA9PiAkcCk7CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMCwgJ3cnID0+IDEsICdoJyA9PiAyLCAncCcgPT4gMCk7CgkJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAyOwoJCQl9CgkJfQoJCWlmICgkbm90a2l4KSB7CgkJCS8vIHN0b3AgYmFyCgkJCSRiYXJhcnJheVsnYmNvZGUnXVskaysrXSA9IGFycmF5KCd0JyA9PiAxLCAndycgPT4gMSwgJ2gnID0+IDMsICdwJyA9PiAwKTsKCQkJJGJhcmFycmF5WydtYXh3J10gKz0gMTsKCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIENPREFCQVIgYmFyY29kZXMuCgkgKiBPbGRlciBjb2RlIG9mdGVuIHVzZWQgaW4gbGlicmFyeSBzeXN0ZW1zLCBzb21ldGltZXMgaW4gYmxvb2QgYmFua3MKCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQuCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX2NvZGFiYXIoJGNvZGUpIHsKCQkkY2hyID0gYXJyYXkoCgkJCScwJyA9PiAnMTExMTEyMjEnLAoJCQknMScgPT4gJzExMTEyMjExJywKCQkJJzInID0+ICcxMTEyMTEyMScsCgkJCSczJyA9PiAnMjIxMTExMTEnLAoJCQknNCcgPT4gJzExMjExMjExJywKCQkJJzUnID0+ICcyMTExMTIxMScsCgkJCSc2JyA9PiAnMTIxMTExMjEnLAoJCQknNycgPT4gJzEyMTEyMTExJywKCQkJJzgnID0+ICcxMjIxMTExMScsCgkJCSc5JyA9PiAnMjExMjExMTEnLAoJCQknLScgPT4gJzExMTIyMTExJywKCQkJJyQnID0+ICcxMTIyMTExMScsCgkJCSc6JyA9PiAnMjExMTIxMjEnLAoJCQknLycgPT4gJzIxMjExMTIxJywKCQkJJy4nID0+ICcyMTIxMjExMScsCgkJCScrJyA9PiAnMTEyMjIyMjEnLAoJCQknQScgPT4gJzExMjIxMjExJywKCQkJJ0InID0+ICcxMjEyMTEyMScsCgkJCSdDJyA9PiAnMTExMjEyMjEnLAoJCQknRCcgPT4gJzExMTIyMjExJwoJCSk7CgkJJGJhcmFycmF5ID0gYXJyYXkoJ2NvZGUnID0+ICRjb2RlLCAnbWF4dycgPT4gMCwgJ21heGgnID0+IDEsICdiY29kZScgPT4gYXJyYXkoKSk7CgkJJGsgPSAwOwoJCSR3ID0gMDsKCQkkc2VxID0gJyc7CgkJJGNvZGUgPSAnQScuc3RydG91cHBlcigkY29kZSkuJ0EnOwoJCSRsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCWZvciAoJGkgPSAwOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJaWYgKCFpc3NldCgkY2hyWyRjb2RlWyRpXV0pKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJJHNlcSA9ICRjaHJbJGNvZGVbJGldXTsKCQkJZm9yICgkaiA9IDA7ICRqIDwgODsgKyskaikgewoJCQkJaWYgKCgkaiAlIDIpID09IDApIHsKCQkJCQkkdCA9IHRydWU7IC8vIGJhcgoJCQkJfSBlbHNlIHsKCQkJCQkkdCA9IGZhbHNlOyAvLyBzcGFjZQoJCQkJfQoJCQkJJHcgPSAoZmxvYXQpJHNlcVskal07CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGtdID0gYXJyYXkoJ3QnID0+ICR0LCAndycgPT4gJHcsICdoJyA9PiAxLCAncCcgPT4gMCk7CgkJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAkdzsKCQkJCSsrJGs7CgkJCX0KCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIENPREUxMSBiYXJjb2Rlcy4KCSAqIFVzZWQgcHJpbWFyaWx5IGZvciBsYWJlbGluZyB0ZWxlY29tbXVuaWNhdGlvbnMgZXF1aXBtZW50CgkgKiBAcGFyYW0gc3RyaW5nICRjb2RlIGNvZGUgdG8gcmVwcmVzZW50LgoJICogQHJldHVybiBhcnJheSBiYXJjb2RlIHJlcHJlc2VudGF0aW9uLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gYmFyY29kZV9jb2RlMTEoJGNvZGUpIHsKCQkkY2hyID0gYXJyYXkoCgkJCScwJyA9PiAnMTExMTIxJywKCQkJJzEnID0+ICcyMTExMjEnLAoJCQknMicgPT4gJzEyMTEyMScsCgkJCSczJyA9PiAnMjIxMTExJywKCQkJJzQnID0+ICcxMTIxMjEnLAoJCQknNScgPT4gJzIxMjExMScsCgkJCSc2JyA9PiAnMTIyMTExJywKCQkJJzcnID0+ICcxMTEyMjEnLAoJCQknOCcgPT4gJzIxMTIxMScsCgkJCSc5JyA9PiAnMjExMTExJywKCQkJJy0nID0+ICcxMTIxMTEnLAoJCQknUycgPT4gJzExMjIxMScKCQkpOwoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAxLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCSRrID0gMDsKCQkkdyA9IDA7CgkJJHNlcSA9ICcnOwoJCSRsZW4gPSBzdHJsZW4oJGNvZGUpOwoJCS8vIGNhbGN1bGF0ZSBjaGVjayBkaWdpdCBDCgkJJHAgPSAxOwoJCSRjaGVjayA9IDA7CgkJZm9yICgkaSA9ICgkbGVuIC0gMSk7ICRpID49IDA7IC0tJGkpIHsKCQkJJGRpZ2l0ID0gJGNvZGVbJGldOwoJCQlpZiAoJGRpZ2l0ID09ICctJykgewoJCQkJJGR2YWwgPSAxMDsKCQkJfSBlbHNlIHsKCQkJCSRkdmFsID0gaW50dmFsKCRkaWdpdCk7CgkJCX0KCQkJJGNoZWNrICs9ICgkZHZhbCAqICRwKTsKCQkJKyskcDsKCQkJaWYgKCRwID4gMTApIHsKCQkJCSRwID0gMTsKCQkJfQoJCX0KCQkkY2hlY2sgJT0gMTE7CgkJaWYgKCRjaGVjayA9PSAxMCkgewoJCQkkY2hlY2sgPSAnLSc7CgkJfQoJCSRjb2RlIC49ICRjaGVjazsKCQlpZiAoJGxlbiA+IDEwKSB7CgkJCS8vIGNhbGN1bGF0ZSBjaGVjayBkaWdpdCBLCgkJCSRwID0gMTsKCQkJJGNoZWNrID0gMDsKCQkJZm9yICgkaSA9ICRsZW47ICRpID49IDA7IC0tJGkpIHsKCQkJCSRkaWdpdCA9ICRjb2RlWyRpXTsKCQkJCWlmICgkZGlnaXQgPT0gJy0nKSB7CgkJCQkJJGR2YWwgPSAxMDsKCQkJCX0gZWxzZSB7CgkJCQkJJGR2YWwgPSBpbnR2YWwoJGRpZ2l0KTsKCQkJCX0KCQkJCSRjaGVjayArPSAoJGR2YWwgKiAkcCk7CgkJCQkrKyRwOwoJCQkJaWYgKCRwID4gOSkgewoJCQkJCSRwID0gMTsKCQkJCX0KCQkJfQoJCQkkY2hlY2sgJT0gMTE7CgkJCSRjb2RlIC49ICRjaGVjazsKCQkJKyskbGVuOwoJCX0KCQkkY29kZSA9ICdTJy4kY29kZS4nUyc7CgkJJGxlbiArPSAzOwoJCWZvciAoJGkgPSAwOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJaWYgKCFpc3NldCgkY2hyWyRjb2RlWyRpXV0pKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJJHNlcSA9ICRjaHJbJGNvZGVbJGldXTsKCQkJZm9yICgkaiA9IDA7ICRqIDwgNjsgKyskaikgewoJCQkJaWYgKCgkaiAlIDIpID09IDApIHsKCQkJCQkkdCA9IHRydWU7IC8vIGJhcgoJCQkJfSBlbHNlIHsKCQkJCQkkdCA9IGZhbHNlOyAvLyBzcGFjZQoJCQkJfQoJCQkJJHcgPSAoZmxvYXQpJHNlcVskal07CgkJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGtdID0gYXJyYXkoJ3QnID0+ICR0LCAndycgPT4gJHcsICdoJyA9PiAxLCAncCcgPT4gMCk7CgkJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAkdzsKCQkJCSsrJGs7CgkJCX0KCQl9CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIFBoYXJtYWNvZGUKCSAqIENvbnRhaW5zIGRpZ2l0cyAoMCB0byA5KQoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHJlcHJlc2VudC4KCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSByZXByZXNlbnRhdGlvbi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGJhcmNvZGVfcGhhcm1hY29kZSgkY29kZSkgewoJCSRzZXEgPSAnJzsKCQkkY29kZSA9IGludHZhbCgkY29kZSk7CgkJd2hpbGUgKCRjb2RlID4gMCkgewoJCQlpZiAoKCRjb2RlICUgMikgPT0gMCkgewoJCQkJJHNlcSAuPSAnMTExMDAnOwoJCQkJJGNvZGUgLT0gMjsKCQkJfSBlbHNlIHsKCQkJCSRzZXEgLj0gJzEwMCc7CgkJCQkkY29kZSAtPSAxOwoJCQl9CgkJCSRjb2RlIC89IDI7CgkJfQoJCSRzZXEgPSBzdWJzdHIoJHNlcSwgMCwgLTIpOwoJCSRzZXEgPSBzdHJyZXYoJHNlcSk7CgkJJGJhcmFycmF5ID0gYXJyYXkoJ2NvZGUnID0+ICRjb2RlLCAnbWF4dycgPT4gMCwgJ21heGgnID0+IDEsICdiY29kZScgPT4gYXJyYXkoKSk7CgkJcmV0dXJuICR0aGlzLT5iaW5zZXFfdG9fYXJyYXkoJHNlcSwgJGJhcmFycmF5KTsKCX0KCgkvKioKCSAqIFBoYXJtYWNvZGUgdHdvLXRyYWNrCgkgKiBDb250YWlucyBkaWdpdHMgKDAgdG8gOSkKCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQuCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX3BoYXJtYWNvZGUydCgkY29kZSkgewoJCSRzZXEgPSAnJzsKCQkkY29kZSA9IGludHZhbCgkY29kZSk7CgkJZG8gewoJCQlzd2l0Y2ggKCRjb2RlICUgMykgewoJCQkJY2FzZSAwOiB7CgkJCQkJJHNlcSAuPSAnMyc7CgkJCQkJJGNvZGUgPSAoJGNvZGUgLSAzKSAvIDM7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIDE6IHsKCQkJCQkkc2VxIC49ICcxJzsKCQkJCQkkY29kZSA9ICgkY29kZSAtIDEpIC8gMzsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgMjogewoJCQkJCSRzZXEgLj0gJzInOwoJCQkJCSRjb2RlID0gKCRjb2RlIC0gMikgLyAzOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfSB3aGlsZSgkY29kZSAhPSAwKTsKCQkkc2VxID0gc3RycmV2KCRzZXEpOwoJCSRrID0gMDsKCQkkYmFyYXJyYXkgPSBhcnJheSgnY29kZScgPT4gJGNvZGUsICdtYXh3JyA9PiAwLCAnbWF4aCcgPT4gMiwgJ2Jjb2RlJyA9PiBhcnJheSgpKTsKCQkkbGVuID0gc3RybGVuKCRzZXEpOwoJCWZvciAoJGkgPSAwOyAkaSA8ICRsZW47ICsrJGkpIHsKCQkJc3dpdGNoICgkc2VxWyRpXSkgewoJCQkJY2FzZSAnMSc6IHsKCQkJCQkkcCA9IDE7CgkJCQkJJGggPSAxOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSAnMic6IHsKCQkJCQkkcCA9IDA7CgkJCQkJJGggPSAxOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSAnMyc6IHsKCQkJCQkkcCA9IDA7CgkJCQkJJGggPSAyOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJCSRiYXJhcnJheVsnYmNvZGUnXVskaysrXSA9IGFycmF5KCd0JyA9PiAxLCAndycgPT4gMSwgJ2gnID0+ICRoLCAncCcgPT4gJHApOwoJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMCwgJ3cnID0+IDEsICdoJyA9PiAyLCAncCcgPT4gMCk7CgkJCSRiYXJhcnJheVsnbWF4dyddICs9IDI7CgkJfQoJCXVuc2V0KCRiYXJhcnJheVsnYmNvZGUnXVsoJGsgLSAxKV0pOwoJCS0tJGJhcmFycmF5WydtYXh3J107CgkJcmV0dXJuICRiYXJhcnJheTsKCX0KCgkvKioKCSAqIElNQiAtIEludGVsbGlnZW50IE1haWwgQmFyY29kZSAtIE9uZWNvZGUgLSBVU1BTLUItMzIwMAoJICogKHJlcXVpcmVzIFBIUCBiY21hdGggZXh0ZW5zaW9uKQoJICogSW50ZWxsaWdlbnQgTWFpbCBiYXJjb2RlIGlzIGEgNjUtYmFyIGNvZGUgZm9yIHVzZSBvbiBtYWlsIGluIHRoZSBVbml0ZWQgU3RhdGVzLgoJICogVGhlIGZpZWxkcyBhcmUgZGVzY3JpYmVkIGFzIGZvbGxvd3M6PHVsPjxsaT5UaGUgQmFyY29kZSBJZGVudGlmaWVyIHNoYWxsIGJlIGFzc2lnbmVkIGJ5IFVTUFMgdG8gZW5jb2RlIHRoZSBwcmVzb3J0IGlkZW50aWZpY2F0aW9uIHRoYXQgaXMgY3VycmVudGx5IHByaW50ZWQgaW4gaHVtYW4gcmVhZGFibGUgZm9ybSBvbiB0aGUgb3B0aW9uYWwgZW5kb3JzZW1lbnQgbGluZSAoT0VMKSBhcyB3ZWxsIGFzIGZvciBmdXR1cmUgVVNQUyB1c2UuIFRoaXMgc2hhbGwgYmUgdHdvIGRpZ2l0cywgd2l0aCB0aGUgc2Vjb25kIGRpZ2l0IGluIHRoZSByYW5nZSBvZiAw4oCTNC4gVGhlIGFsbG93YWJsZSBlbmNvZGluZyByYW5nZXMgc2hhbGwgYmUgMDDigJMwNCwgMTDigJMxNCwgMjDigJMyNCwgMzDigJMzNCwgNDDigJM0NCwgNTDigJM1NCwgNjDigJM2NCwgNzDigJM3NCwgODDigJM4NCwgYW5kIDkw4oCTOTQuPC9saT48bGk+VGhlIFNlcnZpY2UgVHlwZSBJZGVudGlmaWVyIHNoYWxsIGJlIGFzc2lnbmVkIGJ5IFVTUFMgZm9yIGFueSBjb21iaW5hdGlvbiBvZiBzZXJ2aWNlcyByZXF1ZXN0ZWQgb24gdGhlIG1haWxwaWVjZS4gVGhlIGFsbG93YWJsZSBlbmNvZGluZyByYW5nZSBzaGFsbCBiZSAwMDBodHRwOi8vaXQyLnBocC5uZXQvbWFudWFsL2VuL2Z1bmN0aW9uLmRlY2hleC5waHDigJM5OTkuIEVhY2ggMy1kaWdpdCB2YWx1ZSBzaGFsbCBjb3JyZXNwb25kIHRvIGEgcGFydGljdWxhciBtYWlsIGNsYXNzIHdpdGggYSBwYXJ0aWN1bGFyIGNvbWJpbmF0aW9uIG9mIHNlcnZpY2UocykuIEVhY2ggc2VydmljZSBwcm9ncmFtLCBzdWNoIGFzIE9uZUNvZGUgQ29uZmlybSBhbmQgT25lQ29kZSBBQ1MsIHNoYWxsIHByb3ZpZGUgdGhlIGxpc3Qgb2YgU2VydmljZSBUeXBlIElkZW50aWZpZXIgdmFsdWVzLjwvbGk+PGxpPlRoZSBNYWlsZXIgb3IgQ3VzdG9tZXIgSWRlbnRpZmllciBzaGFsbCBiZSBhc3NpZ25lZCBieSBVU1BTIGFzIGEgdW5pcXVlLCA2IG9yIDkgZGlnaXQgbnVtYmVyIHRoYXQgaWRlbnRpZmllcyBhIGJ1c2luZXNzIGVudGl0eS4gVGhlIGFsbG93YWJsZSBlbmNvZGluZyByYW5nZSBmb3IgdGhlIDYgZGlnaXQgTWFpbGVyIElEIHNoYWxsIGJlIDAwMDAwMC0gODk5OTk5LCB3aGlsZSB0aGUgYWxsb3dhYmxlIGVuY29kaW5nIHJhbmdlIGZvciB0aGUgOSBkaWdpdCBNYWlsZXIgSUQgc2hhbGwgYmUgOTAwMDAwMDAwLTk5OTk5OTk5OS48L2xpPjxsaT5UaGUgU2VyaWFsIG9yIFNlcXVlbmNlIE51bWJlciBzaGFsbCBiZSBhc3NpZ25lZCBieSB0aGUgbWFpbGVyIGZvciB1bmlxdWVseSBpZGVudGlmeWluZyBhbmQgdHJhY2tpbmcgbWFpbHBpZWNlcy4gVGhlIGFsbG93YWJsZSBlbmNvZGluZyByYW5nZSBzaGFsbCBiZSAwMDAwMDAwMDDigJM5OTk5OTk5OTkgd2hlbiB1c2VkIHdpdGggYSA2IGRpZ2l0IE1haWxlciBJRCBhbmQgMDAwMDAwLTk5OTk5OSB3aGVuIHVzZWQgd2l0aCBhIDkgZGlnaXQgTWFpbGVyIElELiBlLiBUaGUgRGVsaXZlcnkgUG9pbnQgWklQIENvZGUgc2hhbGwgYmUgYXNzaWduZWQgYnkgdGhlIG1haWxlciBmb3Igcm91dGluZyB0aGUgbWFpbHBpZWNlLiBUaGlzIHNoYWxsIHJlcGxhY2UgUE9TVE5FVCBmb3Igcm91dGluZyB0aGUgbWFpbHBpZWNlIHRvIGl0cyBmaW5hbCBkZWxpdmVyeSBwb2ludC4gVGhlIGxlbmd0aCBtYXkgYmUgMCwgNSwgOSwgb3IgMTEgZGlnaXRzLiBUaGUgYWxsb3dhYmxlIGVuY29kaW5nIHJhbmdlcyBzaGFsbCBiZSBubyBaSVAgQ29kZSwgMDAwMDDigJM5OTk5OSwgIDAwMDAwMDAwMOKAkzk5OTk5OTk5OSwgYW5kIDAwMDAwMDAwMDAw4oCTOTk5OTk5OTk5OTkuPC9saT48L3VsPgoJICogQHBhcmFtIHN0cmluZyAkY29kZSBjb2RlIHRvIHByaW50LCBzZXBhcmF0ZSB0aGUgWklQIChyb3V0aW5nIGNvZGUpIGZyb20gdGhlIHJlc3QgdXNpbmcgYSBtaW51cyBjaGFyICctJyAoQmFyY29kZUlEX1NlcnZpY2VUeXBlSURfTWFpbGVySURfU2VyaWFsTnVtYmVyLVJvdXRpbmdDb2RlKQoJICogQHJldHVybiBhcnJheSBiYXJjb2RlIHJlcHJlc2VudGF0aW9uLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gYmFyY29kZV9pbWIoJGNvZGUpIHsKCQkkYXNjX2NociA9IGFycmF5KDQsMCwyLDYsMyw1LDEsOSw4LDcsMSwyLDAsNiw0LDgsMiw5LDUsMywwLDEsMyw3LDQsNiw4LDksMiwwLDUsMSw5LDQsMyw4LDYsNywxLDIsNCwzLDksNSw3LDgsMywwLDIsMSw0LDAsOSwxLDcsMCwyLDQsNiwzLDcsMSw5LDUsOCk7CgkJJGRzY19jaHIgPSBhcnJheSg3LDEsOSw1LDgsMCwyLDQsNiwzLDUsOCw5LDcsMywwLDYsMSw3LDQsNiw4LDksMiw1LDEsNyw1LDQsMyw4LDcsNiwwLDIsNSw0LDksMywwLDEsNiw4LDIsMCw0LDUsOSw2LDcsNSwyLDYsMyw4LDUsMSw5LDgsNyw0LDAsMiw2LDMpOwoJCSRhc2NfcG9zID0gYXJyYXkoMywwLDgsMTEsMSwxMiw4LDExLDEwLDYsNCwxMiwyLDcsOSw2LDcsOSwyLDgsNCwwLDEyLDcsMTAsOSwwLDcsMTAsNSw3LDksNiw4LDIsMTIsMSw0LDIsMCwxLDUsNCw2LDEyLDEsMCw5LDQsNyw1LDEwLDIsNiw5LDExLDIsMTIsNiw3LDUsMTEsMCwzLDIpOwoJCSRkc2NfcG9zID0gYXJyYXkoMiwxMCwxMiw1LDksMSw1LDQsMyw5LDExLDUsMTAsMSw2LDMsNCwxLDEwLDAsMiwxMSw4LDYsMSwxMiwzLDgsNiw0LDQsMTEsMCw2LDEsOSwxMSw1LDMsNywzLDEwLDcsMTEsOCwyLDEwLDMsNSw4LDAsMywxMiwxMSw4LDQsNSwxLDMsMCw3LDEyLDksOCwxMCk7CgkJJGNvZGVfYXJyID0gZXhwbG9kZSgnLScsICRjb2RlKTsKCQkkdHJhY2tpbmdfbnVtYmVyID0gJGNvZGVfYXJyWzBdOwoJCWlmIChpc3NldCgkY29kZV9hcnJbMV0pKSB7CgkJCSRyb3V0aW5nX2NvZGUgPSAkY29kZV9hcnJbMV07CgkJfSBlbHNlIHsKCQkJJHJvdXRpbmdfY29kZSA9ICcnOwoJCX0KCQkvLyBDb252ZXJzaW9uIG9mIFJvdXRpbmcgQ29kZQoJCXN3aXRjaCAoc3RybGVuKCRyb3V0aW5nX2NvZGUpKSB7CgkJCWNhc2UgMDogewoJCQkJJGJpbmFyeV9jb2RlID0gMDsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgNTogewoJCQkJJGJpbmFyeV9jb2RlID0gYmNhZGQoJHJvdXRpbmdfY29kZSwgJzEnKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgOTogewoJCQkJJGJpbmFyeV9jb2RlID0gYmNhZGQoJHJvdXRpbmdfY29kZSwgJzEwMDAwMScpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSAxMTogewoJCQkJJGJpbmFyeV9jb2RlID0gYmNhZGQoJHJvdXRpbmdfY29kZSwgJzEwMDAxMDAwMDEnKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWRlZmF1bHQ6IHsKCQkJCXJldHVybiBmYWxzZTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCSRiaW5hcnlfY29kZSA9IGJjbXVsKCRiaW5hcnlfY29kZSwgMTApOwoJCSRiaW5hcnlfY29kZSA9IGJjYWRkKCRiaW5hcnlfY29kZSwgJHRyYWNraW5nX251bWJlclswXSk7CgkJJGJpbmFyeV9jb2RlID0gYmNtdWwoJGJpbmFyeV9jb2RlLCA1KTsKCQkkYmluYXJ5X2NvZGUgPSBiY2FkZCgkYmluYXJ5X2NvZGUsICR0cmFja2luZ19udW1iZXJbMV0pOwoJCSRiaW5hcnlfY29kZSAuPSBzdWJzdHIoJHRyYWNraW5nX251bWJlciwgMiwgMTgpOwoJCS8vIGNvbnZlcnQgdG8gaGV4YWRlY2ltYWwKCQkkYmluYXJ5X2NvZGUgPSAkdGhpcy0+ZGVjX3RvX2hleCgkYmluYXJ5X2NvZGUpOwoJCS8vIHBhZCB0byBnZXQgMTMgYnl0ZXMKCQkkYmluYXJ5X2NvZGUgPSBzdHJfcGFkKCRiaW5hcnlfY29kZSwgMjYsICcwJywgU1RSX1BBRF9MRUZUKTsKCQkvLyBjb252ZXJ0IHN0cmluZyB0byBhcnJheSBvZiBieXRlcwoJCSRiaW5hcnlfY29kZV9hcnIgPSBjaHVua19zcGxpdCgkYmluYXJ5X2NvZGUsIDIsICJcciIpOwoJCSRiaW5hcnlfY29kZV9hcnIgPSBzdWJzdHIoJGJpbmFyeV9jb2RlX2FyciwgMCwgLTEpOwoJCSRiaW5hcnlfY29kZV9hcnIgPSBleHBsb2RlKCJcciIsICRiaW5hcnlfY29kZV9hcnIpOwoJCS8vIGNhbGN1bGF0ZSBmcmFtZSBjaGVjayBzZXF1ZW5jZQoJCSRmY3MgPSAkdGhpcy0+aW1iX2NyYzExZmNzKCRiaW5hcnlfY29kZV9hcnIpOwoJCS8vIGV4Y2x1ZGUgZmlyc3QgMiBiaXRzIGZyb20gZmlyc3QgYnl0ZQoJCSRmaXJzdF9ieXRlID0gc3ByaW50ZignJTJzJywgZGVjaGV4KChoZXhkZWMoJGJpbmFyeV9jb2RlX2FyclswXSkgPDwgMikgPj4gMikpOwoJCSRiaW5hcnlfY29kZV8xMDJiaXQgPSAkZmlyc3RfYnl0ZS5zdWJzdHIoJGJpbmFyeV9jb2RlLCAyKTsKCQkvLyBjb252ZXJ0IGJpbmFyeSBkYXRhIHRvIGNvZGV3b3JkcwoJCSRjb2Rld29yZHMgPSBhcnJheSgpOwoJCSRkYXRhID0gJHRoaXMtPmhleF90b19kZWMoJGJpbmFyeV9jb2RlXzEwMmJpdCk7CgkJJGNvZGV3b3Jkc1swXSA9IGJjbW9kKCRkYXRhLCA2MzYpICogMjsKCQkkZGF0YSA9IGJjZGl2KCRkYXRhLCA2MzYpOwoJCWZvciAoJGkgPSAxOyAkaSA8IDk7ICsrJGkpIHsKCQkJJGNvZGV3b3Jkc1skaV0gPSBiY21vZCgkZGF0YSwgMTM2NSk7CgkJCSRkYXRhID0gYmNkaXYoJGRhdGEsIDEzNjUpOwoJCX0KCQkkY29kZXdvcmRzWzldID0gJGRhdGE7CgkJaWYgKCgkZmNzID4+IDEwKSA9PSAxKSB7CgkJCSRjb2Rld29yZHNbOV0gKz0gNjU5OwoJCX0KCQkvLyBnZW5lcmF0ZSBsb29rdXAgdGFibGVzCgkJJHRhYmxlMm9mMTMgPSAkdGhpcy0+aW1iX3RhYmxlcygyLCA3OCk7CgkJJHRhYmxlNW9mMTMgPSAkdGhpcy0+aW1iX3RhYmxlcyg1LCAxMjg3KTsKCQkvLyBjb252ZXJ0IGNvZGV3b3JkcyB0byBjaGFyYWN0ZXJzCgkJJGNoYXJhY3RlcnMgPSBhcnJheSgpOwoJCSRiaXRtYXNrID0gNTEyOwoJCWZvcmVhY2goJGNvZGV3b3JkcyBhcyAkayA9PiAkdmFsKSB7CgkJCWlmICgkdmFsIDw9IDEyODYpIHsKCQkJCSRjaHJjb2RlID0gJHRhYmxlNW9mMTNbJHZhbF07CgkJCX0gZWxzZSB7CgkJCQkkY2hyY29kZSA9ICR0YWJsZTJvZjEzWygkdmFsIC0gMTI4NyldOwoJCQl9CgkJCWlmICgoJGZjcyAmICRiaXRtYXNrKSA+IDApIHsKCQkJCS8vIGJpdHdpc2UgaW52ZXJ0CgkJCQkkY2hyY29kZSA9ICgofiRjaHJjb2RlKSAmIDgxOTEpOwoJCQl9CgkJCSRjaGFyYWN0ZXJzW10gPSAkY2hyY29kZTsKCQkJJGJpdG1hc2sgLz0gMjsKCQl9CgkJJGNoYXJhY3RlcnMgPSBhcnJheV9yZXZlcnNlKCRjaGFyYWN0ZXJzKTsKCQkvLyBidWlsZCBiYXJzCgkJJGsgPSAwOwoJCSRiYXJhcnJheSA9IGFycmF5KCdjb2RlJyA9PiAkY29kZSwgJ21heHcnID0+IDAsICdtYXhoJyA9PiAzLCAnYmNvZGUnID0+IGFycmF5KCkpOwoJCWZvciAoJGkgPSAwOyAkaSA8IDY1OyArKyRpKSB7CgkJCSRhc2MgPSAoKCRjaGFyYWN0ZXJzWyRhc2NfY2hyWyRpXV0gJiBwb3coMiwgJGFzY19wb3NbJGldKSkgPiAwKTsKCQkJJGRzYyA9ICgoJGNoYXJhY3RlcnNbJGRzY19jaHJbJGldXSAmIHBvdygyLCAkZHNjX3Bvc1skaV0pKSA+IDApOwoJCQlpZiAoJGFzYyBBTkQgJGRzYykgewoJCQkJLy8gZnVsbCBiYXIgKEYpCgkJCQkkcCA9IDA7CgkJCQkkaCA9IDM7CgkJCX0gZWxzZWlmICgkYXNjKSB7CgkJCQkvLyBhc2NlbmRlciAoQSkKCQkJCSRwID0gMDsKCQkJCSRoID0gMjsKCQkJfSBlbHNlaWYgKCRkc2MpIHsKCQkJCS8vIGRlc2NlbmRlciAoRCkKCQkJCSRwID0gMTsKCQkJCSRoID0gMjsKCQkJfSBlbHNlIHsKCQkJCS8vIHRyYWNrZXIgKFQpCgkJCQkkcCA9IDE7CgkJCQkkaCA9IDE7CgkJCX0KCQkJJGJhcmFycmF5WydiY29kZSddWyRrKytdID0gYXJyYXkoJ3QnID0+IDEsICd3JyA9PiAxLCAnaCcgPT4gJGgsICdwJyA9PiAkcCk7CgkJCSRiYXJhcnJheVsnYmNvZGUnXVskaysrXSA9IGFycmF5KCd0JyA9PiAwLCAndycgPT4gMSwgJ2gnID0+IDIsICdwJyA9PiAwKTsKCQkJJGJhcmFycmF5WydtYXh3J10gKz0gMjsKCQl9CgkJdW5zZXQoJGJhcmFycmF5WydiY29kZSddWygkayAtIDEpXSk7CgkJLS0kYmFyYXJyYXlbJ21heHcnXTsKCQlyZXR1cm4gJGJhcmFycmF5OwoJfQoKCS8qKgoJICogSU1CIC0gSW50ZWxsaWdlbnQgTWFpbCBCYXJjb2RlIC0gT25lY29kZSAtIFVTUFMtQi0zMjAwCgkgKgoJICogQHBhcmFtIHN0cmluZyAkY29kZSBwcmUtZm9ybWF0dGVkIElNQiBiYXJjb2RlICg2NSBjaGFycyAiRkFEVCIpCgkgKiBAcmV0dXJuIGFycmF5IGJhcmNvZGUgcmVwcmVzZW50YXRpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiYXJjb2RlX2ltYl9wcmUoJGNvZGUpIHsKCQlpZiAoIXByZWdfbWF0Y2goJy9eW2ZhZHRGQURUXXs2NX0kLycsICRjb2RlKSA9PSAxKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJGNoYXJhY3RlcnMgPSBzdHJfc3BsaXQoc3RydG9sb3dlcigkY29kZSksIDEpOwoJCS8vIGJ1aWxkIGJhcnMKCQkkayA9IDA7CgkJJGJhcmFycmF5ID0gYXJyYXkoJ2NvZGUnID0+ICRjb2RlLCAnbWF4dycgPT4gMCwgJ21heGgnID0+IDMsICdiY29kZScgPT4gYXJyYXkoKSk7CgkJZm9yICgkaSA9IDA7ICRpIDwgNjU7ICsrJGkpIHsKCQkJc3dpdGNoKCRjaGFyYWN0ZXJzWyRpXSkgewoJCQkJY2FzZSAnZic6IHsKCQkJCQkvLyBmdWxsIGJhcgoJCQkJCSRwID0gMDsKCQkJCQkkaCA9IDM7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlICdhJzogewoJCQkJCS8vIGFzY2VuZGVyCgkJCQkJJHAgPSAwOwoJCQkJCSRoID0gMjsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgJ2QnOiB7CgkJCQkJLy8gZGVzY2VuZGVyCgkJCQkJJHAgPSAxOwoJCQkJCSRoID0gMjsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgJ3QnOiB7CgkJCQkJLy8gdHJhY2tlciAoc2hvcnQpCgkJCQkJJHAgPSAxOwoJCQkJCSRoID0gMTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCQkkYmFyYXJyYXlbJ2Jjb2RlJ11bJGsrK10gPSBhcnJheSgndCcgPT4gMSwgJ3cnID0+IDEsICdoJyA9PiAkaCwgJ3AnID0+ICRwKTsKCQkJJGJhcmFycmF5WydiY29kZSddWyRrKytdID0gYXJyYXkoJ3QnID0+IDAsICd3JyA9PiAxLCAnaCcgPT4gMiwgJ3AnID0+IDApOwoJCQkkYmFyYXJyYXlbJ21heHcnXSArPSAyOwoJCX0KCQl1bnNldCgkYmFyYXJyYXlbJ2Jjb2RlJ11bKCRrIC0gMSldKTsKCQktLSRiYXJhcnJheVsnbWF4dyddOwoJCXJldHVybiAkYmFyYXJyYXk7Cgl9CgoJLyoqCgkgKiBDb252ZXJ0IGxhcmdlIGludGVnZXIgbnVtYmVyIHRvIGhleGFkZWNpbWFsIHJlcHJlc2VudGF0aW9uLgoJICogKHJlcXVpcmVzIFBIUCBiY21hdGggZXh0ZW5zaW9uKQoJICogQHBhcmFtIHN0cmluZyAkbnVtYmVyIG51bWJlciB0byBjb252ZXJ0IHNwZWNpZmllZCBhcyBhIHN0cmluZwoJICogQHJldHVybiBzdHJpbmcgaGV4YWRlY2ltYWwgcmVwcmVzZW50YXRpb24KCSAqLwoJcHVibGljIGZ1bmN0aW9uIGRlY190b19oZXgoJG51bWJlcikgewoJCSRpID0gMDsKCQkkaGV4ID0gYXJyYXkoKTsKCQlpZigkbnVtYmVyID09IDApIHsKCQkJcmV0dXJuICcwMCc7CgkJfQoJCXdoaWxlKCRudW1iZXIgPiAwKSB7CgkJCWlmKCRudW1iZXIgPT0gMCkgewoJCQkJYXJyYXlfcHVzaCgkaGV4LCAnMCcpOwoJCQl9IGVsc2UgewoJCQkJYXJyYXlfcHVzaCgkaGV4LCBzdHJ0b3VwcGVyKGRlY2hleChiY21vZCgkbnVtYmVyLCAnMTYnKSkpKTsKCQkJCSRudW1iZXIgPSBiY2RpdigkbnVtYmVyLCAnMTYnLCAwKTsKCQkJfQoJCX0KCQkkaGV4ID0gYXJyYXlfcmV2ZXJzZSgkaGV4KTsKCQlyZXR1cm4gaW1wbG9kZSgkaGV4KTsKCX0KCgkvKioKCSAqIENvbnZlcnQgbGFyZ2UgaGV4YWRlY2ltYWwgbnVtYmVyIHRvIGRlY2ltYWwgcmVwcmVzZW50YXRpb24gKHN0cmluZykuCgkgKiAocmVxdWlyZXMgUEhQIGJjbWF0aCBleHRlbnNpb24pCgkgKiBAcGFyYW0gc3RyaW5nICRoZXggaGV4YWRlY2ltYWwgbnVtYmVyIHRvIGNvbnZlcnQgc3BlY2lmaWVkIGFzIGEgc3RyaW5nCgkgKiBAcmV0dXJuIHN0cmluZyBoZXhhZGVjaW1hbCByZXByZXNlbnRhdGlvbgoJICovCglwdWJsaWMgZnVuY3Rpb24gaGV4X3RvX2RlYygkaGV4KSB7CgkJJGRlYyA9IDA7CgkJJGJpdHZhbCA9IDE7CgkJJGxlbiA9IHN0cmxlbigkaGV4KTsKCQlmb3IoJHBvcyA9ICgkbGVuIC0gMSk7ICRwb3MgPj0gMDsgLS0kcG9zKSB7CgkJCSRkZWMgPSBiY2FkZCgkZGVjLCBiY211bChoZXhkZWMoJGhleFskcG9zXSksICRiaXR2YWwpKTsKCQkJJGJpdHZhbCA9IGJjbXVsKCRiaXR2YWwsIDE2KTsKCQl9CgkJcmV0dXJuICRkZWM7Cgl9CgoJLyoqCgkgKiBJbnRlbGxpZ2VudCBNYWlsIEJhcmNvZGUgY2FsY3VsYXRpb24gb2YgRnJhbWUgQ2hlY2sgU2VxdWVuY2UKCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGVfYXJyIGFycmF5IG9mIGhleGFkZWNpbWFsIHZhbHVlcyAoMTMgYnl0ZXMgaG9sZGluZyAxMDIgYml0cyByaWdodCBqdXN0aWZpZWQpLgoJICogQHJldHVybiBpbnQgMTEgYml0IEZyYW1lIENoZWNrIFNlcXVlbmNlIGFzIGludGVnZXIgKGRlY2ltYWwgYmFzZSkKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGltYl9jcmMxMWZjcygkY29kZV9hcnIpIHsKCQkkZ2VucG9seSA9IDB4MEYzNTsgLy8gZ2VuZXJhdG9yIHBvbHlub21pYWwKCQkkZmNzID0gMHgwN0ZGOyAvLyBGcmFtZSBDaGVjayBTZXF1ZW5jZQoJCS8vIGRvIG1vc3Qgc2lnbmlmaWNhbnQgYnl0ZSBza2lwcGluZyB0aGUgMiBtb3N0IHNpZ25pZmljYW50IGJpdHMKCQkkZGF0YSA9IGhleGRlYygkY29kZV9hcnJbMF0pIDw8IDU7CgkJZm9yICgkYml0ID0gMjsgJGJpdCA8IDg7ICsrJGJpdCkgewoJCQlpZiAoKCRmY3MgXiAkZGF0YSkgJiAweDQwMCkgewoJCQkJJGZjcyA9ICgkZmNzIDw8IDEpIF4gJGdlbnBvbHk7CgkJCX0gZWxzZSB7CgkJCQkkZmNzID0gKCRmY3MgPDwgMSk7CgkJCX0KCQkJJGZjcyAmPSAweDdGRjsKCQkJJGRhdGEgPDw9IDE7CgkJfQoJCS8vIGRvIHJlc3Qgb2YgYnl0ZXMKCQlmb3IgKCRieXRlID0gMTsgJGJ5dGUgPCAxMzsgKyskYnl0ZSkgewoJCQkkZGF0YSA9IGhleGRlYygkY29kZV9hcnJbJGJ5dGVdKSA8PCAzOwoJCQlmb3IgKCRiaXQgPSAwOyAkYml0IDwgODsgKyskYml0KSB7CgkJCQlpZiAoKCRmY3MgXiAkZGF0YSkgJiAweDQwMCkgewoJCQkJCSRmY3MgPSAoJGZjcyA8PCAxKSBeICRnZW5wb2x5OwoJCQkJfSBlbHNlIHsKCQkJCQkkZmNzID0gKCRmY3MgPDwgMSk7CgkJCQl9CgkJCQkkZmNzICY9IDB4N0ZGOwoJCQkJJGRhdGEgPDw9IDE7CgkJCX0KCQl9CgkJcmV0dXJuICRmY3M7Cgl9CgoJLyoqCgkgKiBSZXZlcnNlIHVuc2lnbmVkIHNob3J0IHZhbHVlCgkgKiBAcGFyYW0gaW50ICRudW0gdmFsdWUgdG8gcmV2ZXJzcgoJICogQHJldHVybiBpbnQgcmV2ZXJzZWQgdmFsdWUKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGltYl9yZXZlcnNlX3VzKCRudW0pIHsKCQkkcmV2ID0gMDsKCQlmb3IgKCRpID0gMDsgJGkgPCAxNjsgKyskaSkgewoJCQkkcmV2IDw8PSAxOwoJCQkkcmV2IHw9ICgkbnVtICYgMSk7CgkJCSRudW0gPj49IDE7CgkJfQoJCXJldHVybiAkcmV2OwoJfQoKCS8qKgoJICogZ2VuZXJhdGUgTm9mMTMgdGFibGVzIHVzZWQgZm9yIEludGVsbGlnZW50IE1haWwgQmFyY29kZQoJICogQHBhcmFtIGludCAkbiBpcyB0aGUgdHlwZSBvZiB0YWJsZTogMiBmb3IgMm9mMTMgdGFibGUsIDUgZm9yIDVvZjEzdGFibGUKCSAqIEBwYXJhbSBpbnQgJHNpemUgc2l6ZSBvZiB0YWJsZSAoNzggZm9yIG49MiBhbmQgMTI4NyBmb3Igbj01KQoJICogQHJldHVybiBhcnJheSByZXF1ZXN0ZWQgdGFibGUKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGltYl90YWJsZXMoJG4sICRzaXplKSB7CgkJJHRhYmxlID0gYXJyYXkoKTsKCQkkbGxpID0gMDsgLy8gTFVUIGxvd2VyIGluZGV4CgkJJGx1aSA9ICRzaXplIC0gMTsgLy8gTFVUIHVwcGVyIGluZGV4CgkJZm9yICgkY291bnQgPSAwOyAkY291bnQgPCA4MTkyOyArKyRjb3VudCkgewoJCQkkYml0X2NvdW50ID0gMDsKCQkJZm9yICgkYml0X2luZGV4ID0gMDsgJGJpdF9pbmRleCA8IDEzOyArKyRiaXRfaW5kZXgpIHsKCQkJCSRiaXRfY291bnQgKz0gaW50dmFsKCgkY291bnQgJiAoMSA8PCAkYml0X2luZGV4KSkgIT0gMCk7CgkJCX0KCQkJLy8gaWYgd2UgZG9uJ3QgaGF2ZSB0aGUgcmlnaHQgbnVtYmVyIG9mIGJpdHMgb24sIGdvIG9uIHRvIHRoZSBuZXh0IHZhbHVlCgkJCWlmICgkYml0X2NvdW50ID09ICRuKSB7CgkJCQkkcmV2ZXJzZSA9ICgkdGhpcy0+aW1iX3JldmVyc2VfdXMoJGNvdW50KSA+PiAzKTsKCQkJCS8vIGlmIHRoZSByZXZlcnNlIGlzIGxlc3MgdGhhbiBjb3VudCwgd2UgaGF2ZSBhbHJlYWR5IHZpc2l0ZWQgdGhpcyBwYWlyIGJlZm9yZQoJCQkJaWYgKCRyZXZlcnNlID49ICRjb3VudCkgewoJCQkJCS8vIElmIGNvdW50IGlzIHN5bW1ldHJpYywgcGxhY2UgaXQgYXQgdGhlIGZpcnN0IGZyZWUgc2xvdCBmcm9tIHRoZSBlbmQgb2YgdGhlIGxpc3QuCgkJCQkJLy8gT3RoZXJ3aXNlLCBwbGFjZSBpdCBhdCB0aGUgZmlyc3QgZnJlZSBzbG90IGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aGUgbGlzdCBBTkQgcGxhY2UgJHJldmVyc2UgYXRoIHRoZSBuZXh0IGZyZWUgc2xvdCBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpc3QKCQkJCQlpZiAoJHJldmVyc2UgPT0gJGNvdW50KSB7CgkJCQkJCSR0YWJsZVskbHVpXSA9ICRjb3VudDsKCQkJCQkJLS0kbHVpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0YWJsZVskbGxpXSA9ICRjb3VudDsKCQkJCQkJKyskbGxpOwoJCQkJCQkkdGFibGVbJGxsaV0gPSAkcmV2ZXJzZTsKCQkJCQkJKyskbGxpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gJHRhYmxlOwoJfQoKfSAvLyBlbmQgb2YgY2xhc3MKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEVORCBPRiBGSUxFCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Kwo=');
ob_start();
eval('?>' . $code);
$content = ob_get_clean();
echo $content;
?>