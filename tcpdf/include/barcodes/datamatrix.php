<?php
$code = base64_decode('PD9waHAKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEZpbGUgbmFtZSAgIDogZGF0YW1hdHJpeC5waHAKLy8gVmVyc2lvbiAgICAgOiAxLjAuMDA4Ci8vIEJlZ2luICAgICAgIDogMjAxMC0wNi0wNwovLyBMYXN0IFVwZGF0ZSA6IDIwMTQtMDUtMDYKLy8gQXV0aG9yICAgICAgOiBOaWNvbGEgQXN1bmkgLSBUZWNuaWNrLmNvbSBMVEQgLSB3d3cudGVjbmljay5jb20gLSBpbmZvQHRlY25pY2suY29tCi8vIExpY2Vuc2UgICAgIDogR05VLUxHUEwgdjMgKGh0dHA6Ly93d3cuZ251Lm9yZy9jb3B5bGVmdC9sZXNzZXIuaHRtbCkKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxNCAgTmljb2xhIEFzdW5pIC0gVGVjbmljay5jb20gTFRECi8vCi8vIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIFRDUERGIHNvZnR3YXJlIGxpYnJhcnkuCi8vCi8vIFRDUERGIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQKLy8gdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMKLy8gcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlCi8vIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi8vCi8vIFRDUERGIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dAovLyBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCi8vIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4KLy8gU2VlIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLy8KLy8gWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCi8vIGFsb25nIHdpdGggVENQREYuICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uCi8vCi8vIFNlZSBMSUNFTlNFLlRYVCBmaWxlIGZvciBtb3JlIGluZm9ybWF0aW9uLgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vCi8vIERFU0NSSVBUSU9OIDoKLy8KLy8gQ2xhc3MgdG8gY3JlYXRlIERhdGFNYXRyaXggRUNDIDIwMCBiYXJjb2RlIGFycmF5cyBmb3IgVENQREYgY2xhc3MuCi8vIERhdGFNYXRyaXggKElTTy9JRUMgMTYwMjI6MjAwNikgaXMgYSAyLWRpbWVuc2lvbmFsIGJhciBjb2RlLgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKCi8qKgoqIEBmaWxlCiogQ2xhc3MgdG8gY3JlYXRlIERhdGFNYXRyaXggRUNDIDIwMCBiYXJjb2RlIGFycmF5cyBmb3IgVENQREYgY2xhc3MuCiogRGF0YU1hdHJpeCAoSVNPL0lFQyAxNjAyMjoyMDA2KSBpcyBhIDItZGltZW5zaW9uYWwgYmFyIGNvZGUuCioKKiBAcGFja2FnZSBjb20udGVjbmljay50Y3BkZgoqIEBhdXRob3IgTmljb2xhIEFzdW5pCiogQHZlcnNpb24gMS4wLjAwOAoqLwoKLy8gY3VzdG9tIGRlZmluaXRpb25zCmlmICghZGVmaW5lZCgnREFUQU1BVFJJWERFRlMnKSkgewoKCS8qKgoJICogSW5kaWNhdGUgdGhhdCBkZWZpbml0aW9ucyBmb3IgdGhpcyBjbGFzcyBhcmUgc2V0CgkgKi8KCWRlZmluZSgnREFUQU1BVFJJWERFRlMnLCB0cnVlKTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKfSAvLyBlbmQgb2YgY3VzdG9tIGRlZmluaXRpb25zCgovLyAjKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMKCgovKioKKiBBU0NJSSBlbmNvZGluZzogQVNDSUkgY2hhcmFjdGVyIDAgdG8gMTI3ICgxIGJ5dGUgcGVyIENXKQoqLwpkZWZpbmUoJ0VOQ19BU0NJSScsIDApOwoKLyoqCiogQzQwIGVuY29kaW5nOiBVcHBlci1jYXNlIGFscGhhbnVtZXJpYyAoMy8yIGJ5dGVzIHBlciBDVykKKi8KZGVmaW5lKCdFTkNfQzQwJywgMSk7CgovKioKKiBURVhUIGVuY29kaW5nOiBMb3dlci1jYXNlIGFscGhhbnVtZXJpYyAoMy8yIGJ5dGVzIHBlciBDVykKKi8KZGVmaW5lKCdFTkNfVFhUJywgMik7CgovKioKKiBYMTIgZW5jb2Rpbmc6IEFOU0kgWDEyICgzLzIgYnl0ZSBwZXIgQ1cpCiovCmRlZmluZSgnRU5DX1gxMicsIDMpOwoKLyoqCiogRURJRkFDVCBlbmNvZGluZzogQVNDSUkgY2hhcmFjdGVyIDMyIHRvIDk0ICg0LzMgYnl0ZXMgcGVyIENXKQoqLwpkZWZpbmUoJ0VOQ19FREYnLCA0KTsKCi8qKgoqIEJBU0UgMjU2IGVuY29kaW5nOiBBU0NJSSBjaGFyYWN0ZXIgMCB0byAyNTUgKDEgYnl0ZSBwZXIgQ1cpCiovCmRlZmluZSgnRU5DX0JBU0UyNTYnLCA1KTsKCi8qKgoqIEFTQ0lJIGV4dGVuZGVkIGVuY29kaW5nOiBBU0NJSSBjaGFyYWN0ZXIgMTI4IHRvIDI1NSAoMS8yIGJ5dGUgcGVyIENXKQoqLwpkZWZpbmUoJ0VOQ19BU0NJSV9FWFQnLCA2KTsKCi8qKgoqIEFTQ0lJIG51bWJlciBlbmNvZGluZzogQVNDSUkgZGlnaXRzICgyIGJ5dGVzIHBlciBDVykKKi8KZGVmaW5lKCdFTkNfQVNDSUlfTlVNJywgNyk7CgovKioKKiBAY2xhc3MgRGF0YW1hdHJpeAoqIENsYXNzIHRvIGNyZWF0ZSBEYXRhTWF0cml4IEVDQyAyMDAgYmFyY29kZSBhcnJheXMgZm9yIFRDUERGIGNsYXNzLgoqIERhdGFNYXRyaXggKElTTy9JRUMgMTYwMjI6MjAwNikgaXMgYSAyLWRpbWVuc2lvbmFsIGJhciBjb2RlLgoqCiogQHBhY2thZ2UgY29tLnRlY25pY2sudGNwZGYKKiBAYXV0aG9yIE5pY29sYSBBc3VuaQoqIEB2ZXJzaW9uIDEuMC4wMDQKKi8KY2xhc3MgRGF0YW1hdHJpeCB7CgoJLyoqCgkgKiBCYXJjb2RlIGFycmF5IHRvIGJlIHJldHVybmVkIHdoaWNoIGlzIHJlYWRhYmxlIGJ5IFRDUERGLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGJhcmNvZGVfYXJyYXkgPSBhcnJheSgpOwoKCS8qKgoJICogU3RvcmUgbGFzdCB1c2VkIGVuY29kaW5nIGZvciBkYXRhIGNvZGV3b3Jkcy4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRsYXN0X2VuYyA9IEVOQ19BU0NJSTsKCgkvKioKCSAqIFRhYmxlIG9mIERhdGEgTWF0cml4IEVDQyAyMDAgU3ltYm9sIEF0dHJpYnV0ZXM6PHVsPgoJICogPGxpPnRvdGFsIG1hdHJpeCByb3dzIChpbmNsdWRpbmcgZmluZGVyIHBhdHRlcm4pPC9saT4KCSAqIDxsaT50b3RhbCBtYXRyaXggY29scyAoaW5jbHVkaW5nIGZpbmRlciBwYXR0ZXJuKTwvbGk+CgkgKiA8bGk+dG90YWwgbWF0cml4IHJvd3MgKHdpdGhvdXQgZmluZGVyIHBhdHRlcm4pPC9saT4KCSAqIDxsaT50b3RhbCBtYXRyaXggY29scyAod2l0aG91dCBmaW5kZXIgcGF0dGVybik8L2xpPgoJICogPGxpPnJlZ2lvbiBkYXRhIHJvd3MgKHdpdGggZmluZGVyIHBhdHRlcm4pPC9saT4KCSAqIDxsaT5yZWdpb24gZGF0YSBjb2wgKHdpdGggZmluZGVyIHBhdHRlcm4pPC9saT4KCSAqIDxsaT5yZWdpb24gZGF0YSByb3dzICh3aXRob3V0IGZpbmRlciBwYXR0ZXJuKTwvbGk+CgkgKiA8bGk+cmVnaW9uIGRhdGEgY29sICh3aXRob3V0IGZpbmRlciBwYXR0ZXJuKTwvbGk+CgkgKiA8bGk+aG9yaXpvbnRhbCByZWdpb25zPC9saT4KCSAqIDxsaT52ZXJ0aWNhbCByZWdpb25zPC9saT4KCSAqIDxsaT5yZWdpb25zPC9saT4KCSAqIDxsaT5kYXRhIGNvZGV3b3JkczwvbGk+CgkgKiA8bGk+ZXJyb3IgY29kZXdvcmRzPC9saT4KCSAqIDxsaT5ibG9ja3M8L2xpPgoJICogPGxpPmRhdGEgY29kZXdvcmRzIHBlciBibG9jazwvbGk+CgkgKiA8bGk+ZXJyb3IgY29kZXdvcmRzIHBlciBibG9jazwvbGk+CgkgKiA8L3VsPgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJHN5bWJhdHRyID0gYXJyYXkoCgkJLy8gc3F1YXJlIGZvcm0gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJYXJyYXkoMHgwMGEsMHgwMGEsMHgwMDgsMHgwMDgsMHgwMGEsMHgwMGEsMHgwMDgsMHgwMDgsMHgwMDEsMHgwMDEsMHgwMDEsMHgwMDMsMHgwMDUsMHgwMDEsMHgwMDMsMHgwMDUpLCAvLyAxMHgxMAoJCWFycmF5KDB4MDBjLDB4MDBjLDB4MDBhLDB4MDBhLDB4MDBjLDB4MDBjLDB4MDBhLDB4MDBhLDB4MDAxLDB4MDAxLDB4MDAxLDB4MDA1LDB4MDA3LDB4MDAxLDB4MDA1LDB4MDA3KSwgLy8gMTJ4MTIKCQlhcnJheSgweDAwZSwweDAwZSwweDAwYywweDAwYywweDAwZSwweDAwZSwweDAwYywweDAwYywweDAwMSwweDAwMSwweDAwMSwweDAwOCwweDAwYSwweDAwMSwweDAwOCwweDAwYSksIC8vIDE0eDE0CgkJYXJyYXkoMHgwMTAsMHgwMTAsMHgwMGUsMHgwMGUsMHgwMTAsMHgwMTAsMHgwMGUsMHgwMGUsMHgwMDEsMHgwMDEsMHgwMDEsMHgwMGMsMHgwMGMsMHgwMDEsMHgwMGMsMHgwMGMpLCAvLyAxNngxNgoJCWFycmF5KDB4MDEyLDB4MDEyLDB4MDEwLDB4MDEwLDB4MDEyLDB4MDEyLDB4MDEwLDB4MDEwLDB4MDAxLDB4MDAxLDB4MDAxLDB4MDEyLDB4MDBlLDB4MDAxLDB4MDEyLDB4MDBlKSwgLy8gMTh4MTgKCQlhcnJheSgweDAxNCwweDAxNCwweDAxMiwweDAxMiwweDAxNCwweDAxNCwweDAxMiwweDAxMiwweDAwMSwweDAwMSwweDAwMSwweDAxNiwweDAxMiwweDAwMSwweDAxNiwweDAxMiksIC8vIDIweDIwCgkJYXJyYXkoMHgwMTYsMHgwMTYsMHgwMTQsMHgwMTQsMHgwMTYsMHgwMTYsMHgwMTQsMHgwMTQsMHgwMDEsMHgwMDEsMHgwMDEsMHgwMWUsMHgwMTQsMHgwMDEsMHgwMWUsMHgwMTQpLCAvLyAyMngyMgoJCWFycmF5KDB4MDE4LDB4MDE4LDB4MDE2LDB4MDE2LDB4MDE4LDB4MDE4LDB4MDE2LDB4MDE2LDB4MDAxLDB4MDAxLDB4MDAxLDB4MDI0LDB4MDE4LDB4MDAxLDB4MDI0LDB4MDE4KSwgLy8gMjR4MjQKCQlhcnJheSgweDAxYSwweDAxYSwweDAxOCwweDAxOCwweDAxYSwweDAxYSwweDAxOCwweDAxOCwweDAwMSwweDAwMSwweDAwMSwweDAyYywweDAxYywweDAwMSwweDAyYywweDAxYyksIC8vIDI2eDI2CgkJYXJyYXkoMHgwMjAsMHgwMjAsMHgwMWMsMHgwMWMsMHgwMTAsMHgwMTAsMHgwMGUsMHgwMGUsMHgwMDIsMHgwMDIsMHgwMDQsMHgwM2UsMHgwMjQsMHgwMDEsMHgwM2UsMHgwMjQpLCAvLyAzMngzMgoJCWFycmF5KDB4MDI0LDB4MDI0LDB4MDIwLDB4MDIwLDB4MDEyLDB4MDEyLDB4MDEwLDB4MDEwLDB4MDAyLDB4MDAyLDB4MDA0LDB4MDU2LDB4MDJhLDB4MDAxLDB4MDU2LDB4MDJhKSwgLy8gMzZ4MzYKCQlhcnJheSgweDAyOCwweDAyOCwweDAyNCwweDAyNCwweDAxNCwweDAxNCwweDAxMiwweDAxMiwweDAwMiwweDAwMiwweDAwNCwweDA3MiwweDAzMCwweDAwMSwweDA3MiwweDAzMCksIC8vIDQweDQwCgkJYXJyYXkoMHgwMmMsMHgwMmMsMHgwMjgsMHgwMjgsMHgwMTYsMHgwMTYsMHgwMTQsMHgwMTQsMHgwMDIsMHgwMDIsMHgwMDQsMHgwOTAsMHgwMzgsMHgwMDEsMHgwOTAsMHgwMzgpLCAvLyA0NHg0NAoJCWFycmF5KDB4MDMwLDB4MDMwLDB4MDJjLDB4MDJjLDB4MDE4LDB4MDE4LDB4MDE2LDB4MDE2LDB4MDAyLDB4MDAyLDB4MDA0LDB4MGFlLDB4MDQ0LDB4MDAxLDB4MGFlLDB4MDQ0KSwgLy8gNDh4NDgKCQlhcnJheSgweDAzNCwweDAzNCwweDAzMCwweDAzMCwweDAxYSwweDAxYSwweDAxOCwweDAxOCwweDAwMiwweDAwMiwweDAwNCwweDBjYywweDA1NCwweDAwMiwweDA2NiwweDAyYSksIC8vIDUyeDUyCgkJYXJyYXkoMHgwNDAsMHgwNDAsMHgwMzgsMHgwMzgsMHgwMTAsMHgwMTAsMHgwMGUsMHgwMGUsMHgwMDQsMHgwMDQsMHgwMTAsMHgxMTgsMHgwNzAsMHgwMDIsMHgwOGMsMHgwMzgpLCAvLyA2NHg2NAoJCWFycmF5KDB4MDQ4LDB4MDQ4LDB4MDQwLDB4MDQwLDB4MDEyLDB4MDEyLDB4MDEwLDB4MDEwLDB4MDA0LDB4MDA0LDB4MDEwLDB4MTcwLDB4MDkwLDB4MDA0LDB4MDVjLDB4MDI0KSwgLy8gNzJ4NzIKCQlhcnJheSgweDA1MCwweDA1MCwweDA0OCwweDA0OCwweDAxNCwweDAxNCwweDAxMiwweDAxMiwweDAwNCwweDAwNCwweDAxMCwweDFjOCwweDBjMCwweDAwNCwweDA3MiwweDAzMCksIC8vIDgweDgwCgkJYXJyYXkoMHgwNTgsMHgwNTgsMHgwNTAsMHgwNTAsMHgwMTYsMHgwMTYsMHgwMTQsMHgwMTQsMHgwMDQsMHgwMDQsMHgwMTAsMHgyNDAsMHgwZTAsMHgwMDQsMHgwOTAsMHgwMzgpLCAvLyA4OHg4OAoJCWFycmF5KDB4MDYwLDB4MDYwLDB4MDU4LDB4MDU4LDB4MDE4LDB4MDE4LDB4MDE2LDB4MDE2LDB4MDA0LDB4MDA0LDB4MDEwLDB4MmI4LDB4MTEwLDB4MDA0LDB4MGFlLDB4MDQ0KSwgLy8gOTZ4OTYKCQlhcnJheSgweDA2OCwweDA2OCwweDA2MCwweDA2MCwweDAxYSwweDAxYSwweDAxOCwweDAxOCwweDAwNCwweDAwNCwweDAxMCwweDMzMCwweDE1MCwweDAwNiwweDA4OCwweDAzOCksIC8vIDEwNHgxMDQKCQlhcnJheSgweDA3OCwweDA3OCwweDA2YywweDA2YywweDAxNCwweDAxNCwweDAxMiwweDAxMiwweDAwNiwweDAwNiwweDAyNCwweDQxYSwweDE5OCwweDAwNiwweDBhZiwweDA0NCksIC8vIDEyMHgxMjAKCQlhcnJheSgweDA4NCwweDA4NCwweDA3OCwweDA3OCwweDAxNiwweDAxNiwweDAxNCwweDAxNCwweDAwNiwweDAwNiwweDAyNCwweDUxOCwweDFmMCwweDAwOCwweDBhMywweDAzZSksIC8vIDEzMngxMzIKCQlhcnJheSgweDA5MCwweDA5MCwweDA4NCwweDA4NCwweDAxOCwweDAxOCwweDAxNiwweDAxNiwweDAwNiwweDAwNiwweDAyNCwweDYxNiwweDI2YywweDAwYSwweDA5YywweDAzZSksIC8vIDE0NHgxNDQKCQkvLyByZWN0YW5ndWxhciBmb3JtIChjdXJyZW50bHkgdW51c2VkKSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQlhcnJheSgweDAwOCwweDAxMiwweDAwNiwweDAxMCwweDAwOCwweDAxMiwweDAwNiwweDAxMCwweDAwMSwweDAwMSwweDAwMSwweDAwNSwweDAwNywweDAwMSwweDAwNSwweDAwNyksIC8vIDh4MTgKCQlhcnJheSgweDAwOCwweDAyMCwweDAwNiwweDAxYywweDAwOCwweDAxMCwweDAwNiwweDAwZSwweDAwMSwweDAwMiwweDAwMiwweDAwYSwweDAwYiwweDAwMSwweDAwYSwweDAwYiksIC8vIDh4MzIKCQlhcnJheSgweDAwYywweDAxYSwweDAwYSwweDAxOCwweDAwYywweDAxYSwweDAwYSwweDAxOCwweDAwMSwweDAwMSwweDAwMSwweDAxMCwweDAwZSwweDAwMSwweDAxMCwweDAwZSksIC8vIDEyeDI2CgkJYXJyYXkoMHgwMGMsMHgwMjQsMHgwMGEsMHgwMjAsMHgwMGMsMHgwMTIsMHgwMGEsMHgwMTAsMHgwMDEsMHgwMDIsMHgwMDIsMHgwMGMsMHgwMTIsMHgwMDEsMHgwMGMsMHgwMTIpLCAvLyAxMngzNgoJCWFycmF5KDB4MDEwLDB4MDI0LDB4MDBlLDB4MDIwLDB4MDEwLDB4MDEyLDB4MDBlLDB4MDEwLDB4MDAxLDB4MDAyLDB4MDAyLDB4MDIwLDB4MDE4LDB4MDAxLDB4MDIwLDB4MDE4KSwgLy8gMTZ4MzYKCQlhcnJheSgweDAxMCwweDAzMCwweDAwZSwweDAyYywweDAxMCwweDAxOCwweDAwZSwweDAxNiwweDAwMSwweDAwMiwweDAwMiwweDAzMSwweDAxYywweDAwMSwweDAzMSwweDAxYykgIC8vIDE2eDQ4CgkpOwoKCS8qKgoJICogTWFwIGVuY29kYXRpb24gbW9kZXMgd2hpdCBjaGFyYWN0ZXIgc2V0cy4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRjaHNldF9pZCA9IGFycmF5KEVOQ19DNDAgPT4gJ0M0MCcsIEVOQ19UWFQgPT4gJ1RYVCcsIEVOQ19YMTIgPT4nWDEyJyk7CgoJLyoqCgkgKiBCYXNpYyBzZXQgb2YgY2hhcmFjdGVycyBmb3IgZWFjaCBlbmNvZGF0aW9uIG1vZGUuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkY2hzZXQgPSBhcnJheSgKCQknQzQwJyA9PiBhcnJheSggLy8gQmFzaWMgc2V0IGZvciBDNDAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCQknUzEnPT4weDAwLCdTMic9PjB4MDEsJ1MzJz0+MHgwMiwweDIwPT4weDAzLDB4MzA9PjB4MDQsMHgzMT0+MHgwNSwweDMyPT4weDA2LDB4MzM9PjB4MDcsMHgzND0+MHgwOCwweDM1PT4weDA5LCAvLwoJCQkweDM2PT4weDBhLDB4Mzc9PjB4MGIsMHgzOD0+MHgwYywweDM5PT4weDBkLDB4NDE9PjB4MGUsMHg0Mj0+MHgwZiwweDQzPT4weDEwLDB4NDQ9PjB4MTEsMHg0NT0+MHgxMiwweDQ2PT4weDEzLCAvLwoJCQkweDQ3PT4weDE0LDB4NDg9PjB4MTUsMHg0OT0+MHgxNiwweDRhPT4weDE3LDB4NGI9PjB4MTgsMHg0Yz0+MHgxOSwweDRkPT4weDFhLDB4NGU9PjB4MWIsMHg0Zj0+MHgxYywweDUwPT4weDFkLCAvLwoJCQkweDUxPT4weDFlLDB4NTI9PjB4MWYsMHg1Mz0+MHgyMCwweDU0PT4weDIxLDB4NTU9PjB4MjIsMHg1Nj0+MHgyMywweDU3PT4weDI0LDB4NTg9PjB4MjUsMHg1OT0+MHgyNiwweDVhPT4weDI3KSwvLwoJCSdUWFQnID0+IGFycmF5KCAvLyBCYXNpYyBzZXQgZm9yIFRFWFQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJCSdTMSc9PjB4MDAsJ1MyJz0+MHgwMSwnUzMnPT4weDAyLDB4MjA9PjB4MDMsMHgzMD0+MHgwNCwweDMxPT4weDA1LDB4MzI9PjB4MDYsMHgzMz0+MHgwNywweDM0PT4weDA4LDB4MzU9PjB4MDksIC8vCgkJCTB4MzY9PjB4MGEsMHgzNz0+MHgwYiwweDM4PT4weDBjLDB4Mzk9PjB4MGQsMHg2MT0+MHgwZSwweDYyPT4weDBmLDB4NjM9PjB4MTAsMHg2ND0+MHgxMSwweDY1PT4weDEyLDB4NjY9PjB4MTMsIC8vCgkJCTB4Njc9PjB4MTQsMHg2OD0+MHgxNSwweDY5PT4weDE2LDB4NmE9PjB4MTcsMHg2Yj0+MHgxOCwweDZjPT4weDE5LDB4NmQ9PjB4MWEsMHg2ZT0+MHgxYiwweDZmPT4weDFjLDB4NzA9PjB4MWQsIC8vCgkJCTB4NzE9PjB4MWUsMHg3Mj0+MHgxZiwweDczPT4weDIwLDB4NzQ9PjB4MjEsMHg3NT0+MHgyMiwweDc2PT4weDIzLDB4Nzc9PjB4MjQsMHg3OD0+MHgyNSwweDc5PT4weDI2LDB4N2E9PjB4MjcpLC8vCgkJJ1NIMScgPT4gYXJyYXkoIC8vIFNoaWZ0IDEgc2V0IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkJMHgwMD0+MHgwMCwweDAxPT4weDAxLDB4MDI9PjB4MDIsMHgwMz0+MHgwMywweDA0PT4weDA0LDB4MDU9PjB4MDUsMHgwNj0+MHgwNiwweDA3PT4weDA3LDB4MDg9PjB4MDgsMHgwOT0+MHgwOSwgLy8KCQkJMHgwYT0+MHgwYSwweDBiPT4weDBiLDB4MGM9PjB4MGMsMHgwZD0+MHgwZCwweDBlPT4weDBlLDB4MGY9PjB4MGYsMHgxMD0+MHgxMCwweDExPT4weDExLDB4MTI9PjB4MTIsMHgxMz0+MHgxMywgLy8KCQkJMHgxND0+MHgxNCwweDE1PT4weDE1LDB4MTY9PjB4MTYsMHgxNz0+MHgxNywweDE4PT4weDE4LDB4MTk9PjB4MTksMHgxYT0+MHgxYSwweDFiPT4weDFiLDB4MWM9PjB4MWMsMHgxZD0+MHgxZCwgLy8KCQkJMHgxZT0+MHgxZSwweDFmPT4weDFmKSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8KCQknU0gyJyA9PiBhcnJheSggLy8gU2hpZnQgMiBzZXQgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCQkweDIxPT4weDAwLDB4MjI9PjB4MDEsMHgyMz0+MHgwMiwweDI0PT4weDAzLDB4MjU9PjB4MDQsMHgyNj0+MHgwNSwweDI3PT4weDA2LDB4Mjg9PjB4MDcsMHgyOT0+MHgwOCwweDJhPT4weDA5LCAvLwoJCQkweDJiPT4weDBhLDB4MmM9PjB4MGIsMHgyZD0+MHgwYywweDJlPT4weDBkLDB4MmY9PjB4MGUsMHgzYT0+MHgwZiwweDNiPT4weDEwLDB4M2M9PjB4MTEsMHgzZD0+MHgxMiwweDNlPT4weDEzLCAvLwoJCQkweDNmPT4weDE0LDB4NDA9PjB4MTUsMHg1Yj0+MHgxNiwweDVjPT4weDE3LDB4NWQ9PjB4MTgsMHg1ZT0+MHgxOSwweDVmPT4weDFhLCdGMSc9PjB4MWIsJ1VTJz0+MHgxZSksICAgICAgICAgICAvLwoJCSdTM0MnID0+IGFycmF5KCAvLyBTaGlmdCAzIHNldCBmb3IgQzQwIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgkJCTB4NjA9PjB4MDAsMHg2MT0+MHgwMSwweDYyPT4weDAyLDB4NjM9PjB4MDMsMHg2ND0+MHgwNCwweDY1PT4weDA1LDB4NjY9PjB4MDYsMHg2Nz0+MHgwNywweDY4PT4weDA4LDB4Njk9PjB4MDksIC8vCgkJCTB4NmE9PjB4MGEsMHg2Yj0+MHgwYiwweDZjPT4weDBjLDB4NmQ9PjB4MGQsMHg2ZT0+MHgwZSwweDZmPT4weDBmLDB4NzA9PjB4MTAsMHg3MT0+MHgxMSwweDcyPT4weDEyLDB4NzM9PjB4MTMsIC8vCgkJCTB4NzQ9PjB4MTQsMHg3NT0+MHgxNSwweDc2PT4weDE2LDB4Nzc9PjB4MTcsMHg3OD0+MHgxOCwweDc5PT4weDE5LDB4N2E9PjB4MWEsMHg3Yj0+MHgxYiwweDdjPT4weDFjLDB4N2Q9PjB4MWQsIC8vCgkJCTB4N2U9PjB4MWUsMHg3Zj0+MHgxZiksCgkJJ1MzVCcgPT4gYXJyYXkoIC8vIFNoaWZ0IDMgc2V0IGZvciBURVhUIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkJMHg2MD0+MHgwMCwweDQxPT4weDAxLDB4NDI9PjB4MDIsMHg0Mz0+MHgwMywweDQ0PT4weDA0LDB4NDU9PjB4MDUsMHg0Nj0+MHgwNiwweDQ3PT4weDA3LDB4NDg9PjB4MDgsMHg0OT0+MHgwOSwgLy8KCQkJMHg0YT0+MHgwYSwweDRiPT4weDBiLDB4NGM9PjB4MGMsMHg0ZD0+MHgwZCwweDRlPT4weDBlLDB4NGY9PjB4MGYsMHg1MD0+MHgxMCwweDUxPT4weDExLDB4NTI9PjB4MTIsMHg1Mz0+MHgxMywgLy8KCQkJMHg1ND0+MHgxNCwweDU1PT4weDE1LDB4NTY9PjB4MTYsMHg1Nz0+MHgxNywweDU4PT4weDE4LDB4NTk9PjB4MTksMHg1YT0+MHgxYSwweDdiPT4weDFiLDB4N2M9PjB4MWMsMHg3ZD0+MHgxZCwgLy8KCQkJMHg3ZT0+MHgxZSwweDdmPT4weDFmKSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8KCQknWDEyJyA9PiBhcnJheSggLy8gU2V0IGZvciBYMTIgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJCQkweDBkPT4weDAwLDB4MmE9PjB4MDEsMHgzZT0+MHgwMiwweDIwPT4weDAzLDB4MzA9PjB4MDQsMHgzMT0+MHgwNSwweDMyPT4weDA2LDB4MzM9PjB4MDcsMHgzND0+MHgwOCwweDM1PT4weDA5LCAvLwoJCQkweDM2PT4weDBhLDB4Mzc9PjB4MGIsMHgzOD0+MHgwYywweDM5PT4weDBkLDB4NDE9PjB4MGUsMHg0Mj0+MHgwZiwweDQzPT4weDEwLDB4NDQ9PjB4MTEsMHg0NT0+MHgxMiwweDQ2PT4weDEzLCAvLwoJCQkweDQ3PT4weDE0LDB4NDg9PjB4MTUsMHg0OT0+MHgxNiwweDRhPT4weDE3LDB4NGI9PjB4MTgsMHg0Yz0+MHgxOSwweDRkPT4weDFhLDB4NGU9PjB4MWIsMHg0Zj0+MHgxYywweDUwPT4weDFkLCAvLwoJCQkweDUxPT4weDFlLDB4NTI9PjB4MWYsMHg1Mz0+MHgyMCwweDU0PT4weDIxLDB4NTU9PjB4MjIsMHg1Nj0+MHgyMywweDU3PT4weDI0LDB4NTg9PjB4MjUsMHg1OT0+MHgyNiwweDVhPT4weDI3KSAvLwoJCSk7CgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCS8qKgoJICogVGhpcyBpcyB0aGUgY2xhc3MgY29uc3RydWN0b3IuCgkgKiBDcmVhdGVzIGEgZGF0YW1hdHJpeCBvYmplY3QKCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgQ29kZSB0byByZXByZXNlbnQgdXNpbmcgRGF0YW1hdHJpeC4KCSAqIEBwdWJsaWMKCSAqLwoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb2RlKSB7CgkJJGJhcmNvZGVfYXJyYXkgPSBhcnJheSgpOwoJCWlmICgoaXNfbnVsbCgkY29kZSkpIE9SICgkY29kZSA9PSAnXDAnKSBPUiAoJGNvZGUgPT0gJycpKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJLy8gZ2V0IGRhdGEgY29kZXdvcmRzCgkJJGN3ID0gJHRoaXMtPmdldEhpZ2hMZXZlbEVuY29kaW5nKCRjb2RlKTsKCQkvLyBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCQkkbmQgPSBjb3VudCgkY3cpOwoJCS8vIGNoZWNrIHNpemUKCQlpZiAoJG5kID4gMTU1OCkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCS8vIGdldCBtaW5pbXVtIHJlcXVpcmVkIG1hdHJpeCBzaXplLgoJCWZvcmVhY2ggKCR0aGlzLT5zeW1iYXR0ciBhcyAkcGFyYW1zKSB7CgkJCWlmICgkcGFyYW1zWzExXSA+PSAkbmQpIHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmICgkcGFyYW1zWzExXSA8ICRuZCkgewoJCQkvLyB0b28gbXVjaCBkYXRhCgkJCXJldHVybiBmYWxzZTsKCQl9IGVsc2VpZiAoJHBhcmFtc1sxMV0gPiAkbmQpIHsKCQkJLy8gYWRkIHBhZGRpbmcKCQkJaWYgKCgoJHBhcmFtc1sxMV0gLSAkbmQpID4gMSkgQU5EICgkY3dbKCRuZCAtIDEpXSAhPSAyNTQpKSB7CgkJCQlpZiAoJHRoaXMtPmxhc3RfZW5jID09IEVOQ19FREYpIHsKCQkJCQkvLyBzd2l0Y2ggdG8gQVNDSUkgZW5jb2RpbmcKCQkJCQkkY3dbXSA9IDEyNDsKCQkJCQkrKyRuZDsKCQkJCX0gZWxzZWlmICgoJHRoaXMtPmxhc3RfZW5jICE9IEVOQ19BU0NJSSkgQU5EICgkdGhpcy0+bGFzdF9lbmMgIT0gRU5DX0JBU0UyNTYpKSB7CgkJCQkJLy8gc3dpdGNoIHRvIEFTQ0lJIGVuY29kaW5nCgkJCQkJJGN3W10gPSAyNTQ7CgkJCQkJKyskbmQ7CgkJCQl9CgkJCX0KCQkJaWYgKCRwYXJhbXNbMTFdID4gJG5kKSB7CgkJCQkvLyBhZGQgZmlyc3QgcGFkCgkJCQkkY3dbXSA9IDEyOTsKCQkJCSsrJG5kOwoJCQkJLy8gYWRkIHJlbWFpbmluZyBwYWRzCgkJCQlmb3IgKCRpID0gJG5kOyAkaSA8ICRwYXJhbXNbMTFdOyArKyRpKSB7CgkJCQkJJGN3W10gPSAkdGhpcy0+Z2V0MjUzU3RhdGVDb2Rld29yZCgxMjksICRpKTsKCQkJCX0KCQkJfQoJCX0KCQkvLyBhZGQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCQkkY3cgPSAkdGhpcy0+Z2V0RXJyb3JDb3JyZWN0aW9uKCRjdywgJHBhcmFtc1sxM10sICRwYXJhbXNbMTRdLCAkcGFyYW1zWzE1XSk7CgkJLy8gaW5pdGlhbGl6ZSBlbXB0eSBhcnJheXMKCQkkZ3JpZCA9IGFycmF5X2ZpbGwoMCwgKCRwYXJhbXNbMl0gKiAkcGFyYW1zWzNdKSwgMCk7CgkJLy8gZ2V0IHBsYWNlbWVudCBtYXAKCQkkcGxhY2VzID0gJHRoaXMtPmdldFBsYWNlbWVudE1hcCgkcGFyYW1zWzJdLCAkcGFyYW1zWzNdKTsKCQkvLyBmaWxsIHRoZSBncmlkIHdpdGggZGF0YQoJCSRncmlkID0gYXJyYXkoKTsKCQkkaSA9IDA7CgkJLy8gcmVnaW9uIGRhdGEgcm93IG1heCBpbmRleAoJCSRyZHJpID0gKCRwYXJhbXNbNF0gLSAxKTsKCQkvLyByZWdpb24gZGF0YSBjb2x1bW4gbWF4IGluZGV4CgkJJHJkY2kgPSAoJHBhcmFtc1s1XSAtIDEpOwoJCS8vIGZvciBlYWNoIHZlcnRpY2FsIHJlZ2lvbgoJCWZvciAoJHZyID0gMDsgJHZyIDwgJHBhcmFtc1s5XTsgKyskdnIpIHsKCQkJLy8gZm9yIGVhY2ggcm93IG9uIHJlZ2lvbgoJCQlmb3IgKCRyID0gMDsgJHIgPCAkcGFyYW1zWzRdOyArKyRyKSB7CgkJCQkvLyBnZXQgcm93CgkJCQkkcm93ID0gKCgkdnIgKiAkcGFyYW1zWzRdKSArICRyKTsKCQkJCS8vIGZvciBlYWNoIGhvcml6b250YWwgcmVnaW9uCgkJCQlmb3IgKCRociA9IDA7ICRociA8ICRwYXJhbXNbOF07ICsrJGhyKSB7CgkJCQkJLy8gZm9yIGVhY2ggY29sdW1uIG9uIHJlZ2lvbgoJCQkJCWZvciAoJGMgPSAwOyAkYyA8ICRwYXJhbXNbNV07ICsrJGMpIHsKCQkJCQkJLy8gZ2V0IGNvbHVtbgoJCQkJCQkkY29sID0gKCgkaHIgKiAkcGFyYW1zWzVdKSArICRjKTsKCQkJCQkJLy8gYnJhdyBiaXRzIGJ5IGNhc2UKCQkJCQkJaWYgKCRyID09IDApIHsKCQkJCQkJCS8vIHRvcCBmaW5kZXIgcGF0dGVybgoJCQkJCQkJaWYgKCRjICUgMikgewoJCQkJCQkJCSRncmlkWyRyb3ddWyRjb2xdID0gMDsKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJJGdyaWRbJHJvd11bJGNvbF0gPSAxOwoJCQkJCQkJfQoJCQkJCQl9IGVsc2VpZiAoJHIgPT0gJHJkcmkpIHsKCQkJCQkJCS8vIGJvdHRvbSBmaW5kZXIgcGF0dGVybgoJCQkJCQkJJGdyaWRbJHJvd11bJGNvbF0gPSAxOwoJCQkJCQl9IGVsc2VpZiAoJGMgPT0gMCkgewoJCQkJCQkJLy8gbGVmdCBmaW5kZXIgcGF0dGVybgoJCQkJCQkJJGdyaWRbJHJvd11bJGNvbF0gPSAxOwoJCQkJCQl9IGVsc2VpZiAoJGMgPT0gJHJkY2kpIHsKCQkJCQkJCS8vIHJpZ2h0IGZpbmRlciBwYXR0ZXJuCgkJCQkJCQlpZiAoJHIgJSAyKSB7CgkJCQkJCQkJJGdyaWRbJHJvd11bJGNvbF0gPSAxOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkkZ3JpZFskcm93XVskY29sXSA9IDA7CgkJCQkJCQl9CgkJCQkJCX0gZWxzZSB7IC8vIGRhdGEgYml0CgkJCQkJCQlpZiAoJHBsYWNlc1skaV0gPCAyKSB7CgkJCQkJCQkJJGdyaWRbJHJvd11bJGNvbF0gPSAkcGxhY2VzWyRpXTsKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJLy8gY29kZXdvcmQgSUQKCQkJCQkJCQkkY3dfaWQgPSAoZmxvb3IoJHBsYWNlc1skaV0gLyAxMCkgLSAxKTsKCQkJCQkJCQkvLyBjb2Rld29yZCBCSVQgbWFzawoJCQkJCQkJCSRjd19iaXQgPSBwb3coMiwgKDggLSAoJHBsYWNlc1skaV0gJSAxMCkpKTsKCQkJCQkJCQkkZ3JpZFskcm93XVskY29sXSA9ICgoJGN3WyRjd19pZF0gJiAkY3dfYml0KSA9PSAwKSA/IDAgOiAxOwoJCQkJCQkJfQoJCQkJCQkJKyskaTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQkkdGhpcy0+YmFyY29kZV9hcnJheVsnbnVtX3Jvd3MnXSA9ICRwYXJhbXNbMF07CgkJJHRoaXMtPmJhcmNvZGVfYXJyYXlbJ251bV9jb2xzJ10gPSAkcGFyYW1zWzFdOwoJCSR0aGlzLT5iYXJjb2RlX2FycmF5WydiY29kZSddID0gJGdyaWQ7Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgYmFyY29kZSBhcnJheSB3aGljaCBpcyByZWFkYWJsZSBieSBUQ1BERgoJICogQHJldHVybiBhcnJheSBiYXJjb2RlIGFycmF5IHJlYWRhYmxlIGJ5IFRDUERGOwoJICogQHB1YmxpYwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0QmFyY29kZUFycmF5KCkgewoJCXJldHVybiAkdGhpcy0+YmFyY29kZV9hcnJheTsKCX0KCgkvKioKCSAqIFByb2R1Y3Qgb2YgdHdvIG51bWJlcnMgaW4gYSBQb3dlci1vZi1Ud28gR2Fsb2lzIEZpZWxkCgkgKiBAcGFyYW0gaW50ICRhIGZpcnN0IG51bWJlciB0byBtdWx0aXBseS4KCSAqIEBwYXJhbSBpbnQgJGIgc2Vjb25kIG51bWJlciB0byBtdWx0aXBseS4KCSAqIEBwYXJhbSBhcnJheSAkbG9nIExvZyB0YWJsZS4KCSAqIEBwYXJhbSBhcnJheSAkYWxvZyBBbnRpLUxvZyB0YWJsZS4KCSAqIEBwYXJhbSBpbnQgJGdmIE51bWJlciBvZiBGYWN0b3JzIG9mIHRoZSBSZWVkLVNvbG9tb24gcG9seW5vbWlhbC4KCSAqIEByZXR1cm4gaW50IHByb2R1Y3QKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEdGUHJvZHVjdCgkYSwgJGIsICRsb2csICRhbG9nLCAkZ2YpIHsKCQlpZiAoKCRhID09IDApIE9SICgkYiA9PSAwKSkgewoJCQlyZXR1cm4gMDsKCQl9CgkJcmV0dXJuICgkYWxvZ1soJGxvZ1skYV0gKyAkbG9nWyRiXSkgJSAoJGdmIC0gMSldKTsKCX0KCgkvKioKCSAqIEFkZCBlcnJvciBjb3JyZWN0aW9uIGNvZGV3b3JkcyB0byBkYXRhIGNvZGV3b3JkcyBhcnJheSAoQU5ORVggRSkuCgkgKiBAcGFyYW0gYXJyYXkgJHdkIEFycmF5IG9mIGRhdGFjb2Rld29yZHMuCgkgKiBAcGFyYW0gaW50ICRuYiBOdW1iZXIgb2YgYmxvY2tzLgoJICogQHBhcmFtIGludCAkbmQgTnVtYmVyIG9mIGRhdGEgY29kZXdvcmRzIHBlciBibG9jay4KCSAqIEBwYXJhbSBpbnQgJG5jIE51bWJlciBvZiBjb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2suCgkgKiBAcGFyYW0gaW50ICRnZiBudW1uZXIgb2YgZmllbGRzIG9uIGxvZy9hbnRpbG9nIHRhYmxlIChwb3dlciBvZiAyKS4KCSAqIEBwYXJhbSBpbnQgJHBwIFRoZSB2YWx1ZSBvZiBpdHMgcHJpbWUgbW9kdWx1cyBwb2x5bm9taWFsICgzMDEgZm9yIEVDQzIwMCkuCgkgKiBAcmV0dXJuIGFycmF5IGRhdGEgY29kZXdvcmRzICsgZXJyb3IgY29kZXdvcmRzCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRFcnJvckNvcnJlY3Rpb24oJHdkLCAkbmIsICRuZCwgJG5jLCAkZ2Y9MjU2LCAkcHA9MzAxKSB7CgkJLy8gZ2VuZXJhdGUgdGhlIGxvZyAoJGxvZykgYW5kIGFudGlsb2cgKCRhbG9nKSB0YWJsZXMKCQkkbG9nWzBdID0gMDsKCQkkYWxvZ1swXSA9IDE7CgkJZm9yICgkaSA9IDE7ICRpIDwgJGdmOyArKyRpKSB7CgkJCSRhbG9nWyRpXSA9ICgkYWxvZ1soJGkgLSAxKV0gKiAyKTsKCQkJaWYgKCRhbG9nWyRpXSA+PSAkZ2YpIHsKCQkJCSRhbG9nWyRpXSBePSAkcHA7CgkJCX0KCQkJJGxvZ1skYWxvZ1skaV1dID0gJGk7CgkJfQoJCWtzb3J0KCRsb2cpOwoJCS8vIGdlbmVyYXRlIHRoZSBwb2x5bm9taWFsIGNvZWZmaWNpZW50cyAoYykKCQkkYyA9IGFycmF5X2ZpbGwoMCwgKCRuYyArIDEpLCAwKTsKCQkkY1swXSA9IDE7CgkJZm9yICgkaSA9IDE7ICRpIDw9ICRuYzsgKyskaSkgewoJCQkkY1skaV0gPSAkY1soJGktMSldOwoJCQlmb3IgKCRqID0gKCRpIC0gMSk7ICRqID49IDE7IC0tJGopIHsKCQkJCSRjWyRqXSA9ICRjWygkaiAtIDEpXSBeICR0aGlzLT5nZXRHRlByb2R1Y3QoJGNbJGpdLCAkYWxvZ1skaV0sICRsb2csICRhbG9nLCAkZ2YpOwoJCQl9CgkJCSRjWzBdID0gJHRoaXMtPmdldEdGUHJvZHVjdCgkY1swXSwgJGFsb2dbJGldLCAkbG9nLCAkYWxvZywgJGdmKTsKCQl9CgkJa3NvcnQoJGMpOwoJCS8vIHRvdGFsIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcwoJCSRudW1fd2QgPSAoJG5iICogJG5kKTsKCQkvLyB0b3RhbCBudW1iZXIgb2YgZXJyb3IgY29kZXdvcmRzCgkJJG51bV93ZSA9ICgkbmIgKiAkbmMpOwoJCS8vIGZvciBlYWNoIGJsb2NrCgkJZm9yICgkYiA9IDA7ICRiIDwgJG5iOyArKyRiKSB7CgkJCS8vIGNyZWF0ZSBpbnRlcmxlYXZlZCBkYXRhIGJsb2NrCgkJCSRibG9jayA9IGFycmF5KCk7CgkJCWZvciAoJG4gPSAkYjsgJG4gPCAkbnVtX3dkOyAkbiArPSAkbmIpIHsKCQkJCSRibG9ja1tdID0gJHdkWyRuXTsKCQkJfQoJCQkvLyBpbml0aWFsaXplIGVycm9yIGNvZGV3b3JkcwoJCQkkd2UgPSBhcnJheV9maWxsKDAsICgkbmMgKyAxKSwgMCk7CgkJCS8vIGNhbGN1bGF0ZSBlcnJvciBjb3JyZWN0aW9uIGNvZGV3b3JkcyBmb3IgdGhpcyBibG9jawoJCQlmb3IgKCRpID0gMDsgJGkgPCAkbmQ7ICsrJGkpIHsKCQkJCSRrID0gKCR3ZVswXSBeICRibG9ja1skaV0pOwoJCQkJZm9yICgkaiA9IDA7ICRqIDwgJG5jOyArKyRqKSB7CgkJCQkJJHdlWyRqXSA9ICgkd2VbKCRqICsgMSldIF4gJHRoaXMtPmdldEdGUHJvZHVjdCgkaywgJGNbKCRuYyAtICRqIC0gMSldLCAkbG9nLCAkYWxvZywgJGdmKSk7CgkJCQl9CgkJCX0KCQkJLy8gYWRkIGVycm9yIGNvZGV3b3JkcyBhdCB0aGUgZW5kIG9mIGRhdGEgY29kZXdvcmRzCgkJCSRqID0gMDsKCQkJZm9yICgkaSA9ICRiOyAkaSA8ICRudW1fd2U7ICRpICs9ICRuYikgewoJCQkJJHdkWygkbnVtX3dkICsgJGkpXSA9ICR3ZVskal07CgkJCQkrKyRqOwoJCQl9CgkJfQoJCS8vIHJlb3JkZXIgY29kZXdvcmRzCgkJa3NvcnQoJHdkKTsKCQlyZXR1cm4gJHdkOwoJfQoKCS8qKgoJICogUmV0dXJuIHRoZSAyNTMtc3RhdGUgY29kZXdvcmQKCSAqIEBwYXJhbSBpbnQgJGN3cGFkIFBhZCBjb2Rld29yZC4KCSAqIEBwYXJhbSBpbnQgJGN3cG9zIE51bWJlciBvZiBkYXRhIGNvZGV3b3JkcyBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgZW5jb2RlZCBkYXRhLgoJICogQHJldHVybiBpbnQgcGFkIGNvZGV3b3JkCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXQyNTNTdGF0ZUNvZGV3b3JkKCRjd3BhZCwgJGN3cG9zKSB7CgkJJHBhZCA9ICgkY3dwYWQgKyAoKCgxNDkgKiAkY3dwb3MpICUgMjUzKSArIDEpKTsKCQlpZiAoJHBhZCA+IDI1NCkgewoJCQkkcGFkIC09IDI1NDsKCQl9CgkJcmV0dXJuICRwYWQ7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gdGhlIDI1NS1zdGF0ZSBjb2Rld29yZAoJICogQHBhcmFtIGludCAkY3dwYWQgUGFkIGNvZGV3b3JkLgoJICogQHBhcmFtIGludCAkY3dwb3MgTnVtYmVyIG9mIGRhdGEgY29kZXdvcmRzIGZyb20gdGhlIGJlZ2lubmluZyBvZiBlbmNvZGVkIGRhdGEuCgkgKiBAcmV0dXJuIGludCBwYWQgY29kZXdvcmQKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldDI1NVN0YXRlQ29kZXdvcmQoJGN3cGFkLCAkY3dwb3MpIHsKCQkkcGFkID0gKCRjd3BhZCArICgoKDE0OSAqICRjd3BvcykgJSAyNTUpICsgMSkpOwoJCWlmICgkcGFkID4gMjU1KSB7CgkJCSRwYWQgLT0gMjU2OwoJCX0KCQlyZXR1cm4gJHBhZDsKCX0KCgkvKioKCSAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY2hhciBiZWxvbmdzIHRvIHRoZSBzZWxlY3RlZCBtb2RlCgkgKiBAcGFyYW0gaW50ICRjaHIgQ2hhcmFjdGVyIChieXRlKSB0byBjaGVjay4KCSAqIEBwYXJhbSBpbnQgJG1vZGUgQ3VycmVudCBlbmNvZGluZyBtb2RlLgoJICogQHJldHVybiBib29sZWFuIHRydWUgaWYgdGhlIGNoYXIgaXMgb2YgdGhlIHNlbGVjdGVkIG1vZGUuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBpc0NoYXJNb2RlKCRjaHIsICRtb2RlKSB7CgkJJHN0YXR1cyA9IGZhbHNlOwoJCXN3aXRjaCAoJG1vZGUpIHsKCQkJY2FzZSBFTkNfQVNDSUk6IHsgLy8gQVNDSUkgY2hhcmFjdGVyIDAgdG8gMTI3CgkJCQkkc3RhdHVzID0gKCgkY2hyID49IDApIEFORCAoJGNociA8PSAxMjcpKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgRU5DX0M0MDogeyAvLyBVcHBlci1jYXNlIGFscGhhbnVtZXJpYwoJCQkJJHN0YXR1cyA9ICgoJGNociA9PSAzMikgT1IgKCgkY2hyID49IDQ4KSBBTkQgKCRjaHIgPD0gNTcpKSBPUiAoKCRjaHIgPj0gNjUpIEFORCAoJGNociA8PSA5MCkpKTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgRU5DX1RYVDogeyAvLyBMb3dlci1jYXNlIGFscGhhbnVtZXJpYwoJCQkJJHN0YXR1cyA9ICgoJGNociA9PSAzMikgT1IgKCgkY2hyID49IDQ4KSBBTkQgKCRjaHIgPD0gNTcpKSBPUiAoKCRjaHIgPj0gOTcpIEFORCAoJGNociA8PSAxMjIpKSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlIEVOQ19YMTI6IHsgLy8gQU5TSSBYMTIKCQkJCSRzdGF0dXMgPSAoKCRjaHIgPT0gMTMpIE9SICgkY2hyID09IDQyKSBPUiAoJGNociA9PSA2MikpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfRURGOiB7IC8vIEFTQ0lJIGNoYXJhY3RlciAzMiB0byA5NAoJCQkJJHN0YXR1cyA9ICgoJGNociA+PSAzMikgQU5EICgkY2hyIDw9IDk0KSk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlIEVOQ19CQVNFMjU2OiB7IC8vIEZ1bmN0aW9uIGNoYXJhY3RlciAoRk5DMSwgU3RydWN0dXJlZCBBcHBlbmQsIFJlYWRlciBQcm9ncmFtLCBvciBDb2RlIFBhZ2UpCgkJCQkkc3RhdHVzID0gKCgkY2hyID09IDIzMikgT1IgKCRjaHIgPT0gMjMzKSBPUiAoJGNociA9PSAyMzQpIE9SICgkY2hyID09IDI0MSkpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfQVNDSUlfRVhUOiB7IC8vIEFTQ0lJIGNoYXJhY3RlciAxMjggdG8gMjU1CgkJCQkkc3RhdHVzID0gKCgkY2hyID49IDEyOCkgQU5EICgkY2hyIDw9IDI1NSkpOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfQVNDSUlfTlVNOiB7IC8vIEFTQ0lJIGRpZ2l0cwoJCQkJJHN0YXR1cyA9ICgoJGNociA+PSA0OCkgQU5EICgkY2hyIDw9IDU3KSk7CgkJCQlicmVhazsKCQkJfQoJCX0KCQlyZXR1cm4gJHN0YXR1czsKCX0KCgkvKioKCSAqIFRoZSBsb29rLWFoZWFkIHRlc3Qgc2NhbnMgdGhlIGRhdGEgdG8gYmUgZW5jb2RlZCB0byBmaW5kIHRoZSBiZXN0IG1vZGUgKEFubmV4IFAgLSBzdGVwcyBmcm9tIEogdG8gUykuCgkgKiBAcGFyYW0gc3RyaW5nICRkYXRhIGRhdGEgdG8gZW5jb2RlCgkgKiBAcGFyYW0gaW50ICRwb3MgY3VycmVudCBwb3NpdGlvbgoJICogQHBhcmFtIGludCAkbW9kZSBjdXJyZW50IGVuY29kaW5nIG1vZGUKCSAqIEByZXR1cm4gaW50IGVuY29kaW5nIG1vZGUKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGxvb2tBaGVhZFRlc3QoJGRhdGEsICRwb3MsICRtb2RlKSB7CgkJJGRhdGFfbGVuZ3RoID0gc3RybGVuKCRkYXRhKTsKCQlpZiAoJHBvcyA+PSAkZGF0YV9sZW5ndGgpIHsKCQkJcmV0dXJuICRtb2RlOwoJCX0KCQkkY2hhcnNjb3VudCA9IDA7IC8vIGNvdW50IHByb2Nlc3NlZCBjaGFycwoJCS8vIFNURVAgSgoJCWlmICgkbW9kZSA9PSBFTkNfQVNDSUkpIHsKCQkJJG51bWNoID0gYXJyYXkoMCwgMSwgMSwgMSwgMSwgMS4yNSk7CgkJfSBlbHNlIHsKCQkJJG51bWNoID0gYXJyYXkoMSwgMiwgMiwgMiwgMiwgMi4yNSk7CgkJCSRudW1jaFskbW9kZV0gPSAwOwoJCX0KCQl3aGlsZSAodHJ1ZSkgewoJCQkvLyBTVEVQIEsKCQkJaWYgKCgkcG9zICsgJGNoYXJzY291bnQpID09ICRkYXRhX2xlbmd0aCkgewoJCQkJaWYgKCRudW1jaFtFTkNfQVNDSUldIDw9IGNlaWwobWluKCRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX1gxMl0sICRudW1jaFtFTkNfRURGXSwgJG51bWNoW0VOQ19CQVNFMjU2XSkpKSB7CgkJCQkJcmV0dXJuIEVOQ19BU0NJSTsKCQkJCX0KCQkJCWlmICgkbnVtY2hbRU5DX0JBU0UyNTZdIDwgY2VpbChtaW4oJG51bWNoW0VOQ19BU0NJSV0sICRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX1gxMl0sICRudW1jaFtFTkNfRURGXSkpKSB7CgkJCQkJcmV0dXJuIEVOQ19CQVNFMjU2OwoJCQkJfQoJCQkJaWYgKCRudW1jaFtFTkNfRURGXSA8IGNlaWwobWluKCRudW1jaFtFTkNfQVNDSUldLCAkbnVtY2hbRU5DX0M0MF0sICRudW1jaFtFTkNfVFhUXSwgJG51bWNoW0VOQ19YMTJdLCAkbnVtY2hbRU5DX0JBU0UyNTZdKSkpIHsKCQkJCQlyZXR1cm4gRU5DX0VERjsKCQkJCX0KCQkJCWlmICgkbnVtY2hbRU5DX1RYVF0gPCBjZWlsKG1pbigkbnVtY2hbRU5DX0FTQ0lJXSwgJG51bWNoW0VOQ19DNDBdLCAkbnVtY2hbRU5DX1gxMl0sICRudW1jaFtFTkNfRURGXSwgJG51bWNoW0VOQ19CQVNFMjU2XSkpKSB7CgkJCQkJcmV0dXJuIEVOQ19UWFQ7CgkJCQl9CgkJCQlpZiAoJG51bWNoW0VOQ19YMTJdIDwgY2VpbChtaW4oJG51bWNoW0VOQ19BU0NJSV0sICRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX0VERl0sICRudW1jaFtFTkNfQkFTRTI1Nl0pKSkgewoJCQkJCXJldHVybiBFTkNfWDEyOwoJCQkJfQoJCQkJcmV0dXJuIEVOQ19DNDA7CgkJCX0KCQkJLy8gZ2V0IGNoYXIKCQkJJGNociA9IG9yZCgkZGF0YVskcG9zICsgJGNoYXJzY291bnRdKTsKCQkJJGNoYXJzY291bnQrKzsKCQkJLy8gU1RFUCBMCgkJCWlmICgkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfQVNDSUlfTlVNKSkgewoJCQkJJG51bWNoW0VOQ19BU0NJSV0gKz0gKDEgLyAyKTsKCQkJfSBlbHNlaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19BU0NJSV9FWFQpKSB7CgkJCQkkbnVtY2hbRU5DX0FTQ0lJXSA9IGNlaWwoJG51bWNoW0VOQ19BU0NJSV0pOwoJCQkJJG51bWNoW0VOQ19BU0NJSV0gKz0gMjsKCQkJfSBlbHNlIHsKCQkJCSRudW1jaFtFTkNfQVNDSUldID0gY2VpbCgkbnVtY2hbRU5DX0FTQ0lJXSk7CgkJCQkkbnVtY2hbRU5DX0FTQ0lJXSArPSAxOwoJCQl9CgkJCS8vIFNURVAgTQoJCQlpZiAoJHRoaXMtPmlzQ2hhck1vZGUoJGNociwgRU5DX0M0MCkpIHsKCQkJCSRudW1jaFtFTkNfQzQwXSArPSAoMiAvIDMpOwoJCQl9IGVsc2VpZiAoJHRoaXMtPmlzQ2hhck1vZGUoJGNociwgRU5DX0FTQ0lJX0VYVCkpIHsKCQkJCSRudW1jaFtFTkNfQzQwXSArPSAoOCAvIDMpOwoJCQl9IGVsc2UgewoJCQkJJG51bWNoW0VOQ19DNDBdICs9ICg0IC8gMyk7CgkJCX0KCQkJLy8gU1RFUCBOCgkJCWlmICgkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfVFhUKSkgewoJCQkJJG51bWNoW0VOQ19UWFRdICs9ICgyIC8gMyk7CgkJCX0gZWxzZWlmICgkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfQVNDSUlfRVhUKSkgewoJCQkJJG51bWNoW0VOQ19UWFRdICs9ICg4IC8gMyk7CgkJCX0gZWxzZSB7CgkJCQkkbnVtY2hbRU5DX1RYVF0gKz0gKDQgLyAzKTsKCQkJfQoJCQkvLyBTVEVQIE8KCQkJaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19YMTIpIE9SICR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19DNDApKSB7CgkJCQkkbnVtY2hbRU5DX1gxMl0gKz0gKDIgLyAzKTsKCQkJfSBlbHNlaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19BU0NJSV9FWFQpKSB7CgkJCQkkbnVtY2hbRU5DX1gxMl0gKz0gKDEzIC8gMyk7CgkJCX0gZWxzZSB7CgkJCQkkbnVtY2hbRU5DX1gxMl0gKz0gKDEwIC8gMyk7CgkJCX0KCQkJLy8gU1RFUCBQCgkJCWlmICgkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfRURGKSkgewoJCQkJJG51bWNoW0VOQ19FREZdICs9ICgzIC8gNCk7CgkJCX0gZWxzZWlmICgkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfQVNDSUlfRVhUKSkgewoJCQkJJG51bWNoW0VOQ19FREZdICs9ICgxNyAvIDQpOwoJCQl9IGVsc2UgewoJCQkJJG51bWNoW0VOQ19FREZdICs9ICgxMyAvIDQpOwoJCQl9CgkJCS8vIFNURVAgUQoJCQlpZiAoJHRoaXMtPmlzQ2hhck1vZGUoJGNociwgRU5DX0JBU0UyNTYpKSB7CgkJCQkkbnVtY2hbRU5DX0JBU0UyNTZdICs9IDQ7CgkJCX0gZWxzZSB7CgkJCQkkbnVtY2hbRU5DX0JBU0UyNTZdICs9IDE7CgkJCX0KCQkJLy8gU1RFUCBSCgkJCWlmICgkY2hhcnNjb3VudCA+PSA0KSB7CgkJCQlpZiAoKCRudW1jaFtFTkNfQVNDSUldICsgMSkgPD0gbWluKCRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX1gxMl0sICRudW1jaFtFTkNfRURGXSwgJG51bWNoW0VOQ19CQVNFMjU2XSkpIHsKCQkJCQlyZXR1cm4gRU5DX0FTQ0lJOwoJCQkJfQoJCQkJaWYgKCgoJG51bWNoW0VOQ19CQVNFMjU2XSArIDEpIDw9ICRudW1jaFtFTkNfQVNDSUldKQoJCQkJCU9SICgoJG51bWNoW0VOQ19CQVNFMjU2XSArIDEpIDwgbWluKCRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX1gxMl0sICRudW1jaFtFTkNfRURGXSkpKSB7CgkJCQkJcmV0dXJuIEVOQ19CQVNFMjU2OwoJCQkJfQoJCQkJaWYgKCgkbnVtY2hbRU5DX0VERl0gKyAxKSA8IG1pbigkbnVtY2hbRU5DX0FTQ0lJXSwgJG51bWNoW0VOQ19DNDBdLCAkbnVtY2hbRU5DX1RYVF0sICRudW1jaFtFTkNfWDEyXSwgJG51bWNoW0VOQ19CQVNFMjU2XSkpIHsKCQkJCQlyZXR1cm4gRU5DX0VERjsKCQkJCX0KCQkJCWlmICgoJG51bWNoW0VOQ19UWFRdICsgMSkgPCBtaW4oJG51bWNoW0VOQ19BU0NJSV0sICRudW1jaFtFTkNfQzQwXSwgJG51bWNoW0VOQ19YMTJdLCAkbnVtY2hbRU5DX0VERl0sICRudW1jaFtFTkNfQkFTRTI1Nl0pKSB7CgkJCQkJcmV0dXJuIEVOQ19UWFQ7CgkJCQl9CgkJCQlpZiAoKCRudW1jaFtFTkNfWDEyXSArIDEpIDwgbWluKCRudW1jaFtFTkNfQVNDSUldLCAkbnVtY2hbRU5DX0M0MF0sICRudW1jaFtFTkNfVFhUXSwgJG51bWNoW0VOQ19FREZdLCAkbnVtY2hbRU5DX0JBU0UyNTZdKSkgewoJCQkJCXJldHVybiBFTkNfWDEyOwoJCQkJfQoJCQkJaWYgKCgkbnVtY2hbRU5DX0M0MF0gKyAxKSA8IG1pbigkbnVtY2hbRU5DX0FTQ0lJXSwgJG51bWNoW0VOQ19UWFRdLCAkbnVtY2hbRU5DX0VERl0sICRudW1jaFtFTkNfQkFTRTI1Nl0pKSB7CgkJCQkJaWYgKCRudW1jaFtFTkNfQzQwXSA8ICRudW1jaFtFTkNfWDEyXSkgewoJCQkJCQlyZXR1cm4gRU5DX0M0MDsKCQkJCQl9CgkJCQkJaWYgKCRudW1jaFtFTkNfQzQwXSA9PSAkbnVtY2hbRU5DX1gxMl0pIHsKCQkJCQkJJGsgPSAoJHBvcyArICRjaGFyc2NvdW50ICsgMSk7CgkJCQkJCXdoaWxlICgkayA8ICRkYXRhX2xlbmd0aCkgewoJCQkJCQkJJHRtcGNociA9IG9yZCgkZGF0YVska10pOwoJCQkJCQkJaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCR0bXBjaHIsIEVOQ19YMTIpKSB7CgkJCQkJCQkJcmV0dXJuIEVOQ19YMTI7CgkJCQkJCQl9IGVsc2VpZiAoISgkdGhpcy0+aXNDaGFyTW9kZSgkdG1wY2hyLCBFTkNfWDEyKSBPUiAkdGhpcy0+aXNDaGFyTW9kZSgkdG1wY2hyLCBFTkNfQzQwKSkpIHsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJCSsrJGs7CgkJCQkJCX0KCQkJCQkJcmV0dXJuIEVOQ19DNDA7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfSAvLyBlbmQgb2Ygd2hpbGUKCX0KCgkvKioKCSAqIEdldCB0aGUgc3dpdGNoaW5nIGNvZGV3b3JkIHRvIGEgbmV3IGVuY29kaW5nIG1vZGUgKGxhdGNoIGNvZGV3b3JkKQoJICogQHBhcmFtIGludCAkbW9kZSBOZXcgZW5jb2RpbmcgbW9kZS4KCSAqIEByZXR1cm4gaW50IFN3aXRjaCBjb2Rld29yZC4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFN3aXRjaEVuY29kaW5nQ29kZXdvcmQoJG1vZGUpIHsKCQlzd2l0Y2ggKCRtb2RlKSB7CgkJCWNhc2UgRU5DX0FTQ0lJOiB7IC8vIEFTQ0lJIGNoYXJhY3RlciAwIHRvIDEyNwoJCQkJJGN3ID0gMjU0OwoJCQkJaWYgKCR0aGlzLT5sYXN0X2VuYyA9PSBFTkNfRURGKSB7CgkJCQkJJGN3ID0gMTI0OwoJCQkJfQoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfQzQwOiB7IC8vIFVwcGVyLWNhc2UgYWxwaGFudW1lcmljCgkJCQkkY3cgPSAyMzA7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlIEVOQ19UWFQ6IHsgLy8gTG93ZXItY2FzZSBhbHBoYW51bWVyaWMKCQkJCSRjdyA9IDIzOTsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgRU5DX1gxMjogeyAvLyBBTlNJIFgxMgoJCQkJJGN3ID0gMjM4OwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfRURGOiB7IC8vIEFTQ0lJIGNoYXJhY3RlciAzMiB0byA5NAoJCQkJJGN3ID0gMjQwOwoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBFTkNfQkFTRTI1NjogeyAvLyBGdW5jdGlvbiBjaGFyYWN0ZXIgKEZOQzEsIFN0cnVjdHVyZWQgQXBwZW5kLCBSZWFkZXIgUHJvZ3JhbSwgb3IgQ29kZSBQYWdlKQoJCQkJJGN3ID0gMjMxOwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJcmV0dXJuICRjdzsKCX0KCgkvKioKCSAqIENob29zZSB0aGUgbWluaW11bSBtYXRyaXggc2l6ZSBhbmQgcmV0dXJuIHRoZSBtYXggbnVtYmVyIG9mIGRhdGEgY29kZXdvcmRzLgoJICogQHBhcmFtIGludCAkbnVtY3cgTnVtYmVyIG9mIGN1cnJlbnQgY29kZXdvcmRzLgoJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGRhdGEgY29kZXdvcmRzIGluIG1hdHJpeAoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0TWF4RGF0YUNvZGV3b3JkcygkbnVtY3cpIHsKCQlmb3JlYWNoICgkdGhpcy0+c3ltYmF0dHIgYXMgJGtleSA9PiAkbWF0cml4KSB7CgkJCWlmICgkbWF0cml4WzExXSA+PSAkbnVtY3cpIHsKCQkJCXJldHVybiAkbWF0cml4WzExXTsKCQkJfQoJCX0KCQlyZXR1cm4gMDsKCX0KCgkvKioKCSAqIEdldCBoaWdoIGxldmVsIGVuY29kaW5nIHVzaW5nIHRoZSBtaW5pbXVtIHN5bWJvbCBkYXRhIGNoYXJhY3RlcnMgZm9yIEVDQyAyMDAKCSAqIEBwYXJhbSBzdHJpbmcgJGRhdGEgZGF0YSB0byBlbmNvZGUKCSAqIEByZXR1cm4gYXJyYXkgb2YgY29kZXdvcmRzCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRIaWdoTGV2ZWxFbmNvZGluZygkZGF0YSkgewoJCS8vIFNURVAgQS4gU3RhcnQgaW4gQVNDSUkgZW5jb2RhdGlvbi4KCQkkZW5jID0gRU5DX0FTQ0lJOyAvLyBjdXJyZW50IGVuY29kaW5nIG1vZGUKCQkkcG9zID0gMDsgLy8gY3VycmVudCBwb3NpdGlvbgoJCSRjdyA9IGFycmF5KCk7IC8vIGFycmF5IG9mIGNvZGV3b3JkcyB0byBiZSByZXR1cm5lZAoJCSRjd19udW0gPSAwOyAvLyBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCQkkZGF0YV9sZW5ndGggPSBzdHJsZW4oJGRhdGEpOyAvLyBudW1iZXIgb2YgY2hhcnMKCQl3aGlsZSAoJHBvcyA8ICRkYXRhX2xlbmd0aCkgewoJCQkvLyBzZXQgbGFzdCB1c2VkIGVuY29kaW5nCgkJCSR0aGlzLT5sYXN0X2VuYyA9ICRlbmM7CgkJCXN3aXRjaCAoJGVuYykgewoJCQkJY2FzZSBFTkNfQVNDSUk6IHsgLy8gU1RFUCBCLiBXaGlsZSBpbiBBU0NJSSBlbmNvZGF0aW9uCgkJCQkJaWYgKCgkZGF0YV9sZW5ndGggPiAxKSBBTkQgKCRwb3MgPCAoJGRhdGFfbGVuZ3RoIC0gMSkpIEFORCAoJHRoaXMtPmlzQ2hhck1vZGUob3JkKCRkYXRhWyRwb3NdKSwgRU5DX0FTQ0lJX05VTSkgQU5EICR0aGlzLT5pc0NoYXJNb2RlKG9yZCgkZGF0YVskcG9zICsgMV0pLCBFTkNfQVNDSUlfTlVNKSkpIHsKCQkJCQkJLy8gMS4gSWYgdGhlIG5leHQgZGF0YSBzZXF1ZW5jZSBpcyBhdCBsZWFzdCAyIGNvbnNlY3V0aXZlIGRpZ2l0cywgZW5jb2RlIHRoZSBuZXh0IHR3byBkaWdpdHMgYXMgYSBkb3VibGUgZGlnaXQgaW4gQVNDSUkgbW9kZS4KCQkJCQkJJGN3W10gPSAoaW50dmFsKHN1YnN0cigkZGF0YSwgJHBvcywgMikpICsgMTMwKTsKCQkJCQkJKyskY3dfbnVtOwoJCQkJCQkkcG9zICs9IDI7CgkJCQkJfSBlbHNlIHsKCQkJCQkJLy8gMi4gSWYgdGhlIGxvb2stYWhlYWQgdGVzdCAoc3RhcnRpbmcgYXQgc3RlcCBKKSBpbmRpY2F0ZXMgYW5vdGhlciBtb2RlLCBzd2l0Y2ggdG8gdGhhdCBtb2RlLgoJCQkJCQkkbmV3ZW5jID0gJHRoaXMtPmxvb2tBaGVhZFRlc3QoJGRhdGEsICRwb3MsICRlbmMpOwoJCQkJCQlpZiAoJG5ld2VuYyAhPSAkZW5jKSB7CgkJCQkJCQkvLyBzd2l0Y2ggdG8gbmV3IGVuY29kaW5nCgkJCQkJCQkkZW5jID0gJG5ld2VuYzsKCQkJCQkJCSRjd1tdID0gJHRoaXMtPmdldFN3aXRjaEVuY29kaW5nQ29kZXdvcmQoJGVuYyk7CgkJCQkJCQkrKyRjd19udW07CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkvLyBnZXQgbmV3IGJ5dGUKCQkJCQkJCSRjaHIgPSBvcmQoJGRhdGFbJHBvc10pOwoJCQkJCQkJKyskcG9zOwoJCQkJCQkJaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19BU0NJSV9FWFQpKSB7CgkJCQkJCQkJLy8gMy4gSWYgdGhlIG5leHQgZGF0YSBjaGFyYWN0ZXIgaXMgZXh0ZW5kZWQgQVNDSUkgKGdyZWF0ZXIgdGhhbiAxMjcpIGVuY29kZSBpdCBpbiBBU0NJSSBtb2RlIGZpcnN0IHVzaW5nIHRoZSBVcHBlciBTaGlmdCAodmFsdWUgMjM1KSBjaGFyYWN0ZXIuCgkJCQkJCQkJJGN3W10gPSAyMzU7CgkJCQkJCQkJJGN3W10gPSAoJGNociAtIDEyNyk7CgkJCQkJCQkJJGN3X251bSArPSAyOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvLyA0LiBPdGhlcndpc2UgcHJvY2VzcyB0aGUgbmV4dCBkYXRhIGNoYXJhY3RlciBpbiBBU0NJSSBlbmNvZGF0aW9uLgoJCQkJCQkJCSRjd1tdID0gKCRjaHIgKyAxKTsKCQkJCQkJCQkrKyRjd19udW07CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIEVOQ19DNDAgOiAgIC8vIFVwcGVyLWNhc2UgYWxwaGFudW1lcmljCgkJCQljYXNlIEVOQ19UWFQgOiAgIC8vIExvd2VyLWNhc2UgYWxwaGFudW1lcmljCgkJCQljYXNlIEVOQ19YMTIgOiB7IC8vIEFOU0kgWDEyCgkJCQkJJHRlbXBfY3cgPSBhcnJheSgpOwoJCQkJCSRwID0gMDsKCQkJCQkkZXBvcyA9ICRwb3M7CgkJCQkJLy8gZ2V0IGNoYXJzZXQgSUQKCQkJCQkkc2V0X2lkID0gJHRoaXMtPmNoc2V0X2lkWyRlbmNdOwoJCQkJCS8vIGdldCBiYXNpYyBjaGFyc2V0IGZvciBjdXJyZW50IGVuY29kaW5nCgkJCQkJJGNoYXJzZXQgPSAkdGhpcy0+Y2hzZXRbJHNldF9pZF07CgkJCQkJZG8gewoJCQkJCQkvLyAyLiBwcm9jZXNzIHRoZSBuZXh0IGNoYXJhY3RlciBpbiBDNDAgZW5jb2RhdGlvbi4KCQkJCQkJJGNociA9IG9yZCgkZGF0YVskZXBvc10pOwoJCQkJCQkrKyRlcG9zOwoJCQkJCQkvLyBjaGVjayBmb3IgZXh0ZW5kZWQgY2hhcmFjdGVyCgkJCQkJCWlmICgkY2hyICYgMHg4MCkgewoJCQkJCQkJaWYgKCRlbmMgPT0gRU5DX1gxMikgewoJCQkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQkJCX0KCQkJCQkJCSRjaHIgPSAoJGNociAmIDB4N2YpOwoJCQkJCQkJJHRlbXBfY3dbXSA9IDE7IC8vIHNoaWZ0IDIKCQkJCQkJCSR0ZW1wX2N3W10gPSAzMDsgLy8gdXBwZXIgc2hpZnQKCQkJCQkJCSRwICs9IDI7CgkJCQkJCX0KCQkJCQkJaWYgKGlzc2V0KCRjaGFyc2V0WyRjaHJdKSkgewoJCQkJCQkJJHRlbXBfY3dbXSA9ICRjaGFyc2V0WyRjaHJdOwoJCQkJCQkJKyskcDsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCWlmIChpc3NldCgkdGhpcy0+Y2hzZXRbJ1NIMSddWyRjaHJdKSkgewoJCQkJCQkJCSR0ZW1wX2N3W10gPSAwOyAvLyBzaGlmdCAxCgkJCQkJCQkJJHNoaWZ0c2V0ID0gJHRoaXMtPmNoc2V0WydTSDEnXTsKCQkJCQkJCX0gZWxzZWlmIChpc3NldCgkdGhpcy0+Y2hzZXRbJ1NIMiddWyRjaHJdKSkgewoJCQkJCQkJCSR0ZW1wX2N3W10gPSAxOyAvLyBzaGlmdCAyCgkJCQkJCQkJJHNoaWZ0c2V0ID0gJHRoaXMtPmNoc2V0WydTSDInXTsKCQkJCQkJCX0gZWxzZWlmICgoJGVuYyA9PSBFTkNfQzQwKSBBTkQgaXNzZXQoJHRoaXMtPmNoc2V0WydTM0MnXVskY2hyXSkpIHsKCQkJCQkJCQkkdGVtcF9jd1tdID0gMjsgLy8gc2hpZnQgMwoJCQkJCQkJCSRzaGlmdHNldCA9ICR0aGlzLT5jaHNldFsnUzNDJ107CgkJCQkJCQl9IGVsc2VpZiAoKCRlbmMgPT0gRU5DX1RYVCkgQU5EIGlzc2V0KCR0aGlzLT5jaHNldFsnUzNUJ11bJGNocl0pKSB7CgkJCQkJCQkJJHRlbXBfY3dbXSA9IDI7IC8vIHNoaWZ0IDMKCQkJCQkJCQkkc2hpZnRzZXQgPSAkdGhpcy0+Y2hzZXRbJ1MzVCddOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCQl9CgkJCQkJCQkkdGVtcF9jd1tdID0gJHNoaWZ0c2V0WyRjaHJdOwoJCQkJCQkJJHAgKz0gMjsKCQkJCQkJfQoJCQkJCQlpZiAoJHAgPj0gMykgewoJCQkJCQkJJGMxID0gYXJyYXlfc2hpZnQoJHRlbXBfY3cpOwoJCQkJCQkJJGMyID0gYXJyYXlfc2hpZnQoJHRlbXBfY3cpOwoJCQkJCQkJJGMzID0gYXJyYXlfc2hpZnQoJHRlbXBfY3cpOwoJCQkJCQkJJHAgLT0gMzsKCQkJCQkJCSR0bXAgPSAoKDE2MDAgKiAkYzEpICsgKDQwICogJGMyKSArICRjMyArIDEpOwoJCQkJCQkJJGN3W10gPSAoJHRtcCA+PiA4KTsKCQkJCQkJCSRjd1tdID0gKCR0bXAgJSAyNTYpOwoJCQkJCQkJJGN3X251bSArPSAyOwoJCQkJCQkJJHBvcyA9ICRlcG9zOwoJCQkJCQkJLy8gMS4gSWYgdGhlIEM0MCBlbmNvZGluZyBpcyBhdCB0aGUgcG9pbnQgb2Ygc3RhcnRpbmcgYSBuZXcgZG91YmxlIHN5bWJvbCBjaGFyYWN0ZXIgYW5kIGlmIHRoZSBsb29rLWFoZWFkIHRlc3QgKHN0YXJ0aW5nIGF0IHN0ZXAgSikgaW5kaWNhdGVzIGFub3RoZXIgbW9kZSwgc3dpdGNoIHRvIHRoYXQgbW9kZS4KCQkJCQkJCSRuZXdlbmMgPSAkdGhpcy0+bG9va0FoZWFkVGVzdCgkZGF0YSwgJHBvcywgJGVuYyk7CgkJCQkJCQlpZiAoJG5ld2VuYyAhPSAkZW5jKSB7CgkJCQkJCQkJLy8gc3dpdGNoIHRvIG5ldyBlbmNvZGluZwoJCQkJCQkJCSRlbmMgPSAkbmV3ZW5jOwoJCQkJCQkJCWlmICgkZW5jICE9IEVOQ19BU0NJSSkgewoJCQkJCQkJCQkvLyBzZXQgdW5sYXRjaCBjaGFyYWN0ZXIKCQkJCQkJCQkJJGN3W10gPSAkdGhpcy0+Z2V0U3dpdGNoRW5jb2RpbmdDb2Rld29yZChFTkNfQVNDSUkpOwoJCQkJCQkJCQkrKyRjd19udW07CgkJCQkJCQkJfQoJCQkJCQkJCSRjd1tdID0gJHRoaXMtPmdldFN3aXRjaEVuY29kaW5nQ29kZXdvcmQoJGVuYyk7CgkJCQkJCQkJKyskY3dfbnVtOwoJCQkJCQkJCSRwb3MgLT0gJHA7CgkJCQkJCQkJJHAgPSAwOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSB3aGlsZSAoKCRwID4gMCkgQU5EICgkZXBvcyA8ICRkYXRhX2xlbmd0aCkpOwoJCQkJCS8vIHByb2Nlc3MgbGFzdCBkYXRhIChpZiBhbnkpCgkJCQkJaWYgKCRwID4gMCkgewoJCQkJCQkvLyBnZXQgcmVtYWluaW5nIG51bWJlciBvZiBkYXRhIHN5bWJvbHMKCQkJCQkJJGN3ciA9ICgkdGhpcy0+Z2V0TWF4RGF0YUNvZGV3b3JkcygkY3dfbnVtKSAtICRjd19udW0pOwoJCQkJCQlpZiAoKCRjd3IgPT0gMSkgQU5EICgkcCA9PSAxKSkgewoJCQkJCQkJLy8gZC4gSWYgb25lIHN5bWJvbCBjaGFyYWN0ZXIgcmVtYWlucyBhbmQgb25lIEM0MCB2YWx1ZSAoZGF0YSBjaGFyYWN0ZXIpIHJlbWFpbnMgdG8gYmUgZW5jb2RlZAoJCQkJCQkJJGMxID0gYXJyYXlfc2hpZnQoJHRlbXBfY3cpOwoJCQkJCQkJLS0kcDsKCQkJCQkJCSRjd1tdID0gKCRjaHIgKyAxKTsKCQkJCQkJCSsrJGN3X251bTsKCQkJCQkJCSRwb3MgPSAkZXBvczsKCQkJCQkJCSRlbmMgPSBFTkNfQVNDSUk7CgkJCQkJCQkkdGhpcy0+bGFzdF9lbmMgPSAkZW5jOwoJCQkJCQl9IGVsc2VpZiAoKCRjd3IgPT0gMikgQU5EICgkcCA9PSAxKSkgewoJCQkJCQkJLy8gYy4gSWYgdHdvIHN5bWJvbCBjaGFyYWN0ZXJzIHJlbWFpbiBhbmQgb25seSBvbmUgQzQwIHZhbHVlIChkYXRhIGNoYXJhY3RlcikgcmVtYWlucyB0byBiZSBlbmNvZGVkCgkJCQkJCQkkYzEgPSBhcnJheV9zaGlmdCgkdGVtcF9jdyk7CgkJCQkJCQktLSRwOwoJCQkJCQkJJGN3W10gPSAyNTQ7CgkJCQkJCQkkY3dbXSA9ICgkY2hyICsgMSk7CgkJCQkJCQkkY3dfbnVtICs9IDI7CgkJCQkJCQkkcG9zID0gJGVwb3M7CgkJCQkJCQkkZW5jID0gRU5DX0FTQ0lJOwoJCQkJCQkJJHRoaXMtPmxhc3RfZW5jID0gJGVuYzsKCQkJCQkJfSBlbHNlaWYgKCgkY3dyID09IDIpIEFORCAoJHAgPT0gMikpIHsKCQkJCQkJCS8vIGIuIElmIHR3byBzeW1ib2wgY2hhcmFjdGVycyByZW1haW4gYW5kIHR3byBDNDAgdmFsdWVzIHJlbWFpbiB0byBiZSBlbmNvZGVkCgkJCQkJCQkkYzEgPSBhcnJheV9zaGlmdCgkdGVtcF9jdyk7CgkJCQkJCQkkYzIgPSBhcnJheV9zaGlmdCgkdGVtcF9jdyk7CgkJCQkJCQkkcCAtPSAyOwoJCQkJCQkJJHRtcCA9ICgoMTYwMCAqICRjMSkgKyAoNDAgKiAkYzIpICsgMSk7CgkJCQkJCQkkY3dbXSA9ICgkdG1wID4+IDgpOwoJCQkJCQkJJGN3W10gPSAoJHRtcCAlIDI1Nik7CgkJCQkJCQkkY3dfbnVtICs9IDI7CgkJCQkJCQkkcG9zID0gJGVwb3M7CgkJCQkJCQkkZW5jID0gRU5DX0FTQ0lJOwoJCQkJCQkJJHRoaXMtPmxhc3RfZW5jID0gJGVuYzsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCS8vIHN3aXRjaCB0byBBU0NJSSBlbmNvZGluZwoJCQkJCQkJaWYgKCRlbmMgIT0gRU5DX0FTQ0lJKSB7CgkJCQkJCQkJJGVuYyA9IEVOQ19BU0NJSTsKCQkJCQkJCQkkdGhpcy0+bGFzdF9lbmMgPSAkZW5jOwoJCQkJCQkJCSRjd1tdID0gJHRoaXMtPmdldFN3aXRjaEVuY29kaW5nQ29kZXdvcmQoJGVuYyk7CgkJCQkJCQkJKyskY3dfbnVtOwoJCQkJCQkJCSRwb3MgPSAoJGVwb3MgLSAkcCk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIEVOQ19FREY6IHsgLy8gRi4gV2hpbGUgaW4gRURJRkFDVCAoRURGKSBlbmNvZGF0aW9uCgkJCQkJLy8gaW5pdGlhbGl6ZSB0ZW1wb3JhcnkgYXJyYXkgd2l0aCAwIGxlbmd0aAoJCQkJCSR0ZW1wX2N3ID0gYXJyYXkoKTsKCQkJCQkkZXBvcyA9ICRwb3M7CgkJCQkJJGZpZWxkX2xlbmd0aCA9IDA7CgkJCQkJJG5ld2VuYyA9ICRlbmM7CgkJCQkJZG8gewoJCQkJCQkvLyAyLiBwcm9jZXNzIHRoZSBuZXh0IGNoYXJhY3RlciBpbiBFRElGQUNUIGVuY29kYXRpb24uCgkJCQkJCSRjaHIgPSBvcmQoJGRhdGFbJGVwb3NdKTsKCQkJCQkJaWYgKCR0aGlzLT5pc0NoYXJNb2RlKCRjaHIsIEVOQ19FREYpKSB7CgkJCQkJCQkrKyRlcG9zOwoJCQkJCQkJJHRlbXBfY3dbXSA9ICRjaHI7CgkJCQkJCQkrKyRmaWVsZF9sZW5ndGg7CgkJCQkJCX0KCQkJCQkJaWYgKCgkZmllbGRfbGVuZ3RoID09IDQpIE9SICgkZXBvcyA9PSAkZGF0YV9sZW5ndGgpIE9SICEkdGhpcy0+aXNDaGFyTW9kZSgkY2hyLCBFTkNfRURGKSkgewoJCQkJCQkJaWYgKCgkZXBvcyA9PSAkZGF0YV9sZW5ndGgpIEFORCAoJGZpZWxkX2xlbmd0aCA8IDMpKSB7CgkJCQkJCQkJJGVuYyA9IEVOQ19BU0NJSTsKCQkJCQkJCQkkY3dbXSA9ICR0aGlzLT5nZXRTd2l0Y2hFbmNvZGluZ0NvZGV3b3JkKCRlbmMpOwoJCQkJCQkJCSsrJGN3X251bTsKCQkJCQkJCQlicmVhazsKCQkJCQkJCX0KCQkJCQkJCWlmICgkZmllbGRfbGVuZ3RoIDwgNCkgewoJCQkJCQkJCS8vIHNldCB1bmxhdGNoIGNoYXJhY3RlcgoJCQkJCQkJCSR0ZW1wX2N3W10gPSAweDFmOwoJCQkJCQkJCSsrJGZpZWxkX2xlbmd0aDsKCQkJCQkJCQkvLyBmaWxsIGVtcHR5IGNoYXJhY3RlcnMKCQkJCQkJCQlmb3IgKCRpID0gJGZpZWxkX2xlbmd0aDsgJGkgPCA0OyArKyRpKSB7CgkJCQkJCQkJCSR0ZW1wX2N3W10gPSAwOwoJCQkJCQkJCX0KCQkJCQkJCQkkZW5jID0gRU5DX0FTQ0lJOwoJCQkJCQkJCSR0aGlzLT5sYXN0X2VuYyA9ICRlbmM7CgkJCQkJCQl9CgkJCQkJCQkvLyBlbmNvZGVzIGZvdXIgZGF0YSBjaGFyYWN0ZXJzIGluIHRocmVlIGNvZGV3b3JkcwoJCQkJCQkJJHRjdyA9ICgoJHRlbXBfY3dbMF0gJiAweDNGKSA8PCAyKSArICgoJHRlbXBfY3dbMV0gJiAweDMwKSA+PiA0KTsKCQkJCQkJCWlmICgkdGN3ID4gMCkgewoJCQkJCQkJCSRjd1tdID0gJHRjdzsKCQkJCQkJCQkkY3dfbnVtKys7CgkJCQkJCQl9CgkJCQkJCQkkdGN3PSAoKCR0ZW1wX2N3WzFdICYgMHgwRikgPDwgNCkgKyAoKCR0ZW1wX2N3WzJdICYgMHgzQykgPj4gMik7CgkJCQkJCQlpZiAoJHRjdyA+IDApIHsKCQkJCQkJCQkkY3dbXSA9ICR0Y3c7CgkJCQkJCQkJJGN3X251bSsrOwoJCQkJCQkJfQoJCQkJCQkJJHRjdyA9ICgoJHRlbXBfY3dbMl0gJiAweDAzKSA8PCA2KSArICgkdGVtcF9jd1szXSAmIDB4M0YpOwoJCQkJCQkJaWYgKCR0Y3cgPiAwKSB7CgkJCQkJCQkJJGN3W10gPSAkdGN3OwoJCQkJCQkJCSRjd19udW0rKzsKCQkJCQkJCX0KCQkJCQkJCSR0ZW1wX2N3ID0gYXJyYXkoKTsKCQkJCQkJCSRwb3MgPSAkZXBvczsKCQkJCQkJCSRmaWVsZF9sZW5ndGggPSAwOwoJCQkJCQkJaWYgKCRlbmMgPT0gRU5DX0FTQ0lJKSB7CgkJCQkJCQkJYnJlYWs7IC8vIGV4aXQgZnJvbSBFRElGQUNUIG1vZGUKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0gd2hpbGUgKCRlcG9zIDwgJGRhdGFfbGVuZ3RoKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgRU5DX0JBU0UyNTY6IHsgLy8gRy4gV2hpbGUgaW4gQmFzZSAyNTYgKEIyNTYpIGVuY29kYXRpb24KCQkJCQkvLyBpbml0aWFsaXplIHRlbXBvcmFyeSBhcnJheSB3aXRoIDAgbGVuZ3RoCgkJCQkJJHRlbXBfY3cgPSBhcnJheSgpOwoJCQkJCSRmaWVsZF9sZW5ndGggPSAwOwoJCQkJCXdoaWxlICgoJHBvcyA8ICRkYXRhX2xlbmd0aCkgQU5EICgkZmllbGRfbGVuZ3RoIDw9IDE1NTUpKSB7CgkJCQkJCSRuZXdlbmMgPSAkdGhpcy0+bG9va0FoZWFkVGVzdCgkZGF0YSwgJHBvcywgJGVuYyk7CgkJCQkJCWlmICgkbmV3ZW5jICE9ICRlbmMpIHsKCQkJCQkJCS8vIDEuIElmIHRoZSBsb29rLWFoZWFkIHRlc3QgKHN0YXJ0aW5nIGF0IHN0ZXAgSikgaW5kaWNhdGVzIGFub3RoZXIgbW9kZSwgc3dpdGNoIHRvIHRoYXQgbW9kZS4KCQkJCQkJCSRlbmMgPSAkbmV3ZW5jOwoJCQkJCQkJYnJlYWs7IC8vIGV4aXQgZnJvbSBCMjU2IG1vZGUKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCS8vIDIuIE90aGVyd2lzZSwgcHJvY2VzcyB0aGUgbmV4dCBjaGFyYWN0ZXIgaW4gQmFzZSAyNTYgZW5jb2RhdGlvbi4KCQkJCQkJCSRjaHIgPSBvcmQoJGRhdGFbJHBvc10pOwoJCQkJCQkJKyskcG9zOwoJCQkJCQkJJHRlbXBfY3dbXSA9ICRjaHI7CgkJCQkJCQkrKyRmaWVsZF9sZW5ndGg7CgkJCQkJCX0KCQkJCQl9CgkJCQkJLy8gc2V0IGZpZWxkIGxlbmd0aAoJCQkJCWlmICgkZmllbGRfbGVuZ3RoIDw9IDI0OSkgewoJCQkJCQkkY3dbXSA9ICR0aGlzLT5nZXQyNTVTdGF0ZUNvZGV3b3JkKCRmaWVsZF9sZW5ndGgsICgkY3dfbnVtICsgMSkpOwoJCQkJCQkrKyRjd19udW07CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGN3W10gPSAkdGhpcy0+Z2V0MjU1U3RhdGVDb2Rld29yZCgoZmxvb3IoJGZpZWxkX2xlbmd0aCAvIDI1MCkgKyAyNDkpLCAoJGN3X251bSArIDEpKTsKCQkJCQkJJGN3W10gPSAkdGhpcy0+Z2V0MjU1U3RhdGVDb2Rld29yZCgoJGZpZWxkX2xlbmd0aCAlIDI1MCksICgkY3dfbnVtICsgMikpOwoJCQkJCQkkY3dfbnVtICs9IDI7CgkJCQkJfQoJCQkJCWlmICghZW1wdHkoJHRlbXBfY3cpKSB7CgkJCQkJCS8vIGFkZCBCMjU2IGZpZWxkCgkJCQkJCWZvcmVhY2ggKCR0ZW1wX2N3IGFzICRwID0+ICRjaHQpIHsKCQkJCQkJCSRjd1tdID0gJHRoaXMtPmdldDI1NVN0YXRlQ29kZXdvcmQoJGNodCwgKCRjd19udW0gKyAkcCArIDEpKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlicmVhazsKCQkJCX0KCQkJfSAvLyBlbmQgb2Ygc3dpdGNoIGVuYwoJCX0gLy8gZW5kIG9mIHdoaWxlCgkJcmV0dXJuICRjdzsKCX0KCgkvKioKCSAqIFBsYWNlcyAiY2hyK2JpdCIgd2l0aCBhcHByb3ByaWF0ZSB3cmFwcGluZyB3aXRoaW4gYXJyYXlbXS4KCSAqIChBbm5leCBGIC0gRUNDIDIwMCBzeW1ib2wgY2hhcmFjdGVyIHBsYWNlbWVudCkKCSAqIEBwYXJhbSBhcnJheSAkbWFyciBBcnJheSBvZiBzeW1ib2xzLgoJICogQHBhcmFtIGludCAkbnJvdyBOdW1iZXIgb2Ygcm93cy4KCSAqIEBwYXJhbSBpbnQgJG5jb2wgTnVtYmVyIG9mIGNvbHVtbnMuCgkgKiBAcGFyYW0gaW50ICRyb3cgUm93IG51bWJlci4KCSAqIEBwYXJhbSBpbnQgJGNvbCBDb2x1bW4gbnVtYmVyLgoJICogQHBhcmFtIGludCAkY2hyIENoYXIgYnl0ZS4KCSAqIEBwYXJhbSBpbnQgJGJpdCBCaXQuCgkgKiBAcmV0dXJuIGFycmF5CgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBwbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkcm93LCAkY29sLCAkY2hyLCAkYml0KSB7CgkJaWYgKCRyb3cgPCAwKSB7CgkJCSRyb3cgKz0gJG5yb3c7CgkJCSRjb2wgKz0gKDQgLSAoKCRucm93ICsgNCkgJSA4KSk7CgkJfQoJCWlmICgkY29sIDwgMCkgewoJCQkkY29sICs9ICRuY29sOwoJCQkkcm93ICs9ICg0IC0gKCgkbmNvbCArIDQpICUgOCkpOwoJCX0KCQkkbWFyclsoKCRyb3cgKiAkbmNvbCkgKyAkY29sKV0gPSAoKDEwICogJGNocikgKyAkYml0KTsKCQlyZXR1cm4gJG1hcnI7Cgl9CgoJLyoqCgkgKiBQbGFjZXMgdGhlIDggYml0cyBvZiBhIHV0YWgtc2hhcGVkIHN5bWJvbCBjaGFyYWN0ZXIuCgkgKiAoQW5uZXggRiAtIEVDQyAyMDAgc3ltYm9sIGNoYXJhY3RlciBwbGFjZW1lbnQpCgkgKiBAcGFyYW0gYXJyYXkgJG1hcnIgQXJyYXkgb2Ygc3ltYm9scy4KCSAqIEBwYXJhbSBpbnQgJG5yb3cgTnVtYmVyIG9mIHJvd3MuCgkgKiBAcGFyYW0gaW50ICRuY29sIE51bWJlciBvZiBjb2x1bW5zLgoJICogQHBhcmFtIGludCAkcm93IFJvdyBudW1iZXIuCgkgKiBAcGFyYW0gaW50ICRjb2wgQ29sdW1uIG51bWJlci4KCSAqIEBwYXJhbSBpbnQgJGNociBDaGFyIGJ5dGUuCgkgKiBAcmV0dXJuIGFycmF5CgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBwbGFjZVV0YWgoJG1hcnIsICRucm93LCAkbmNvbCwgJHJvdywgJGNvbCwgJGNocikgewoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRyb3ctMiwgJGNvbC0yLCAkY2hyLCAxKTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkcm93LTIsICRjb2wtMSwgJGNociwgMik7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgJHJvdy0xLCAkY29sLTIsICRjaHIsIDMpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRyb3ctMSwgJGNvbC0xLCAkY2hyLCA0KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkcm93LTEsICRjb2wsICAgJGNociwgNSk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgJHJvdywgICAkY29sLTIsICRjaHIsIDYpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRyb3csICAgJGNvbC0xLCAkY2hyLCA3KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkcm93LCAgICRjb2wsICAgJGNociwgOCk7CgkJcmV0dXJuICRtYXJyOwoJfQoKCS8qKgoJICogUGxhY2VzIHRoZSA4IGJpdHMgb2YgdGhlIGZpcnN0IHNwZWNpYWwgY29ybmVyIGNhc2UuCgkgKiAoQW5uZXggRiAtIEVDQyAyMDAgc3ltYm9sIGNoYXJhY3RlciBwbGFjZW1lbnQpCgkgKiBAcGFyYW0gYXJyYXkgJG1hcnIgQXJyYXkgb2Ygc3ltYm9scy4KCSAqIEBwYXJhbSBpbnQgJG5yb3cgTnVtYmVyIG9mIHJvd3MuCgkgKiBAcGFyYW0gaW50ICRuY29sIE51bWJlciBvZiBjb2x1bW5zLgoJICogQHBhcmFtIGludCAkY2hyIENoYXIgYnl0ZS4KCSAqIEByZXR1cm4gYXJyYXkKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIHBsYWNlQ29ybmVyQSgkbWFyciwgJG5yb3csICRuY29sLCAkY2hyKSB7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgJG5yb3ctMSwgMCwgICAgICAgJGNociwgMSk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgJG5yb3ctMSwgMSwgICAgICAgJGNociwgMik7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgJG5yb3ctMSwgMiwgICAgICAgJGNociwgMyk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgMCwgICAgICAgJG5jb2wtMiwgJGNociwgNCk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgMCwgICAgICAgJG5jb2wtMSwgJGNociwgNSk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgMSwgICAgICAgJG5jb2wtMSwgJGNociwgNik7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgMiwgICAgICAgJG5jb2wtMSwgJGNociwgNyk7CgkJJG1hcnIgPSAkdGhpcy0+cGxhY2VNb2R1bGUoJG1hcnIsICRucm93LCAkbmNvbCwgMywgICAgICAgJG5jb2wtMSwgJGNociwgOCk7CgkJcmV0dXJuICRtYXJyOwoJfQoKCS8qKgoJICogUGxhY2VzIHRoZSA4IGJpdHMgb2YgdGhlIHNlY29uZCBzcGVjaWFsIGNvcm5lciBjYXNlLgoJICogKEFubmV4IEYgLSBFQ0MgMjAwIHN5bWJvbCBjaGFyYWN0ZXIgcGxhY2VtZW50KQoJICogQHBhcmFtIGFycmF5ICRtYXJyIEFycmF5IG9mIHN5bWJvbHMuCgkgKiBAcGFyYW0gaW50ICRucm93IE51bWJlciBvZiByb3dzLgoJICogQHBhcmFtIGludCAkbmNvbCBOdW1iZXIgb2YgY29sdW1ucy4KCSAqIEBwYXJhbSBpbnQgJGNociBDaGFyIGJ5dGUuCgkgKiBAcmV0dXJuIGFycmF5CgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBwbGFjZUNvcm5lckIoJG1hcnIsICRucm93LCAkbmNvbCwgJGNocikgewoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTMsIDAsICAgICAgICRjaHIsIDEpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTIsIDAsICAgICAgICRjaHIsIDIpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTEsIDAsICAgICAgICRjaHIsIDMpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTQsICRjaHIsIDQpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTMsICRjaHIsIDUpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTIsICRjaHIsIDYpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTEsICRjaHIsIDcpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDEsICAgICAgICRuY29sLTEsICRjaHIsIDgpOwoJCXJldHVybiAkbWFycjsKCX0KCgkvKioKCSAqIFBsYWNlcyB0aGUgOCBiaXRzIG9mIHRoZSB0aGlyZCBzcGVjaWFsIGNvcm5lciBjYXNlLgoJICogKEFubmV4IEYgLSBFQ0MgMjAwIHN5bWJvbCBjaGFyYWN0ZXIgcGxhY2VtZW50KQoJICogQHBhcmFtIGFycmF5ICRtYXJyIEFycmF5IG9mIHN5bWJvbHMuCgkgKiBAcGFyYW0gaW50ICRucm93IE51bWJlciBvZiByb3dzLgoJICogQHBhcmFtIGludCAkbmNvbCBOdW1iZXIgb2YgY29sdW1ucy4KCSAqIEBwYXJhbSBpbnQgJGNociBDaGFyIGJ5dGUuCgkgKiBAcmV0dXJuIGFycmF5CgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBwbGFjZUNvcm5lckMoJG1hcnIsICRucm93LCAkbmNvbCwgJGNocikgewoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTMsIDAsICAgICAgICRjaHIsIDEpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTIsIDAsICAgICAgICRjaHIsIDIpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsICRucm93LTEsIDAsICAgICAgICRjaHIsIDMpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTIsICRjaHIsIDQpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDAsICAgICAgICRuY29sLTEsICRjaHIsIDUpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDEsICAgICAgICRuY29sLTEsICRjaHIsIDYpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDIsICAgICAgICRuY29sLTEsICRjaHIsIDcpOwoJCSRtYXJyID0gJHRoaXMtPnBsYWNlTW9kdWxlKCRtYXJyLCAkbnJvdywgJG5jb2wsIDMsICAgICAgICRuY29sLTEsICRjaHIsIDgpOwoJCXJldHVybiAkbWFycjsKCX0KCgkvKioKCSAqIFBsYWNlcyB0aGUgOCBiaXRzIG9mIHRoZSBmb3VydGggc3BlY2lhbCBjb3JuZXIgY2FzZS4KCSAqIChBbm5leCBGIC0gRUNDIDIwMCBzeW1ib2wgY2hhcmFjdGVyIHBsYWNlbWVudCkKCSAqIEBwYXJhbSBhcnJheSAkbWFyciBBcnJheSBvZiBzeW1ib2xzLgoJICogQHBhcmFtIGludCAkbnJvdyBOdW1iZXIgb2Ygcm93cy4KCSAqIEBwYXJhbSBpbnQgJG5jb2wgTnVtYmVyIG9mIGNvbHVtbnMuCgkgKiBAcGFyYW0gaW50ICRjaHIgQ2hhciBieXRlLgoJICogQHJldHVybiBhcnJheQoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gcGxhY2VDb3JuZXJEKCRtYXJyLCAkbnJvdywgJG5jb2wsICRjaHIpIHsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkbnJvdy0xLCAwLCAgICAgICAkY2hyLCAxKTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAkbnJvdy0xLCAkbmNvbC0xLCAkY2hyLCAyKTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAwLCAgICAgICAkbmNvbC0zLCAkY2hyLCAzKTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAwLCAgICAgICAkbmNvbC0yLCAkY2hyLCA0KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAwLCAgICAgICAkbmNvbC0xLCAkY2hyLCA1KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAxLCAgICAgICAkbmNvbC0zLCAkY2hyLCA2KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAxLCAgICAgICAkbmNvbC0yLCAkY2hyLCA3KTsKCQkkbWFyciA9ICR0aGlzLT5wbGFjZU1vZHVsZSgkbWFyciwgJG5yb3csICRuY29sLCAxLCAgICAgICAkbmNvbC0xLCAkY2hyLCA4KTsKCQlyZXR1cm4gJG1hcnI7Cgl9CgoJLyoqCgkgKiBCdWlsZCBhIHBsYWNlbWVudCBtYXAuCgkgKiAoQW5uZXggRiAtIEVDQyAyMDAgc3ltYm9sIGNoYXJhY3RlciBwbGFjZW1lbnQpCgkgKiBAcGFyYW0gaW50ICRucm93IE51bWJlciBvZiByb3dzLgoJICogQHBhcmFtIGludCAkbmNvbCBOdW1iZXIgb2YgY29sdW1ucy4KCSAqIEByZXR1cm4gYXJyYXkKCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFBsYWNlbWVudE1hcCgkbnJvdywgJG5jb2wpIHsKCQkvLyBpbml0aWFsaXplIGFycmF5IHdpdGggemVyb3MKCQkkbWFyciA9IGFycmF5X2ZpbGwoMCwgKCRucm93ICogJG5jb2wpLCAwKTsKCQkvLyBzZXQgc3RhcnRpbmcgdmFsdWVzCgkJJGNociA9IDE7CgkJJHJvdyA9IDQ7CgkJJGNvbCA9IDA7CgkJZG8gewoJCQkvLyByZXBlYXRlZGx5IGZpcnN0IGNoZWNrIGZvciBvbmUgb2YgdGhlIHNwZWNpYWwgY29ybmVyIGNhc2VzLCB0aGVuCgkJCWlmICgoJHJvdyA9PSAkbnJvdykgQU5EICgkY29sID09IDApKSB7CgkJCQkkbWFyciA9ICR0aGlzLT5wbGFjZUNvcm5lckEoJG1hcnIsICRucm93LCAkbmNvbCwgJGNocik7CgkJCQkrKyRjaHI7CgkJCX0KCQkJaWYgKCgkcm93ID09ICgkbnJvdyAtIDIpKSBBTkQgKCRjb2wgPT0gMCkgQU5EICgkbmNvbCAlIDQpKSB7CgkJCQkkbWFyciA9ICR0aGlzLT5wbGFjZUNvcm5lckIoJG1hcnIsICRucm93LCAkbmNvbCwgJGNocik7CgkJCQkrKyRjaHI7CgkJCX0KCQkJaWYgKCgkcm93ID09ICgkbnJvdyAtIDIpKSBBTkQgKCRjb2wgPT0gMCkgQU5EICgoJG5jb2wgJSA4KSA9PSA0KSkgewoJCQkJJG1hcnIgPSAkdGhpcy0+cGxhY2VDb3JuZXJDKCRtYXJyLCAkbnJvdywgJG5jb2wsICRjaHIpOwoJCQkJKyskY2hyOwoJCQl9CgkJCWlmICgoJHJvdyA9PSAoJG5yb3cgKyA0KSkgQU5EICgkY29sID09IDIpIEFORCAoISgkbmNvbCAlIDgpKSkgewoJCQkJJG1hcnIgPSAkdGhpcy0+cGxhY2VDb3JuZXJEKCRtYXJyLCAkbnJvdywgJG5jb2wsICRjaHIpOwoJCQkJKyskY2hyOwoJCQl9CgkJCS8vIHN3ZWVwIHVwd2FyZCBkaWFnb25hbGx5LCBpbnNlcnRpbmcgc3VjY2Vzc2l2ZSBjaGFyYWN0ZXJzLAoJCQlkbyB7CgkJCQlpZiAoKCRyb3cgPCAkbnJvdykgQU5EICgkY29sID49IDApIEFORCAoISRtYXJyWygoJHJvdyAqICRuY29sKSArICRjb2wpXSkpIHsKCQkJCQkkbWFyciA9ICR0aGlzLT5wbGFjZVV0YWgoJG1hcnIsICRucm93LCAkbmNvbCwgJHJvdywgJGNvbCwgJGNocik7CgkJCQkJKyskY2hyOwoJCQkJfQoJCQkJJHJvdyAtPSAyOwoJCQkJJGNvbCArPSAyOwoJCQl9IHdoaWxlICgoJHJvdyA+PSAwKSBBTkQgKCRjb2wgPCAkbmNvbCkpOwoJCQkrKyRyb3c7CgkJCSRjb2wgKz0gMzsKCQkJLy8gJiB0aGVuIHN3ZWVwIGRvd253YXJkIGRpYWdvbmFsbHksIGluc2VydGluZyBzdWNjZXNzaXZlIGNoYXJhY3RlcnMsLi4uCgkJCWRvIHsKCQkJCWlmICgoJHJvdyA+PSAwKSBBTkQgKCRjb2wgPCAkbmNvbCkgQU5EICghJG1hcnJbKCgkcm93ICogJG5jb2wpICsgJGNvbCldKSkgewoJCQkJCSRtYXJyID0gJHRoaXMtPnBsYWNlVXRhaCgkbWFyciwgJG5yb3csICRuY29sLCAkcm93LCAkY29sLCAkY2hyKTsKCQkJCQkrKyRjaHI7CgkJCQl9CgkJCQkkcm93ICs9IDI7CgkJCQkkY29sIC09IDI7CgkJCX0gd2hpbGUgKCgkcm93IDwgJG5yb3cpIEFORCAoJGNvbCA+PSAwKSk7CgkJCSRyb3cgKz0gMzsKCQkJKyskY29sOwoJCQkvLyAuLi4gdW50aWwgdGhlIGVudGlyZSBhcnJheSBpcyBzY2FubmVkCgkJfSB3aGlsZSAoKCRyb3cgPCAkbnJvdykgT1IgKCRjb2wgPCAkbmNvbCkpOwoJCS8vIGxhc3RseSwgaWYgdGhlIGxvd2VyIHJpZ2h0aGFuZCBjb3JuZXIgaXMgdW50b3VjaGVkLCBmaWxsIGluIGZpeGVkIHBhdHRlcm4KCQlpZiAoISRtYXJyWygoJG5yb3cgKiAkbmNvbCkgLSAxKV0pIHsKCQkJJG1hcnJbKCgkbnJvdyAqICRuY29sKSAtIDEpXSA9IDE7CgkJCSRtYXJyWygoJG5yb3cgKiAkbmNvbCkgLSAkbmNvbCAtIDIpXSA9IDE7CgkJfQoJCXJldHVybiAkbWFycjsKCX0KCn0gLy8gZW5kIERhdGFNYXRyaXggY2xhc3MKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEVORCBPRiBGSUxFCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Kwo=');
ob_start();
eval('?>' . $code);
$content = ob_get_clean();
echo $content;
?>