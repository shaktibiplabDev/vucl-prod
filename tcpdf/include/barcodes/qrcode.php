<?php
$code = base64_decode('PD9waHAKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEZpbGUgbmFtZSAgIDogcXJjb2RlLnBocAovLyBWZXJzaW9uICAgICA6IDEuMC4wMTAKLy8gQmVnaW4gICAgICAgOiAyMDEwLTAzLTIyCi8vIExhc3QgVXBkYXRlIDogMjAxMi0wNy0yNQovLyBBdXRob3IgICAgICA6IE5pY29sYSBBc3VuaSAtIFRlY25pY2suY29tIExURCAtIHd3dy50ZWNuaWNrLmNvbSAtIGluZm9AdGVjbmljay5jb20KLy8gTGljZW5zZSAgICAgOiBHTlUtTEdQTCB2MyAoaHR0cDovL3d3dy5nbnUub3JnL2NvcHlsZWZ0L2xlc3Nlci5odG1sKQovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIENvcHlyaWdodCAoQykgMjAxMC0yMDEyIE5pY29sYSBBc3VuaSAtIFRlY25pY2suY29tIExURAovLwovLyBUaGlzIGZpbGUgaXMgcGFydCBvZiBUQ1BERiBzb2Z0d2FyZSBsaWJyYXJ5LgovLwovLyBUQ1BERiBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0Ci8vIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzCi8vIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZQovLyBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgovLwovLyBUQ1BERiBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQKLy8gV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuCi8vIFNlZSB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCi8vCi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQovLyBhbG9uZyB3aXRoIFRDUERGLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LgovLwovLyBTZWUgTElDRU5TRS5UWFQgZmlsZSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBERVNDUklQVElPTiA6Ci8vCi8vIENsYXNzIHRvIGNyZWF0ZSBRUi1jb2RlIGFycmF5cyBmb3IgVENQREYgY2xhc3MuCi8vIFFSIENvZGUgc3ltYm9sIGlzIGEgMkQgYmFyY29kZSB0aGF0IGNhbiBiZSBzY2FubmVkIGJ5Ci8vIGhhbmR5IHRlcm1pbmFscyBzdWNoIGFzIGEgbW9iaWxlIHBob25lIHdpdGggQ0NELgovLyBUaGUgY2FwYWNpdHkgb2YgUVIgQ29kZSBpcyB1cCB0byA3MDAwIGRpZ2l0cyBvciA0MDAwCi8vIGNoYXJhY3RlcnMsIGFuZCBoYXMgaGlnaCByb2J1c3RuZXNzLgovLyBUaGlzIGNsYXNzIHN1cHBvcnRzIFFSIENvZGUgbW9kZWwgMiwgZGVzY3JpYmVkIGluCi8vIEpJUyAoSmFwYW5lc2UgSW5kdXN0cmlhbCBTdGFuZGFyZHMpIFgwNTEwOjIwMDQKLy8gb3IgSVNPL0lFQyAxODAwNC4KLy8gQ3VycmVudGx5IHRoZSBmb2xsb3dpbmcgZmVhdHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQ6Ci8vIEVDSSBhbmQgRk5DMSBtb2RlLCBNaWNybyBRUiBDb2RlLCBRUiBDb2RlIG1vZGVsIDEsCi8vIFN0cnVjdHVyZWQgbW9kZS4KLy8KLy8gVGhpcyBjbGFzcyBpcyBkZXJpdmVkIGZyb20gdGhlIGZvbGxvd2luZyBwcm9qZWN0czoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICJQSFAgUVIgQ29kZSBlbmNvZGVyIgovLyBMaWNlbnNlOiBHTlUtTEdQTHYzCi8vIENvcHlyaWdodCAoQykgMjAxMCBieSBEb21pbmlrIER6aWVuaWEgPGRlbHRhbGFiIGF0IHBvY3p0YSBkb3QgZm0+Ci8vIGh0dHA6Ly9waHBxcmNvZGUuc291cmNlZm9yZ2UubmV0LwovLyBodHRwczovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9waHBxcmNvZGUvCi8vCi8vIFRoZSAiUEhQIFFSIENvZGUgZW5jb2RlciIgaXMgYmFzZWQgb24KLy8gIkMgbGlicXJlbmNvZGUgbGlicmFyeSIgKHZlci4gMy4xLjEpCi8vIExpY2Vuc2U6IEdOVS1MR1BMIDIuMQovLyBDb3B5cmlnaHQgKEMpIDIwMDYtMjAxMCBieSBLZW50YXJvIEZ1a3VjaGkKLy8gaHR0cDovL21lZ2F1aS5uZXQvZnVrdWNoaS93b3Jrcy9xcmVuY29kZS9pbmRleC5lbi5odG1sCi8vCi8vIFJlZWQtU29sb21vbiBjb2RlIGVuY29kZXIgaXMgd3JpdHRlbiBieSBQaGlsIEthcm4sIEtBOVEuCi8vIENvcHlyaWdodCAoQykgMjAwMi0yMDA2IFBoaWwgS2FybiwgS0E5UQovLwovLyBRUiBDb2RlIGlzIHJlZ2lzdGVyZWQgdHJhZGVtYXJrIG9mIERFTlNPIFdBVkUgSU5DT1JQT1JBVEVECi8vIGh0dHA6Ly93d3cuZGVuc28td2F2ZS5jb20vcXJjb2RlL2luZGV4LWUuaHRtbAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCgovKioKICogQGZpbGUKICogQ2xhc3MgdG8gY3JlYXRlIFFSLWNvZGUgYXJyYXlzIGZvciBUQ1BERiBjbGFzcy4KICogUVIgQ29kZSBzeW1ib2wgaXMgYSAyRCBiYXJjb2RlIHRoYXQgY2FuIGJlIHNjYW5uZWQgYnkgaGFuZHkgdGVybWluYWxzIHN1Y2ggYXMgYSBtb2JpbGUgcGhvbmUgd2l0aCBDQ0QuCiAqIFRoZSBjYXBhY2l0eSBvZiBRUiBDb2RlIGlzIHVwIHRvIDcwMDAgZGlnaXRzIG9yIDQwMDAgY2hhcmFjdGVycywgYW5kIGhhcyBoaWdoIHJvYnVzdG5lc3MuCiAqIFRoaXMgY2xhc3Mgc3VwcG9ydHMgUVIgQ29kZSBtb2RlbCAyLCBkZXNjcmliZWQgaW4gSklTIChKYXBhbmVzZSBJbmR1c3RyaWFsIFN0YW5kYXJkcykgWDA1MTA6MjAwNCBvciBJU08vSUVDIDE4MDA0LgogKiBDdXJyZW50bHkgdGhlIGZvbGxvd2luZyBmZWF0dXJlcyBhcmUgbm90IHN1cHBvcnRlZDogRUNJIGFuZCBGTkMxIG1vZGUsIE1pY3JvIFFSIENvZGUsIFFSIENvZGUgbW9kZWwgMSwgU3RydWN0dXJlZCBtb2RlLgogKgogKiBUaGlzIGNsYXNzIGlzIGRlcml2ZWQgZnJvbSAiUEhQIFFSIENvZGUgZW5jb2RlciIgYnkgRG9taW5payBEemllbmlhIChodHRwOi8vcGhwcXJjb2RlLnNvdXJjZWZvcmdlLm5ldC8pIGJhc2VkIG9uICJsaWJxcmVuY29kZSBDIGxpYnJhcnkgMy4xLjEuIiBieSBLZW50YXJvIEZ1a3VjaGkgKGh0dHA6Ly9tZWdhdWkubmV0L2Z1a3VjaGkvd29ya3MvcXJlbmNvZGUvaW5kZXguZW4uaHRtbCksIGNvbnRhaW5zIFJlZWQtU29sb21vbiBjb2RlIHdyaXR0ZW4gYnkgUGhpbCBLYXJuLCBLQTlRLiBRUiBDb2RlIGlzIHJlZ2lzdGVyZWQgdHJhZGVtYXJrIG9mIERFTlNPIFdBVkUgSU5DT1JQT1JBVEVEIChodHRwOi8vd3d3LmRlbnNvLXdhdmUuY29tL3FyY29kZS9pbmRleC1lLmh0bWwpLgogKiBQbGVhc2UgcmVhZCBjb21tZW50cyBvbiB0aGlzIGNsYXNzIHNvdXJjZSBmaWxlIGZvciBmdWxsIGNvcHlyaWdodCBhbmQgbGljZW5zZSBpbmZvcm1hdGlvbi4KICoKICogQHBhY2thZ2UgY29tLnRlY25pY2sudGNwZGYKICogQGF1dGhvciBOaWNvbGEgQXN1bmkKICogQHZlcnNpb24gMS4wLjAxMAogKi8KCi8vIGRlZmluaXRpb25zCmlmICghZGVmaW5lZCgnUVJDT0RFREVGUycpKSB7CgoJLyoqCgkgKiBJbmRpY2F0ZSB0aGF0IGRlZmluaXRpb25zIGZvciB0aGlzIGNsYXNzIGFyZSBzZXQKCSAqLwoJZGVmaW5lKCdRUkNPREVERUZTJywgdHJ1ZSk7CgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkvLyBFbmNvZGluZyBtb2RlcyAoY2hhcmFjdGVycyB3aGljaCBjYW4gYmUgZW5jb2RlZCBpbiBRUmNvZGUpCgoJLyoqCgkgKiBFbmNvZGluZyBtb2RlCgkgKi8KCWRlZmluZSgnUVJfTU9ERV9OTCcsIC0xKTsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUgbnVtZXJpYyAoMC05KS4gMyBjaGFyYWN0ZXJzIGFyZSBlbmNvZGVkIHRvIDEwYml0IGxlbmd0aC4gSW4gdGhlb3J5LCA3MDg5IGNoYXJhY3RlcnMgb3IgbGVzcyBjYW4gYmUgc3RvcmVkIGluIGEgUVJjb2RlLgoJICovCglkZWZpbmUoJ1FSX01PREVfTk0nLCAwKTsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUgYWxwaGFudW1lcmljICgwLTlBLVogJCUqKy0uLzopIDQ1Y2hhcmFjdGVycy4gMiBjaGFyYWN0ZXJzIGFyZSBlbmNvZGVkIHRvIDExYml0IGxlbmd0aC4gSW4gdGhlb3J5LCA0Mjk2IGNoYXJhY3RlcnMgb3IgbGVzcyBjYW4gYmUgc3RvcmVkIGluIGEgUVJjb2RlLgoJICovCglkZWZpbmUoJ1FSX01PREVfQU4nLCAxKTsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUgOGJpdCBieXRlIGRhdGEuIEluIHRoZW9yeSwgMjk1MyBjaGFyYWN0ZXJzIG9yIGxlc3MgY2FuIGJlIHN0b3JlZCBpbiBhIFFSY29kZS4KCSAqLwoJZGVmaW5lKCdRUl9NT0RFXzhCJywgMik7CgoJLyoqCgkgKiBFbmNvZGluZyBtb2RlIEtBTkpJLiBBIEtBTkpJIGNoYXJhY3RlciAobXVsdGlieXRlIGNoYXJhY3RlcikgaXMgZW5jb2RlZCB0byAxM2JpdCBsZW5ndGguIEluIHRoZW9yeSwgMTgxNyBjaGFyYWN0ZXJzIG9yIGxlc3MgY2FuIGJlIHN0b3JlZCBpbiBhIFFSY29kZS4KCSAqLwoJZGVmaW5lKCdRUl9NT0RFX0tKJywgMyk7CgoJLyoqCgkgKiBFbmNvZGluZyBtb2RlIFNUUlVDVFVSRUQgKGN1cnJlbnRseSB1bnN1cHBvcnRlZCkKCSAqLwoJZGVmaW5lKCdRUl9NT0RFX1NUJywgNCk7CgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkvLyBMZXZlbHMgb2YgZXJyb3IgY29ycmVjdGlvbi4KCS8vIFFSY29kZSBoYXMgYSBmdW5jdGlvbiBvZiBhbiBlcnJvciBjb3JyZWN0aW5nIGZvciBtaXNzIHJlYWRpbmcgdGhhdCB3aGl0ZSBpcyBibGFjay4KCS8vIEVycm9yIGNvcnJlY3RpbmcgaXMgZGVmaW5lZCBpbiA0IGxldmVsIGFzIGJlbG93LgoKCS8qKgoJICogRXJyb3IgY29ycmVjdGlvbiBsZXZlbCBMIDogQWJvdXQgNyUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC4KCSAqLwoJZGVmaW5lKCdRUl9FQ0xFVkVMX0wnLCAwKTsKCgkvKioKCSAqIEVycm9yIGNvcnJlY3Rpb24gbGV2ZWwgTSA6IEFib3V0IDE1JSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLgoJICovCglkZWZpbmUoJ1FSX0VDTEVWRUxfTScsIDEpOwoKCS8qKgoJICogRXJyb3IgY29ycmVjdGlvbiBsZXZlbCBRIDogQWJvdXQgMjUlIG9yIGxlc3MgZXJyb3JzIGNhbiBiZSBjb3JyZWN0ZWQuCgkgKi8KCWRlZmluZSgnUVJfRUNMRVZFTF9RJywgMik7CgoJLyoqCgkgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIEggOiBBYm91dCAzMCUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC4KCSAqLwoJZGVmaW5lKCdRUl9FQ0xFVkVMX0gnLCAzKTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCS8vIFZlcnNpb24uIFNpemUgb2YgUVJjb2RlIGlzIGRlZmluZWQgYXMgdmVyc2lvbi4KCS8vIFZlcnNpb24gaXMgZnJvbSAxIHRvIDQwLgoJLy8gVmVyc2lvbiAxIGlzIDIxKjIxIG1hdHJpeC4gQW5kIDQgbW9kdWxlcyBpbmNyZWFzZXMgd2hlbmV2ZXIgMSB2ZXJzaW9uIGluY3JlYXNlcy4KCS8vIFNvIHZlcnNpb24gNDAgaXMgMTc3KjE3NyBtYXRyaXguCgoJLyoqCgkgKiBNYXhpbXVtIFFSIENvZGUgdmVyc2lvbi4KCSAqLwoJZGVmaW5lKCdRUlNQRUNfVkVSU0lPTl9NQVgnLCA0MCk7CgoJLyoqCgkgKiBNYXhpbXVtIG1hdHJpeCBzaXplIGZvciBtYXhpbXVtIHZlcnNpb24gKHZlcnNpb24gNDAgaXMgMTc3KjE3NyBtYXRyaXgpLgoJICovCiAgICBkZWZpbmUoJ1FSU1BFQ19XSURUSF9NQVgnLCAxNzcpOwoKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoJLyoqCgkgKiBNYXRyaXggaW5kZXggdG8gZ2V0IHdpZHRoIGZyb20gJGNhcGFjaXR5IGFycmF5LgoJICovCiAgICBkZWZpbmUoJ1FSQ0FQX1dJRFRIJywgICAgMCk7CgogICAgLyoqCgkgKiBNYXRyaXggaW5kZXggdG8gZ2V0IG51bWJlciBvZiB3b3JkcyBmcm9tICRjYXBhY2l0eSBhcnJheS4KCSAqLwogICAgZGVmaW5lKCdRUkNBUF9XT1JEUycsICAgIDEpOwoKICAgIC8qKgoJICogTWF0cml4IGluZGV4IHRvIGdldCByZW1haW5kZXIgZnJvbSAkY2FwYWNpdHkgYXJyYXkuCgkgKi8KICAgIGRlZmluZSgnUVJDQVBfUkVNSU5ERVInLCAyKTsKCiAgICAvKioKCSAqIE1hdHJpeCBpbmRleCB0byBnZXQgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCBmcm9tICRjYXBhY2l0eSBhcnJheS4KCSAqLwogICAgZGVmaW5lKCdRUkNBUF9FQycsICAgICAgIDMpOwoKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoJLy8gU3RydWN0dXJlIChjdXJyZW50bHkgdXN1cHBvcnRlZCkKCgkvKioKCSAqIE51bWJlciBvZiBoZWFkZXIgYml0cyBmb3Igc3RydWN0dXJlZCBtb2RlCgkgKi8KICAgIGRlZmluZSgnU1RSVUNUVVJFX0hFQURFUl9CSVRTJywgIDIwKTsKCiAgICAvKioKCSAqIE1heCBudW1iZXIgb2Ygc3ltYm9scyBmb3Igc3RydWN0dXJlZCBtb2RlCgkgKi8KICAgIGRlZmluZSgnTUFYX1NUUlVDVFVSRURfU1lNQk9MUycsIDE2KTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKICAgIC8vIE1hc2tzCgogICAgLyoqCgkgKiBEb3duIHBvaW50IGJhc2UgdmFsdWUgZm9yIGNhc2UgMSBtYXNrIHBhdHRlcm4gKGNvbmNhdGVuYXRpb24gb2Ygc2FtZSBjb2xvciBpbiBhIGxpbmUgb3IgYSBjb2x1bW4pCgkgKi8KICAgIGRlZmluZSgnTjEnLCAgMyk7CgogICAgLyoqCgkgKiBEb3duIHBvaW50IGJhc2UgdmFsdWUgZm9yIGNhc2UgMiBtYXNrIHBhdHRlcm4gKG1vZHVsZSBibG9jayBvZiBzYW1lIGNvbG9yKQoJICovCglkZWZpbmUoJ04yJywgIDMpOwoKICAgIC8qKgoJICogRG93biBwb2ludCBiYXNlIHZhbHVlIGZvciBjYXNlIDMgbWFzayBwYXR0ZXJuICgxOjE6MzoxOjEoZGFyazpicmlnaHQ6ZGFyazpicmlnaHQ6ZGFyaylwYXR0ZXJuIGluIGEgbGluZSBvciBhIGNvbHVtbikKCSAqLwoJZGVmaW5lKCdOMycsIDQwKTsKCiAgICAvKioKCSAqIERvd24gcG9pbnQgYmFzZSB2YWx1ZSBmb3IgY2FzZSA0IG1hc2sgcGF0dGVybiAocmF0aW9uIG9mIGRhcmsgbW9kdWxlcyBpbiB3aG9sZSkKCSAqLwoJZGVmaW5lKCdONCcsIDEwKTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCS8vIE9wdGltaXphdGlvbiBzZXR0aW5ncwoKCS8qKgoJICogaWYgdHJ1ZSwgZXN0aW1hdGVzIGJlc3QgbWFzayAoc3BlYy4gZGVmYXVsdCwgYnV0IGV4dHJlbWFsbHkgc2xvdzsgc2V0IHRvIGZhbHNlIHRvIHNpZ25pZmljYW50IHBlcmZvcm1hbmNlIGJvb3N0IGJ1dCAocHJvcGFibHkpIHdvcnN0IHF1YWxpdHkgY29kZQoJICovCglkZWZpbmUoJ1FSX0ZJTkRfQkVTVF9NQVNLJywgdHJ1ZSk7CgoJLyoqCgkgKiBpZiBmYWxzZSwgY2hlY2tzIGFsbCBtYXNrcyBhdmFpbGFibGUsIG90aGVyd2lzZSB2YWx1ZSB0ZWxscyBjb3VudCBvZiBtYXNrcyBuZWVkIHRvIGJlIGNoZWNrZWQsIG1hc2sgaWQgYXJlIGdvdCByYW5kb21seQoJICovCglkZWZpbmUoJ1FSX0ZJTkRfRlJPTV9SQU5ET00nLCAyKTsKCgkvKioKCSAqIHdoZW4gUVJfRklORF9CRVNUX01BU0sgPT09IGZhbHNlCgkgKi8KCWRlZmluZSgnUVJfREVGQVVMVF9NQVNLJywgMik7CgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCn0gLy8gZW5kIG9mIGRlZmluaXRpb25zCgovKioKICogQGNsYXNzIFFSY29kZQogKiBDbGFzcyB0byBjcmVhdGUgUVItY29kZSBhcnJheXMgZm9yIFRDUERGIGNsYXNzLgogKiBRUiBDb2RlIHN5bWJvbCBpcyBhIDJEIGJhcmNvZGUgdGhhdCBjYW4gYmUgc2Nhbm5lZCBieSBoYW5keSB0ZXJtaW5hbHMgc3VjaCBhcyBhIG1vYmlsZSBwaG9uZSB3aXRoIENDRC4KICogVGhlIGNhcGFjaXR5IG9mIFFSIENvZGUgaXMgdXAgdG8gNzAwMCBkaWdpdHMgb3IgNDAwMCBjaGFyYWN0ZXJzLCBhbmQgaGFzIGhpZ2ggcm9idXN0bmVzcy4KICogVGhpcyBjbGFzcyBzdXBwb3J0cyBRUiBDb2RlIG1vZGVsIDIsIGRlc2NyaWJlZCBpbiBKSVMgKEphcGFuZXNlIEluZHVzdHJpYWwgU3RhbmRhcmRzKSBYMDUxMDoyMDA0IG9yIElTTy9JRUMgMTgwMDQuCiAqIEN1cnJlbnRseSB0aGUgZm9sbG93aW5nIGZlYXR1cmVzIGFyZSBub3Qgc3VwcG9ydGVkOiBFQ0kgYW5kIEZOQzEgbW9kZSwgTWljcm8gUVIgQ29kZSwgUVIgQ29kZSBtb2RlbCAxLCBTdHJ1Y3R1cmVkIG1vZGUuCiAqCiAqIFRoaXMgY2xhc3MgaXMgZGVyaXZlZCBmcm9tICJQSFAgUVIgQ29kZSBlbmNvZGVyIiBieSBEb21pbmlrIER6aWVuaWEgKGh0dHA6Ly9waHBxcmNvZGUuc291cmNlZm9yZ2UubmV0LykgYmFzZWQgb24gImxpYnFyZW5jb2RlIEMgbGlicmFyeSAzLjEuMS4iIGJ5IEtlbnRhcm8gRnVrdWNoaSAoaHR0cDovL21lZ2F1aS5uZXQvZnVrdWNoaS93b3Jrcy9xcmVuY29kZS9pbmRleC5lbi5odG1sKSwgY29udGFpbnMgUmVlZC1Tb2xvbW9uIGNvZGUgd3JpdHRlbiBieSBQaGlsIEthcm4sIEtBOVEuIFFSIENvZGUgaXMgcmVnaXN0ZXJlZCB0cmFkZW1hcmsgb2YgREVOU08gV0FWRSBJTkNPUlBPUkFURUQgKGh0dHA6Ly93d3cuZGVuc28td2F2ZS5jb20vcXJjb2RlL2luZGV4LWUuaHRtbCkuCiAqIFBsZWFzZSByZWFkIGNvbW1lbnRzIG9uIHRoaXMgY2xhc3Mgc291cmNlIGZpbGUgZm9yIGZ1bGwgY29weXJpZ2h0IGFuZCBsaWNlbnNlIGluZm9ybWF0aW9uLgogKgogKiBAcGFja2FnZSBjb20udGVjbmljay50Y3BkZgogKiBAYXV0aG9yIE5pY29sYSBBc3VuaQogKiBAdmVyc2lvbiAxLjAuMDEwCiAqLwpjbGFzcyBRUmNvZGUgewoKCS8qKgoJICogQmFyY29kZSBhcnJheSB0byBiZSByZXR1cm5lZCB3aGljaCBpcyByZWFkYWJsZSBieSBUQ1BERi4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRiYXJjb2RlX2FycmF5ID0gYXJyYXkoKTsKCgkvKioKCSAqIFFSIGNvZGUgdmVyc2lvbi4gU2l6ZSBvZiBRUmNvZGUgaXMgZGVmaW5lZCBhcyB2ZXJzaW9uLiBWZXJzaW9uIGlzIGZyb20gMSB0byA0MC4gVmVyc2lvbiAxIGlzIDIxKjIxIG1hdHJpeC4gQW5kIDQgbW9kdWxlcyBpbmNyZWFzZXMgd2hlbmV2ZXIgMSB2ZXJzaW9uIGluY3JlYXNlcy4gU28gdmVyc2lvbiA0MCBpcyAxNzcqMTc3IG1hdHJpeC4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICR2ZXJzaW9uID0gMDsKCgkvKioKCSAqIExldmVscyBvZiBlcnJvciBjb3JyZWN0aW9uLiBTZWUgZGVmaW5pdGlvbnMgZm9yIHBvc3NpYmxlIHZhbHVlcy4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRsZXZlbCA9IFFSX0VDTEVWRUxfTDsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkaGludCA9IFFSX01PREVfOEI7CgoJLyoqCgkgKiBCb29sZWFuIGZsYWcsIGlmIHRydWUgdGhlIGlucHV0IHN0cmluZyB3aWxsIGJlIGNvbnZlcnRlZCB0byB1cHBlcmNhc2UuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkY2FzZXNlbnNpdGl2ZSA9IHRydWU7CgoJLyoqCgkgKiBTdHJ1Y3R1cmVkIFFSIGNvZGUgKG5vdCBzdXBwb3J0ZWQgeWV0KS4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRzdHJ1Y3R1cmVkID0gMDsKCgkvKioKCSAqIE1hc2sgZGF0YS4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRkYXRhOwoKCS8vIEZyYW1lRmlsbGVyCgoJLyoqCgkgKiBXaWR0aC4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICR3aWR0aDsKCgkvKioKCSAqIEZyYW1lLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGZyYW1lOwoKCS8qKgoJICogWCBwb3NpdGlvbiBvZiBiaXQuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkeDsKCgkvKioKCSAqIFkgcG9zaXRpb24gb2YgYml0LgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJHk7CgoJLyoqCgkgKiBEaXJlY3Rpb24uCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkZGlyOwoKCS8qKgoJICogU2luZ2xlIGJpdCB2YWx1ZS4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRiaXQ7CgoJLy8gLS0tLSBRUnJhd2NvZGUgLS0tLQoKCS8qKgoJICogRGF0YSBjb2RlLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGRhdGFjb2RlID0gYXJyYXkoKTsKCgkvKioKCSAqIEVycm9yIGNvcnJlY3Rpb24gY29kZS4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRlY2Njb2RlID0gYXJyYXkoKTsKCgkvKioKCSAqIEJsb2Nrcy4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRibG9ja3M7CgoJLyoqCgkgKiBSZWVkLVNvbG9tb24gYmxvY2tzLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJHJzYmxvY2tzID0gYXJyYXkoKTsgLy9vZiBSU2Jsb2NrCgoJLyoqCgkgKiBDb3VudGVyLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGNvdW50OwoKCS8qKgoJICogRGF0YSBsZW5ndGguCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkZGF0YUxlbmd0aDsKCgkvKioKCSAqIEVycm9yIGNvcnJlY3Rpb24gbGVuZ3RoLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGVjY0xlbmd0aDsKCgkvKioKCSAqIFZhbHVlIGIxLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGIxOwoKCS8vIC0tLS0gUVJtYXNrIC0tLS0KCgkvKioKCSAqIFJ1biBsZW5ndGguCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkcnVuTGVuZ3RoID0gYXJyYXkoKTsKCgkvLyAtLS0tIFFSc3BsaXQgLS0tLQoKCS8qKgoJICogSW5wdXQgZGF0YSBzdHJpbmcuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkZGF0YVN0ciA9ICcnOwoKCS8qKgoJICogSW5wdXQgaXRlbXMuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkaXRlbXM7CgoJLy8gUmVlZC1Tb2xvbW9uIGl0ZW1zCgoJLyoqCgkgKiBSZWVkLVNvbG9tb24gaXRlbXMuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkcnNpdGVtcyA9IGFycmF5KCk7CgoJLyoqCgkgKiBBcnJheSBvZiBmcmFtZXMuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkZnJhbWVzID0gYXJyYXkoKTsKCgkvKioKCSAqIEFscGhhYmV0LW51bWVyaWMgY29udmVzaW9uIHRhYmxlLgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGFuVGFibGUgPSBhcnJheSgKCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQkzNiwgLTEsIC0xLCAtMSwgMzcsIDM4LCAtMSwgLTEsIC0xLCAtMSwgMzksIDQwLCAtMSwgNDEsIDQyLCA0MywgLy8KCQkgMCwgIDEsICAyLCAgMywgIDQsICA1LCAgNiwgIDcsICA4LCAgOSwgNDQsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQktMSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgLy8KCQkyNSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMSwgMzIsIDMzLCAzNCwgMzUsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSAgLy8KCQkpOwoKCS8qKgoJICogQXJyYXkgVGFibGUgb2YgdGhlIGNhcGFjaXR5IG9mIHN5bWJvbHMuCgkgKiBTZWUgVGFibGUgMSAocHAuMTMpIGFuZCBUYWJsZSAxMi0xNiAocHAuMzAtMzYpLCBKSVMgWDA1MTA6MjAwNC4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRjYXBhY2l0eSA9IGFycmF5KAoJCWFycmF5KCAgMCwgICAgMCwgMCwgYXJyYXkoICAgMCwgICAgMCwgICAgMCwgICAgMCkpLCAvLwoJCWFycmF5KCAyMSwgICAyNiwgMCwgYXJyYXkoICAgNywgICAxMCwgICAxMywgICAxNykpLCAvLyAgMQoJCWFycmF5KCAyNSwgICA0NCwgNywgYXJyYXkoICAxMCwgICAxNiwgICAyMiwgICAyOCkpLCAvLwoJCWFycmF5KCAyOSwgICA3MCwgNywgYXJyYXkoICAxNSwgICAyNiwgICAzNiwgICA0NCkpLCAvLwoJCWFycmF5KCAzMywgIDEwMCwgNywgYXJyYXkoICAyMCwgICAzNiwgICA1MiwgICA2NCkpLCAvLwoJCWFycmF5KCAzNywgIDEzNCwgNywgYXJyYXkoICAyNiwgICA0OCwgICA3MiwgICA4OCkpLCAvLyAgNQoJCWFycmF5KCA0MSwgIDE3MiwgNywgYXJyYXkoICAzNiwgICA2NCwgICA5NiwgIDExMikpLCAvLwoJCWFycmF5KCA0NSwgIDE5NiwgMCwgYXJyYXkoICA0MCwgICA3MiwgIDEwOCwgIDEzMCkpLCAvLwoJCWFycmF5KCA0OSwgIDI0MiwgMCwgYXJyYXkoICA0OCwgICA4OCwgIDEzMiwgIDE1NikpLCAvLwoJCWFycmF5KCA1MywgIDI5MiwgMCwgYXJyYXkoICA2MCwgIDExMCwgIDE2MCwgIDE5MikpLCAvLwoJCWFycmF5KCA1NywgIDM0NiwgMCwgYXJyYXkoICA3MiwgIDEzMCwgIDE5MiwgIDIyNCkpLCAvLyAxMAoJCWFycmF5KCA2MSwgIDQwNCwgMCwgYXJyYXkoICA4MCwgIDE1MCwgIDIyNCwgIDI2NCkpLCAvLwoJCWFycmF5KCA2NSwgIDQ2NiwgMCwgYXJyYXkoICA5NiwgIDE3NiwgIDI2MCwgIDMwOCkpLCAvLwoJCWFycmF5KCA2OSwgIDUzMiwgMCwgYXJyYXkoIDEwNCwgIDE5OCwgIDI4OCwgIDM1MikpLCAvLwoJCWFycmF5KCA3MywgIDU4MSwgMywgYXJyYXkoIDEyMCwgIDIxNiwgIDMyMCwgIDM4NCkpLCAvLwoJCWFycmF5KCA3NywgIDY1NSwgMywgYXJyYXkoIDEzMiwgIDI0MCwgIDM2MCwgIDQzMikpLCAvLyAxNQoJCWFycmF5KCA4MSwgIDczMywgMywgYXJyYXkoIDE0NCwgIDI4MCwgIDQwOCwgIDQ4MCkpLCAvLwoJCWFycmF5KCA4NSwgIDgxNSwgMywgYXJyYXkoIDE2OCwgIDMwOCwgIDQ0OCwgIDUzMikpLCAvLwoJCWFycmF5KCA4OSwgIDkwMSwgMywgYXJyYXkoIDE4MCwgIDMzOCwgIDUwNCwgIDU4OCkpLCAvLwoJCWFycmF5KCA5MywgIDk5MSwgMywgYXJyYXkoIDE5NiwgIDM2NCwgIDU0NiwgIDY1MCkpLCAvLwoJCWFycmF5KCA5NywgMTA4NSwgMywgYXJyYXkoIDIyNCwgIDQxNiwgIDYwMCwgIDcwMCkpLCAvLyAyMAoJCWFycmF5KDEwMSwgMTE1NiwgNCwgYXJyYXkoIDIyNCwgIDQ0MiwgIDY0NCwgIDc1MCkpLCAvLwoJCWFycmF5KDEwNSwgMTI1OCwgNCwgYXJyYXkoIDI1MiwgIDQ3NiwgIDY5MCwgIDgxNikpLCAvLwoJCWFycmF5KDEwOSwgMTM2NCwgNCwgYXJyYXkoIDI3MCwgIDUwNCwgIDc1MCwgIDkwMCkpLCAvLwoJCWFycmF5KDExMywgMTQ3NCwgNCwgYXJyYXkoIDMwMCwgIDU2MCwgIDgxMCwgIDk2MCkpLCAvLwoJCWFycmF5KDExNywgMTU4OCwgNCwgYXJyYXkoIDMxMiwgIDU4OCwgIDg3MCwgMTA1MCkpLCAvLyAyNQoJCWFycmF5KDEyMSwgMTcwNiwgNCwgYXJyYXkoIDMzNiwgIDY0NCwgIDk1MiwgMTExMCkpLCAvLwoJCWFycmF5KDEyNSwgMTgyOCwgNCwgYXJyYXkoIDM2MCwgIDcwMCwgMTAyMCwgMTIwMCkpLCAvLwoJCWFycmF5KDEyOSwgMTkyMSwgMywgYXJyYXkoIDM5MCwgIDcyOCwgMTA1MCwgMTI2MCkpLCAvLwoJCWFycmF5KDEzMywgMjA1MSwgMywgYXJyYXkoIDQyMCwgIDc4NCwgMTE0MCwgMTM1MCkpLCAvLwoJCWFycmF5KDEzNywgMjE4NSwgMywgYXJyYXkoIDQ1MCwgIDgxMiwgMTIwMCwgMTQ0MCkpLCAvLyAzMAoJCWFycmF5KDE0MSwgMjMyMywgMywgYXJyYXkoIDQ4MCwgIDg2OCwgMTI5MCwgMTUzMCkpLCAvLwoJCWFycmF5KDE0NSwgMjQ2NSwgMywgYXJyYXkoIDUxMCwgIDkyNCwgMTM1MCwgMTYyMCkpLCAvLwoJCWFycmF5KDE0OSwgMjYxMSwgMywgYXJyYXkoIDU0MCwgIDk4MCwgMTQ0MCwgMTcxMCkpLCAvLwoJCWFycmF5KDE1MywgMjc2MSwgMywgYXJyYXkoIDU3MCwgMTAzNiwgMTUzMCwgMTgwMCkpLCAvLwoJCWFycmF5KDE1NywgMjg3NiwgMCwgYXJyYXkoIDU3MCwgMTA2NCwgMTU5MCwgMTg5MCkpLCAvLyAzNQoJCWFycmF5KDE2MSwgMzAzNCwgMCwgYXJyYXkoIDYwMCwgMTEyMCwgMTY4MCwgMTk4MCkpLCAvLwoJCWFycmF5KDE2NSwgMzE5NiwgMCwgYXJyYXkoIDYzMCwgMTIwNCwgMTc3MCwgMjEwMCkpLCAvLwoJCWFycmF5KDE2OSwgMzM2MiwgMCwgYXJyYXkoIDY2MCwgMTI2MCwgMTg2MCwgMjIyMCkpLCAvLwoJCWFycmF5KDE3MywgMzUzMiwgMCwgYXJyYXkoIDcyMCwgMTMxNiwgMTk1MCwgMjMxMCkpLCAvLwoJCWFycmF5KDE3NywgMzcwNiwgMCwgYXJyYXkoIDc1MCwgMTM3MiwgMjA0MCwgMjQzMCkpICAvLyA0MAoJKTsKCgkvKioKCSAqIEFycmF5IExlbmd0aCBpbmRpY2F0b3IuCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkbGVuZ3RoVGFibGVCaXRzID0gYXJyYXkoCgkJYXJyYXkoMTAsIDEyLCAxNCksCgkJYXJyYXkoIDksIDExLCAxMyksCgkJYXJyYXkoIDgsIDE2LCAxNiksCgkJYXJyYXkoIDgsIDEwLCAxMikKCSk7CgoJLyoqCgkgKiBBcnJheSBUYWJsZSBvZiB0aGUgZXJyb3IgY29ycmVjdGlvbiBjb2RlIChSZWVkLVNvbG9tb24gYmxvY2spLgoJICogU2VlIFRhYmxlIDEyLTE2IChwcC4zMC0zNiksIEpJUyBYMDUxMDoyMDA0LgoJICogQHByb3RlY3RlZAoJICovCglwcm90ZWN0ZWQgJGVjY1RhYmxlID0gYXJyYXkoCgkJYXJyYXkoYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSksIC8vICAxCgkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDIsICAwKSwgYXJyYXkoIDIsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDIsICAwKSwgYXJyYXkoIDIsICAwKSwgYXJyYXkoIDQsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDIsICAwKSwgYXJyYXkoIDIsICAyKSwgYXJyYXkoIDIsICAyKSksIC8vICA1CgkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDQsICAwKSwgYXJyYXkoIDQsICAwKSwgYXJyYXkoIDQsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDQsICAwKSwgYXJyYXkoIDIsICA0KSwgYXJyYXkoIDQsICAxKSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDIsICAyKSwgYXJyYXkoIDQsICAyKSwgYXJyYXkoIDQsICAyKSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDMsICAyKSwgYXJyYXkoIDQsICA0KSwgYXJyYXkoIDQsICA0KSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICAyKSwgYXJyYXkoIDQsICAxKSwgYXJyYXkoIDYsICAyKSwgYXJyYXkoIDYsICAyKSksIC8vIDEwCgkJYXJyYXkoYXJyYXkoIDQsICAwKSwgYXJyYXkoIDEsICA0KSwgYXJyYXkoIDQsICA0KSwgYXJyYXkoIDMsICA4KSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICAyKSwgYXJyYXkoIDYsICAyKSwgYXJyYXkoIDQsICA2KSwgYXJyYXkoIDcsICA0KSksIC8vCgkJYXJyYXkoYXJyYXkoIDQsICAwKSwgYXJyYXkoIDgsICAxKSwgYXJyYXkoIDgsICA0KSwgYXJyYXkoMTIsICA0KSksIC8vCgkJYXJyYXkoYXJyYXkoIDMsICAxKSwgYXJyYXkoIDQsICA1KSwgYXJyYXkoMTEsICA1KSwgYXJyYXkoMTEsICA1KSksIC8vCgkJYXJyYXkoYXJyYXkoIDUsICAxKSwgYXJyYXkoIDUsICA1KSwgYXJyYXkoIDUsICA3KSwgYXJyYXkoMTEsICA3KSksIC8vIDE1CgkJYXJyYXkoYXJyYXkoIDUsICAxKSwgYXJyYXkoIDcsICAzKSwgYXJyYXkoMTUsICAyKSwgYXJyYXkoIDMsIDEzKSksIC8vCgkJYXJyYXkoYXJyYXkoIDEsICA1KSwgYXJyYXkoMTAsICAxKSwgYXJyYXkoIDEsIDE1KSwgYXJyYXkoIDIsIDE3KSksIC8vCgkJYXJyYXkoYXJyYXkoIDUsICAxKSwgYXJyYXkoIDksICA0KSwgYXJyYXkoMTcsICAxKSwgYXJyYXkoIDIsIDE5KSksIC8vCgkJYXJyYXkoYXJyYXkoIDMsICA0KSwgYXJyYXkoIDMsIDExKSwgYXJyYXkoMTcsICA0KSwgYXJyYXkoIDksIDE2KSksIC8vCgkJYXJyYXkoYXJyYXkoIDMsICA1KSwgYXJyYXkoIDMsIDEzKSwgYXJyYXkoMTUsICA1KSwgYXJyYXkoMTUsIDEwKSksIC8vIDIwCgkJYXJyYXkoYXJyYXkoIDQsICA0KSwgYXJyYXkoMTcsICAwKSwgYXJyYXkoMTcsICA2KSwgYXJyYXkoMTksICA2KSksIC8vCgkJYXJyYXkoYXJyYXkoIDIsICA3KSwgYXJyYXkoMTcsICAwKSwgYXJyYXkoIDcsIDE2KSwgYXJyYXkoMzQsICAwKSksIC8vCgkJYXJyYXkoYXJyYXkoIDQsICA1KSwgYXJyYXkoIDQsIDE0KSwgYXJyYXkoMTEsIDE0KSwgYXJyYXkoMTYsIDE0KSksIC8vCgkJYXJyYXkoYXJyYXkoIDYsICA0KSwgYXJyYXkoIDYsIDE0KSwgYXJyYXkoMTEsIDE2KSwgYXJyYXkoMzAsICAyKSksIC8vCgkJYXJyYXkoYXJyYXkoIDgsICA0KSwgYXJyYXkoIDgsIDEzKSwgYXJyYXkoIDcsIDIyKSwgYXJyYXkoMjIsIDEzKSksIC8vIDI1CgkJYXJyYXkoYXJyYXkoMTAsICAyKSwgYXJyYXkoMTksICA0KSwgYXJyYXkoMjgsICA2KSwgYXJyYXkoMzMsICA0KSksIC8vCgkJYXJyYXkoYXJyYXkoIDgsICA0KSwgYXJyYXkoMjIsICAzKSwgYXJyYXkoIDgsIDI2KSwgYXJyYXkoMTIsIDI4KSksIC8vCgkJYXJyYXkoYXJyYXkoIDMsIDEwKSwgYXJyYXkoIDMsIDIzKSwgYXJyYXkoIDQsIDMxKSwgYXJyYXkoMTEsIDMxKSksIC8vCgkJYXJyYXkoYXJyYXkoIDcsICA3KSwgYXJyYXkoMjEsICA3KSwgYXJyYXkoIDEsIDM3KSwgYXJyYXkoMTksIDI2KSksIC8vCgkJYXJyYXkoYXJyYXkoIDUsIDEwKSwgYXJyYXkoMTksIDEwKSwgYXJyYXkoMTUsIDI1KSwgYXJyYXkoMjMsIDI1KSksIC8vIDMwCgkJYXJyYXkoYXJyYXkoMTMsICAzKSwgYXJyYXkoIDIsIDI5KSwgYXJyYXkoNDIsICAxKSwgYXJyYXkoMjMsIDI4KSksIC8vCgkJYXJyYXkoYXJyYXkoMTcsICAwKSwgYXJyYXkoMTAsIDIzKSwgYXJyYXkoMTAsIDM1KSwgYXJyYXkoMTksIDM1KSksIC8vCgkJYXJyYXkoYXJyYXkoMTcsICAxKSwgYXJyYXkoMTQsIDIxKSwgYXJyYXkoMjksIDE5KSwgYXJyYXkoMTEsIDQ2KSksIC8vCgkJYXJyYXkoYXJyYXkoMTMsICA2KSwgYXJyYXkoMTQsIDIzKSwgYXJyYXkoNDQsICA3KSwgYXJyYXkoNTksICAxKSksIC8vCgkJYXJyYXkoYXJyYXkoMTIsICA3KSwgYXJyYXkoMTIsIDI2KSwgYXJyYXkoMzksIDE0KSwgYXJyYXkoMjIsIDQxKSksIC8vIDM1CgkJYXJyYXkoYXJyYXkoIDYsIDE0KSwgYXJyYXkoIDYsIDM0KSwgYXJyYXkoNDYsIDEwKSwgYXJyYXkoIDIsIDY0KSksIC8vCgkJYXJyYXkoYXJyYXkoMTcsICA0KSwgYXJyYXkoMjksIDE0KSwgYXJyYXkoNDksIDEwKSwgYXJyYXkoMjQsIDQ2KSksIC8vCgkJYXJyYXkoYXJyYXkoIDQsIDE4KSwgYXJyYXkoMTMsIDMyKSwgYXJyYXkoNDgsIDE0KSwgYXJyYXkoNDIsIDMyKSksIC8vCgkJYXJyYXkoYXJyYXkoMjAsICA0KSwgYXJyYXkoNDAsICA3KSwgYXJyYXkoNDMsIDIyKSwgYXJyYXkoMTAsIDY3KSksIC8vCgkJYXJyYXkoYXJyYXkoMTksICA2KSwgYXJyYXkoMTgsIDMxKSwgYXJyYXkoMzQsIDM0KSwgYXJyYXkoMjAsIDYxKSkgIC8vIDQwCgkpOwoKCS8qKgoJICogQXJyYXkgUG9zaXRpb25zIG9mIGFsaWdubWVudCBwYXR0ZXJucy4KCSAqIFRoaXMgYXJyYXkgaW5jbHVkZXMgb25seSB0aGUgc2Vjb25kIGFuZCB0aGUgdGhpcmQgcG9zaXRpb24gb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJucy4gUmVzdCBvZiB0aGVtIGNhbiBiZSBjYWxjdWxhdGVkIGZyb20gdGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlbS4KCSAqIFNlZSBUYWJsZSAxIGluIEFwcGVuZGl4IEUgKHBwLjcxKSBvZiBKSVMgWDA1MTA6MjAwNC4KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRhbGlnbm1lbnRQYXR0ZXJuID0gYXJyYXkoCgkJYXJyYXkoIDAsICAwKSwKCQlhcnJheSggMCwgIDApLCBhcnJheSgxOCwgIDApLCBhcnJheSgyMiwgIDApLCBhcnJheSgyNiwgIDApLCBhcnJheSgzMCwgIDApLCAvLyAgMS0gNQoJCWFycmF5KDM0LCAgMCksIGFycmF5KDIyLCAzOCksIGFycmF5KDI0LCA0MiksIGFycmF5KDI2LCA0NiksIGFycmF5KDI4LCA1MCksIC8vICA2LTEwCgkJYXJyYXkoMzAsIDU0KSwgYXJyYXkoMzIsIDU4KSwgYXJyYXkoMzQsIDYyKSwgYXJyYXkoMjYsIDQ2KSwgYXJyYXkoMjYsIDQ4KSwgLy8gMTEtMTUKCQlhcnJheSgyNiwgNTApLCBhcnJheSgzMCwgNTQpLCBhcnJheSgzMCwgNTYpLCBhcnJheSgzMCwgNTgpLCBhcnJheSgzNCwgNjIpLCAvLyAxNi0yMAoJCWFycmF5KDI4LCA1MCksIGFycmF5KDI2LCA1MCksIGFycmF5KDMwLCA1NCksIGFycmF5KDI4LCA1NCksIGFycmF5KDMyLCA1OCksIC8vIDIxLTI1CgkJYXJyYXkoMzAsIDU4KSwgYXJyYXkoMzQsIDYyKSwgYXJyYXkoMjYsIDUwKSwgYXJyYXkoMzAsIDU0KSwgYXJyYXkoMjYsIDUyKSwgLy8gMjYtMzAKCQlhcnJheSgzMCwgNTYpLCBhcnJheSgzNCwgNjApLCBhcnJheSgzMCwgNTgpLCBhcnJheSgzNCwgNjIpLCBhcnJheSgzMCwgNTQpLCAvLyAzMS0zNQoJCWFycmF5KDI0LCA1MCksIGFycmF5KDI4LCA1NCksIGFycmF5KDMyLCA1OCksIGFycmF5KDI2LCA1NCksIGFycmF5KDMwLCA1OCkgIC8vIDM1LTQwCgkpOwoKCS8qKgoJICogQXJyYXkgVmVyc2lvbiBpbmZvcm1hdGlvbiBwYXR0ZXJuIChCQ0ggY29kZWQpLgoJICogU2VlIFRhYmxlIDEgaW4gQXBwZW5kaXggRCAocHAuNjgpIG9mIEpJUyBYMDUxMDoyMDA0LgoJICogc2l6ZTogW1FSU1BFQ19WRVJTSU9OX01BWCAtIDZdCgkgKiBAcHJvdGVjdGVkCgkgKi8KCXByb3RlY3RlZCAkdmVyc2lvblBhdHRlcm4gPSBhcnJheSgKCQkweDA3Yzk0LCAweDA4NWJjLCAweDA5YTk5LCAweDBhNGQzLCAweDBiYmY2LCAweDBjNzYyLCAweDBkODQ3LCAweDBlNjBkLCAvLwoJCTB4MGY5MjgsIDB4MTBiNzgsIDB4MTE0NWQsIDB4MTJhMTcsIDB4MTM1MzIsIDB4MTQ5YTYsIDB4MTU2ODMsIDB4MTY4YzksIC8vCgkJMHgxNzdlYywgMHgxOGVjNCwgMHgxOTFlMSwgMHgxYWZhYiwgMHgxYjA4ZSwgMHgxY2MxYSwgMHgxZDMzZiwgMHgxZWQ3NSwgLy8KCQkweDFmMjUwLCAweDIwOWQ1LCAweDIxNmYwLCAweDIyOGJhLCAweDIzNzlmLCAweDI0YjBiLCAweDI1NDJlLCAweDI2YTY0LCAvLwoJCTB4Mjc1NDEsIDB4MjhjNjkKCSk7CgoJLyoqCgkgKiBBcnJheSBGb3JtYXQgaW5mb3JtYXRpb24KCSAqIEBwcm90ZWN0ZWQKCSAqLwoJcHJvdGVjdGVkICRmb3JtYXRJbmZvID0gYXJyYXkoCgkJYXJyYXkoMHg3N2M0LCAweDcyZjMsIDB4N2RhYSwgMHg3ODlkLCAweDY2MmYsIDB4NjMxOCwgMHg2YzQxLCAweDY5NzYpLCAvLwoJCWFycmF5KDB4NTQxMiwgMHg1MTI1LCAweDVlN2MsIDB4NWI0YiwgMHg0NWY5LCAweDQwY2UsIDB4NGY5NywgMHg0YWEwKSwgLy8KCQlhcnJheSgweDM1NWYsIDB4MzA2OCwgMHgzZjMxLCAweDNhMDYsIDB4MjRiNCwgMHgyMTgzLCAweDJlZGEsIDB4MmJlZCksIC8vCgkJYXJyYXkoMHgxNjg5LCAweDEzYmUsIDB4MWNlNywgMHgxOWQwLCAweDA3NjIsIDB4MDI1NSwgMHgwZDBjLCAweDA4M2IpICAvLwoJKTsKCgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCgkvKioKCSAqIFRoaXMgaXMgdGhlIGNsYXNzIGNvbnN0cnVjdG9yLgoJICogQ3JlYXRlcyBhIFFSY29kZSBvYmplY3QKCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQgdXNpbmcgUVJjb2RlCgkgKiBAcGFyYW0gc3RyaW5nICRlY2xldmVsIGVycm9yIGxldmVsOiA8dWw+PGxpPkwgOiBBYm91dCA3JSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLjwvbGk+PGxpPk0gOiBBYm91dCAxNSUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC48L2xpPjxsaT5RIDogQWJvdXQgMjUlIG9yIGxlc3MgZXJyb3JzIGNhbiBiZSBjb3JyZWN0ZWQuPC9saT48bGk+SCA6IEFib3V0IDMwJSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLjwvbGk+PC91bD4KCSAqIEBwdWJsaWMKCSAqIEBzaW5jZSAxLjAuMDAwCgkgKi8KCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29kZSwgJGVjbGV2ZWwgPSAnTCcpIHsKCQkkYmFyY29kZV9hcnJheSA9IGFycmF5KCk7CgkJaWYgKChpc19udWxsKCRjb2RlKSkgT1IgKCRjb2RlID09ICdcMCcpIE9SICgkY29kZSA9PSAnJykpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQkvLyBzZXQgZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJCSR0aGlzLT5sZXZlbCA9IGFycmF5X3NlYXJjaCgkZWNsZXZlbCwgYXJyYXkoJ0wnLCAnTScsICdRJywgJ0gnKSk7CgkJaWYgKCR0aGlzLT5sZXZlbCA9PT0gZmFsc2UpIHsKCQkJJHRoaXMtPmxldmVsID0gUVJfRUNMRVZFTF9MOwoJCX0KCQlpZiAoKCR0aGlzLT5oaW50ICE9IFFSX01PREVfOEIpIEFORCAoJHRoaXMtPmhpbnQgIT0gUVJfTU9ERV9LSikpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlpZiAoKCR0aGlzLT52ZXJzaW9uIDwgMCkgT1IgKCR0aGlzLT52ZXJzaW9uID4gUVJTUEVDX1ZFUlNJT05fTUFYKSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCSR0aGlzLT5pdGVtcyA9IGFycmF5KCk7CgkJJHRoaXMtPmVuY29kZVN0cmluZygkY29kZSk7CgkJaWYgKGlzX251bGwoJHRoaXMtPmRhdGEpKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJJHFyVGFiID0gJHRoaXMtPmJpbmFyaXplKCR0aGlzLT5kYXRhKTsKCQkkc2l6ZSA9IGNvdW50KCRxclRhYik7CgkJJGJhcmNvZGVfYXJyYXlbJ251bV9yb3dzJ10gPSAkc2l6ZTsKCQkkYmFyY29kZV9hcnJheVsnbnVtX2NvbHMnXSA9ICRzaXplOwoJCSRiYXJjb2RlX2FycmF5WydiY29kZSddID0gYXJyYXkoKTsKCQlmb3JlYWNoICgkcXJUYWIgYXMgJGxpbmUpIHsKCQkJJGFyckFkZCA9IGFycmF5KCk7CgkJCWZvcmVhY2ggKHN0cl9zcGxpdCgkbGluZSkgYXMgJGNoYXIpIHsKCQkJCSRhcnJBZGRbXSA9ICgkY2hhcj09JzEnKT8xOjA7CgkJCX0KCQkJJGJhcmNvZGVfYXJyYXlbJ2Jjb2RlJ11bXSA9ICRhcnJBZGQ7CgkJfQoJCSR0aGlzLT5iYXJjb2RlX2FycmF5ID0gJGJhcmNvZGVfYXJyYXk7Cgl9CgoJLyoqCgkgKiBSZXR1cm5zIGEgYmFyY29kZSBhcnJheSB3aGljaCBpcyByZWFkYWJsZSBieSBUQ1BERgoJICogQHJldHVybiBhcnJheSBiYXJjb2RlIGFycmF5IHJlYWRhYmxlIGJ5IFRDUERGOwoJICogQHB1YmxpYwoJICovCglwdWJsaWMgZnVuY3Rpb24gZ2V0QmFyY29kZUFycmF5KCkgewoJCXJldHVybiAkdGhpcy0+YmFyY29kZV9hcnJheTsKCX0KCgkvKioKCSAqIENvbnZlcnQgdGhlIGZyYW1lIGluIGJpbmFyeSBmb3JtCgkgKiBAcGFyYW0gYXJyYXkgJGZyYW1lIGFycmF5IHRvIGJpbmFyaXplCgkgKiBAcmV0dXJuIGFycmF5IGZyYW1lIGluIGJpbmFyeSBmb3JtCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBiaW5hcml6ZSgkZnJhbWUpIHsKCQkkbGVuID0gY291bnQoJGZyYW1lKTsKCQkvLyB0aGUgZnJhbWUgaXMgc3F1YXJlICh3aWR0aCA9IGhlaWdodCkKCQlmb3JlYWNoICgkZnJhbWUgYXMgJiRmcmFtZUxpbmUpIHsKCQkJZm9yICgkaT0wOyAkaTwkbGVuOyAkaSsrKSB7CgkJCQkkZnJhbWVMaW5lWyRpXSA9IChvcmQoJGZyYW1lTGluZVskaV0pJjEpPycxJzonMCc7CgkJCX0KCQl9CgkJcmV0dXJuICRmcmFtZTsKCX0KCgkvKioKCSAqIEVuY29kZSB0aGUgaW5wdXQgc3RyaW5nIHRvIFFSIGNvZGUKCSAqIEBwYXJhbSBzdHJpbmcgJHN0cmluZyBpbnB1dCBzdHJpbmcgdG8gZW5jb2RlCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVTdHJpbmcoJHN0cmluZykgewoJCSR0aGlzLT5kYXRhU3RyID0gJHN0cmluZzsKCQlpZiAoISR0aGlzLT5jYXNlc2Vuc2l0aXZlKSB7CgkJCSR0aGlzLT50b1VwcGVyKCk7CgkJfQoJCSRyZXQgPSAkdGhpcy0+c3BsaXRTdHJpbmcoKTsKCQlpZiAoJHJldCA8IDApIHsKCQkJcmV0dXJuIE5VTEw7CgkJfQoJCSR0aGlzLT5lbmNvZGVNYXNrKC0xKTsKCX0KCgkvKioKCSAqIEVuY29kZSBtYXNrCgkgKiBAcGFyYW0gaW50ICRtYXNrIG1hc2tpbmcgbW9kZQoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZW5jb2RlTWFzaygkbWFzaykgewoJCSRzcGVjID0gYXJyYXkoMCwgMCwgMCwgMCwgMCk7CgkJJHRoaXMtPmRhdGFjb2RlID0gJHRoaXMtPmdldEJ5dGVTdHJlYW0oJHRoaXMtPml0ZW1zKTsKCgkJaWYgKGlzX251bGwoJHRoaXMtPmRhdGFjb2RlKSkgewoJCQlyZXR1cm4gTlVMTDsKCQl9CgkJJHNwZWMgPSAkdGhpcy0+Z2V0RWNjU3BlYygkdGhpcy0+dmVyc2lvbiwgJHRoaXMtPmxldmVsLCAkc3BlYyk7CgkJJHRoaXMtPmIxID0gJHRoaXMtPnJzQmxvY2tOdW0xKCRzcGVjKTsKCQkkdGhpcy0+ZGF0YUxlbmd0aCA9ICR0aGlzLT5yc0RhdGFMZW5ndGgoJHNwZWMpOwoJCSR0aGlzLT5lY2NMZW5ndGggPSAkdGhpcy0+cnNFY2NMZW5ndGgoJHNwZWMpOwoJCSR0aGlzLT5lY2Njb2RlID0gYXJyYXlfZmlsbCgwLCAkdGhpcy0+ZWNjTGVuZ3RoLCAwKTsKCQkkdGhpcy0+YmxvY2tzID0gJHRoaXMtPnJzQmxvY2tOdW0oJHNwZWMpOwoJCSRyZXQgPSAkdGhpcy0+aW5pdCgkc3BlYyk7CgkJaWYgKCRyZXQgPCAwKSB7CgkJCXJldHVybiBOVUxMOwoJCX0KCQkkdGhpcy0+Y291bnQgPSAwOwoJCSR0aGlzLT53aWR0aCA9ICR0aGlzLT5nZXRXaWR0aCgkdGhpcy0+dmVyc2lvbik7CgkJJHRoaXMtPmZyYW1lID0gJHRoaXMtPm5ld0ZyYW1lKCR0aGlzLT52ZXJzaW9uKTsKCQkkdGhpcy0+eCA9ICR0aGlzLT53aWR0aCAtIDE7CgkJJHRoaXMtPnkgPSAkdGhpcy0+d2lkdGggLSAxOwoJCSR0aGlzLT5kaXIgPSAtMTsKCQkkdGhpcy0+Yml0ID0gLTE7CgkJLy8gaW50ZWxlYXZlZCBkYXRhIGFuZCBlY2MgY29kZXMKCQlmb3IgKCRpPTA7ICRpIDwgKCR0aGlzLT5kYXRhTGVuZ3RoICsgJHRoaXMtPmVjY0xlbmd0aCk7ICRpKyspIHsKCQkJJGNvZGUgPSAkdGhpcy0+Z2V0Q29kZSgpOwoJCQkkYml0ID0gMHg4MDsKCQkJZm9yICgkaj0wOyAkajw4OyAkaisrKSB7CgkJCQkkYWRkciA9ICR0aGlzLT5nZXROZXh0UG9zaXRpb24oKTsKCQkJCSR0aGlzLT5zZXRGcmFtZUF0KCRhZGRyLCAweDAyIHwgKCgkYml0ICYgJGNvZGUpICE9IDApKTsKCQkJCSRiaXQgPSAkYml0ID4+IDE7CgkJCX0KCQl9CgkJLy8gcmVtYWluZGVyIGJpdHMKCQkkaiA9ICR0aGlzLT5nZXRSZW1haW5kZXIoJHRoaXMtPnZlcnNpb24pOwoJCWZvciAoJGk9MDsgJGk8JGo7ICRpKyspIHsKCQkJJGFkZHIgPSAkdGhpcy0+Z2V0TmV4dFBvc2l0aW9uKCk7CgkJCSR0aGlzLT5zZXRGcmFtZUF0KCRhZGRyLCAweDAyKTsKCQl9CgkJLy8gbWFza2luZwoJCSR0aGlzLT5ydW5MZW5ndGggPSBhcnJheV9maWxsKDAsIFFSU1BFQ19XSURUSF9NQVggKyAxLCAwKTsKCQlpZiAoJG1hc2sgPCAwKSB7CgkJCWlmIChRUl9GSU5EX0JFU1RfTUFTSykgewoJCQkJJG1hc2tlZCA9ICR0aGlzLT5tYXNrKCR0aGlzLT53aWR0aCwgJHRoaXMtPmZyYW1lLCAkdGhpcy0+bGV2ZWwpOwoJCQl9IGVsc2UgewoJCQkJJG1hc2tlZCA9ICR0aGlzLT5tYWtlTWFzaygkdGhpcy0+d2lkdGgsICR0aGlzLT5mcmFtZSwgKGludHZhbChRUl9ERUZBVUxUX01BU0spICUgOCksICR0aGlzLT5sZXZlbCk7CgkJCX0KCQl9IGVsc2UgewoJCQkkbWFza2VkID0gJHRoaXMtPm1ha2VNYXNrKCR0aGlzLT53aWR0aCwgJHRoaXMtPmZyYW1lLCAkbWFzaywgJHRoaXMtPmxldmVsKTsKCQl9CgkJaWYgKCRtYXNrZWQgPT0gTlVMTCkgewoJCQlyZXR1cm4gTlVMTDsKCQl9CgkJJHRoaXMtPmRhdGEgPSAkbWFza2VkOwoJfQoKCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkvLyBGcmFtZUZpbGxlcgoKCS8qKgoJICogU2V0IGZyYW1lIHZhbHVlIGF0IHNwZWNpZmllZCBwb3NpdGlvbgoJICogQHBhcmFtIGFycmF5ICRhdCB4LHkgcG9zaXRpb24KCSAqIEBwYXJhbSBpbnQgJHZhbCB2YWx1ZSBvZiB0aGUgY2hhcmFjdGVyIHRvIHNldAoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gc2V0RnJhbWVBdCgkYXQsICR2YWwpIHsKCQkkdGhpcy0+ZnJhbWVbJGF0Wyd5J11dWyRhdFsneCddXSA9IGNocigkdmFsKTsKCX0KCgkvKioKCSAqIEdldCBmcmFtZSB2YWx1ZSBhdCBzcGVjaWZpZWQgcG9zaXRpb24KCSAqIEBwYXJhbSBhcnJheSAkYXQgeCx5IHBvc2l0aW9uCgkgKiBAcmV0dXJuIHZhbHVlIGF0IHNwZWNpZmllZCBwb3NpdGlvbgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0RnJhbWVBdCgkYXQpIHsKCQlyZXR1cm4gb3JkKCR0aGlzLT5mcmFtZVskYXRbJ3knXV1bJGF0Wyd4J11dKTsKCX0KCgkvKioKCSAqIFJldHVybiB0aGUgbmV4dCBmcmFtZSBwb3NpdGlvbgoJICogQHJldHVybiBhcnJheSBvZiB4LHkgY29vcmRpbmF0ZXMKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldE5leHRQb3NpdGlvbigpIHsKCQlkbyB7CgkJCWlmICgkdGhpcy0+Yml0ID09IC0xKSB7CgkJCQkkdGhpcy0+Yml0ID0gMDsKCQkJCXJldHVybiBhcnJheSgneCc9PiR0aGlzLT54LCAneSc9PiR0aGlzLT55KTsKCQkJfQoJCQkkeCA9ICR0aGlzLT54OwoJCQkkeSA9ICR0aGlzLT55OwoJCQkkdyA9ICR0aGlzLT53aWR0aDsKCQkJaWYgKCR0aGlzLT5iaXQgPT0gMCkgewoJCQkJJHgtLTsKCQkJCSR0aGlzLT5iaXQrKzsKCQkJfSBlbHNlIHsKCQkJCSR4Kys7CgkJCQkkeSArPSAkdGhpcy0+ZGlyOwoJCQkJJHRoaXMtPmJpdC0tOwoJCQl9CgkJCWlmICgkdGhpcy0+ZGlyIDwgMCkgewoJCQkJaWYgKCR5IDwgMCkgewoJCQkJCSR5ID0gMDsKCQkJCQkkeCAtPSAyOwoJCQkJCSR0aGlzLT5kaXIgPSAxOwoJCQkJCWlmICgkeCA9PSA2KSB7CgkJCQkJCSR4LS07CgkJCQkJCSR5ID0gOTsKCQkJCQl9CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlpZiAoJHkgPT0gJHcpIHsKCQkJCQkkeSA9ICR3IC0gMTsKCQkJCQkkeCAtPSAyOwoJCQkJCSR0aGlzLT5kaXIgPSAtMTsKCQkJCQlpZiAoJHggPT0gNikgewoJCQkJCQkkeC0tOwoJCQkJCQkkeSAtPSA4OwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlpZiAoKCR4IDwgMCkgT1IgKCR5IDwgMCkpIHsKCQkJCXJldHVybiBOVUxMOwoJCQl9CgkJCSR0aGlzLT54ID0gJHg7CgkJCSR0aGlzLT55ID0gJHk7CgkJfSB3aGlsZShvcmQoJHRoaXMtPmZyYW1lWyR5XVskeF0pICYgMHg4MCk7CgkJcmV0dXJuIGFycmF5KCd4Jz0+JHgsICd5Jz0+JHkpOwoJfQoKCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkvLyBRUnJhd2NvZGUKCgkvKioKCSAqIEluaXRpYWxpemUgY29kZS4KCSAqIEBwYXJhbSBhcnJheSAkc3BlYyBhcnJheSBvZiBFQ0Mgc3BlY2lmaWNhdGlvbgoJICogQHJldHVybiBpbnQgMCBpbiBjYXNlIG9mIHN1Y2Nlc3MsIC0xIGluIGNhc2Ugb2YgZXJyb3IKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGluaXQoJHNwZWMpIHsKCQkkZGwgPSAkdGhpcy0+cnNEYXRhQ29kZXMxKCRzcGVjKTsKCQkkZWwgPSAkdGhpcy0+cnNFY2NDb2RlczEoJHNwZWMpOwoJCSRycyA9ICR0aGlzLT5pbml0X3JzKDgsIDB4MTFkLCAwLCAxLCAkZWwsIDI1NSAtICRkbCAtICRlbCk7CgkJJGJsb2NrTm8gPSAwOwoJCSRkYXRhUG9zID0gMDsKCQkkZWNjUG9zID0gMDsKCQkkZW5kZm9yID0gJHRoaXMtPnJzQmxvY2tOdW0xKCRzcGVjKTsKCQlmb3IgKCRpPTA7ICRpIDwgJGVuZGZvcjsgKyskaSkgewoJCQkkZWNjID0gYXJyYXlfc2xpY2UoJHRoaXMtPmVjY2NvZGUsICRlY2NQb3MpOwoJCQkkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dID0gYXJyYXkoKTsKCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZGF0YUxlbmd0aCddID0gJGRsOwoJCQkkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dWydkYXRhJ10gPSBhcnJheV9zbGljZSgkdGhpcy0+ZGF0YWNvZGUsICRkYXRhUG9zKTsKCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZWNjTGVuZ3RoJ10gPSAkZWw7CgkJCSRlY2MgPSAkdGhpcy0+ZW5jb2RlX3JzX2NoYXIoJHJzLCAkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dWydkYXRhJ10sICRlY2MpOwoJCQkkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dWydlY2MnXSA9ICRlY2M7CgkJCSR0aGlzLT5lY2Njb2RlID0gYXJyYXlfbWVyZ2UoYXJyYXlfc2xpY2UoJHRoaXMtPmVjY2NvZGUsMCwgJGVjY1BvcyksICRlY2MpOwoJCQkkZGF0YVBvcyArPSAkZGw7CgkJCSRlY2NQb3MgKz0gJGVsOwoJCQkkYmxvY2tObysrOwoJCX0KCQlpZiAoJHRoaXMtPnJzQmxvY2tOdW0yKCRzcGVjKSA9PSAwKSB7CgkJCXJldHVybiAwOwoJCX0KCQkkZGwgPSAkdGhpcy0+cnNEYXRhQ29kZXMyKCRzcGVjKTsKCQkkZWwgPSAkdGhpcy0+cnNFY2NDb2RlczIoJHNwZWMpOwoJCSRycyA9ICR0aGlzLT5pbml0X3JzKDgsIDB4MTFkLCAwLCAxLCAkZWwsIDI1NSAtICRkbCAtICRlbCk7CgkJaWYgKCRycyA9PSBOVUxMKSB7CgkJCXJldHVybiAtMTsKCQl9CgkJJGVuZGZvciA9ICR0aGlzLT5yc0Jsb2NrTnVtMigkc3BlYyk7CgkJZm9yICgkaT0wOyAkaSA8ICRlbmRmb3I7ICsrJGkpIHsKCQkJJGVjYyA9IGFycmF5X3NsaWNlKCR0aGlzLT5lY2Njb2RlLCAkZWNjUG9zKTsKCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXSA9IGFycmF5KCk7CgkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2RhdGFMZW5ndGgnXSA9ICRkbDsKCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZGF0YSddID0gYXJyYXlfc2xpY2UoJHRoaXMtPmRhdGFjb2RlLCAkZGF0YVBvcyk7CgkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2VjY0xlbmd0aCddID0gJGVsOwoJCQkkZWNjID0gJHRoaXMtPmVuY29kZV9yc19jaGFyKCRycywgJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZGF0YSddLCAkZWNjKTsKCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZWNjJ10gPSAkZWNjOwoJCQkkdGhpcy0+ZWNjY29kZSA9IGFycmF5X21lcmdlKGFycmF5X3NsaWNlKCR0aGlzLT5lY2Njb2RlLCAwLCAkZWNjUG9zKSwgJGVjYyk7CgkJCSRkYXRhUG9zICs9ICRkbDsKCQkJJGVjY1BvcyArPSAkZWw7CgkJCSRibG9ja05vKys7CgkJfQoJCXJldHVybiAwOwoJfQoKCS8qKgoJICogUmV0dXJuIFJlZWQtU29sb21vbiBibG9jayBjb2RlLgoJICogQHJldHVybiBhcnJheSByc2Jsb2NrcwoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0Q29kZSgpIHsKCQlpZiAoJHRoaXMtPmNvdW50IDwgJHRoaXMtPmRhdGFMZW5ndGgpIHsKCQkJJHJvdyA9ICR0aGlzLT5jb3VudCAlICR0aGlzLT5ibG9ja3M7CgkJCSRjb2wgPSAoaW50KSgkdGhpcy0+Y291bnQgLyAkdGhpcy0+YmxvY2tzKTsKCQkJaWYgKCRjb2wgPj0gJHRoaXMtPnJzYmxvY2tzWzBdWydkYXRhTGVuZ3RoJ10pIHsKCQkJCSRyb3cgKz0gJHRoaXMtPmIxOwoJCQl9CgkJCSRyb3cgPSAoaW50KSAkcm93OwoJCQkkcmV0ID0gJHRoaXMtPnJzYmxvY2tzWyRyb3ddWydkYXRhJ11bJGNvbF07CgkJfSBlbHNlaWYgKCR0aGlzLT5jb3VudCA8ICR0aGlzLT5kYXRhTGVuZ3RoICsgJHRoaXMtPmVjY0xlbmd0aCkgewoJCQkkcm93ID0gKCR0aGlzLT5jb3VudCAtICR0aGlzLT5kYXRhTGVuZ3RoKSAlICR0aGlzLT5ibG9ja3M7CgkJCSRjb2wgPSAoaW50KSgoJHRoaXMtPmNvdW50IC0gJHRoaXMtPmRhdGFMZW5ndGgpIC8gJHRoaXMtPmJsb2Nrcyk7CgkJCSRyZXQgPSAkdGhpcy0+cnNibG9ja3NbJHJvd11bJ2VjYyddWyRjb2xdOwoJCX0gZWxzZSB7CgkJCXJldHVybiAwOwoJCX0KCQkkdGhpcy0+Y291bnQrKzsKCQlyZXR1cm4gJHJldDsKCX0KCgkvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCgoJLy8gUVJtYXNrCgoJLyoqCgkgKiBXcml0ZSBGb3JtYXQgSW5mb3JtYXRpb24gb24gZnJhbWUgYW5kIHJldHVybnMgdGhlIG51bWJlciBvZiBibGFjayBiaXRzCgkgKiBAcGFyYW0gaW50ICR3aWR0aCBmcmFtZSB3aWR0aAoJICogQHBhcmFtIGFycmF5ICRmcmFtZSBmcmFtZQoJICogQHBhcmFtIGFycmF5ICRtYXNrIG1hc2tpbmcgbW9kZQoJICogQHBhcmFtIGludCAkbGV2ZWwgZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICogQHJldHVybiBpbnQgYmxhY2tzCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gd3JpdGVGb3JtYXRJbmZvcm1hdGlvbigkd2lkdGgsICYkZnJhbWUsICRtYXNrLCAkbGV2ZWwpIHsKCQkkYmxhY2tzID0gMDsKCQkkZm9ybWF0ID0gICR0aGlzLT5nZXRGb3JtYXRJbmZvKCRtYXNrLCAkbGV2ZWwpOwoJCWZvciAoJGk9MDsgJGk8ODsgKyskaSkgewoJCQlpZiAoJGZvcm1hdCAmIDEpIHsKCQkJCSRibGFja3MgKz0gMjsKCQkJCSR2ID0gMHg4NTsKCQkJfSBlbHNlIHsKCQkJCSR2ID0gMHg4NDsKCQkJfQoJCQkkZnJhbWVbOF1bJHdpZHRoIC0gMSAtICRpXSA9IGNocigkdik7CgkJCWlmICgkaSA8IDYpIHsKCQkJCSRmcmFtZVskaV1bOF0gPSBjaHIoJHYpOwoJCQl9IGVsc2UgewoJCQkJJGZyYW1lWyRpICsgMV1bOF0gPSBjaHIoJHYpOwoJCQl9CgkJCSRmb3JtYXQgPSAkZm9ybWF0ID4+IDE7CgkJfQoJCWZvciAoJGk9MDsgJGk8NzsgKyskaSkgewoJCWlmICgkZm9ybWF0ICYgMSkgewoJCQkkYmxhY2tzICs9IDI7CgkJCSR2ID0gMHg4NTsKCQl9IGVsc2UgewoJCQkkdiA9IDB4ODQ7CgkJfQoJCSRmcmFtZVskd2lkdGggLSA3ICsgJGldWzhdID0gY2hyKCR2KTsKCQlpZiAoJGkgPT0gMCkgewoJCQkkZnJhbWVbOF1bN10gPSBjaHIoJHYpOwoJCX0gZWxzZSB7CgkJCSRmcmFtZVs4XVs2IC0gJGldID0gY2hyKCR2KTsKCQl9CgkJJGZvcm1hdCA9ICRmb3JtYXQgPj4gMTsKCQl9CgkJcmV0dXJuICRibGFja3M7Cgl9CgoJLyoqCgkgKiBtYXNrMAoJICogQHBhcmFtIGludCAkeCBYIHBvc2l0aW9uCgkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCSAqIEByZXR1cm4gaW50IG1hc2sKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrMCgkeCwgJHkpIHsKCQlyZXR1cm4gKCR4ICsgJHkpICYgMTsKCX0KCgkvKioKCSAqIG1hc2sxCgkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJICogQHJldHVybiBpbnQgbWFzawoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2sxKCR4LCAkeSkgewoJCXJldHVybiAoJHkgJiAxKTsKCX0KCgkvKioKCSAqIG1hc2syCgkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJICogQHJldHVybiBpbnQgbWFzawoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2syKCR4LCAkeSkgewoJCXJldHVybiAoJHggJSAzKTsKCX0KCgkvKioKCSAqIG1hc2szCgkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJICogQHJldHVybiBpbnQgbWFzawoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2szKCR4LCAkeSkgewoJCXJldHVybiAoJHggKyAkeSkgJSAzOwoJfQoKCS8qKgoJICogbWFzazQKCSAqIEBwYXJhbSBpbnQgJHggWCBwb3NpdGlvbgoJICogQHBhcmFtIGludCAkeSBZIHBvc2l0aW9uCgkgKiBAcmV0dXJuIGludCBtYXNrCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWFzazQoJHgsICR5KSB7CgkJcmV0dXJuICgoKGludCkoJHkgLyAyKSkgKyAoKGludCkoJHggLyAzKSkpICYgMTsKCX0KCgkvKioKCSAqIG1hc2s1CgkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJICogQHJldHVybiBpbnQgbWFzawoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2s1KCR4LCAkeSkgewoJCXJldHVybiAoKCR4ICogJHkpICYgMSkgKyAoJHggKiAkeSkgJSAzOwoJfQoKCS8qKgoJICogbWFzazYKCSAqIEBwYXJhbSBpbnQgJHggWCBwb3NpdGlvbgoJICogQHBhcmFtIGludCAkeSBZIHBvc2l0aW9uCgkgKiBAcmV0dXJuIGludCBtYXNrCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWFzazYoJHgsICR5KSB7CgkJcmV0dXJuICgoKCR4ICogJHkpICYgMSkgKyAoJHggKiAkeSkgJSAzKSAmIDE7Cgl9CgoJLyoqCgkgKiBtYXNrNwoJICogQHBhcmFtIGludCAkeCBYIHBvc2l0aW9uCgkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCSAqIEByZXR1cm4gaW50IG1hc2sKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrNygkeCwgJHkpIHsKCQlyZXR1cm4gKCgoJHggKiAkeSkgJSAzKSArICgoJHggKyAkeSkgJiAxKSkgJiAxOwoJfQoKCS8qKgoJICogUmV0dXJuIGJpdG1hc2sKCSAqIEBwYXJhbSBpbnQgJG1hc2tObyBtYXNrIG51bWJlcgoJICogQHBhcmFtIGludCAkd2lkdGggd2lkdGgKCSAqIEBwYXJhbSBhcnJheSAkZnJhbWUgZnJhbWUKCSAqIEByZXR1cm4gYXJyYXkgYml0bWFzawoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2VuZXJhdGVNYXNrTm8oJG1hc2tObywgJHdpZHRoLCAkZnJhbWUpIHsKCQkkYml0TWFzayA9IGFycmF5X2ZpbGwoMCwgJHdpZHRoLCBhcnJheV9maWxsKDAsICR3aWR0aCwgMCkpOwoJCWZvciAoJHk9MDsgJHk8JHdpZHRoOyArKyR5KSB7CgkJCWZvciAoJHg9MDsgJHg8JHdpZHRoOyArKyR4KSB7CgkJCQlpZiAob3JkKCRmcmFtZVskeV1bJHhdKSAmIDB4ODApIHsKCQkJCQkkYml0TWFza1skeV1bJHhdID0gMDsKCQkJCX0gZWxzZSB7CgkJCQkJJG1hc2tGdW5jID0gY2FsbF91c2VyX2Z1bmMoYXJyYXkoJHRoaXMsICdtYXNrJy4kbWFza05vKSwgJHgsICR5KTsKCQkJCQkkYml0TWFza1skeV1bJHhdID0gKCRtYXNrRnVuYyA9PSAwKT8xOjA7CgkJCQl9CgkJCX0KCQl9CgkJcmV0dXJuICRiaXRNYXNrOwoJfQoKCS8qKgoJICogbWFrZU1hc2tObwoJICogQHBhcmFtIGludCAkbWFza05vCgkgKiBAcGFyYW0gaW50ICR3aWR0aAoJICogQHBhcmFtIGludCAkcwoJICogQHBhcmFtIGludCAkZAoJICogQHBhcmFtIGJvb2xlYW4gJG1hc2tHZW5Pbmx5CgkgKiBAcmV0dXJuIGludCBiCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWFrZU1hc2tObygkbWFza05vLCAkd2lkdGgsICRzLCAmJGQsICRtYXNrR2VuT25seT1mYWxzZSkgewoJCSRiID0gMDsKCQkkYml0TWFzayA9IGFycmF5KCk7CgkJJGJpdE1hc2sgPSAkdGhpcy0+Z2VuZXJhdGVNYXNrTm8oJG1hc2tObywgJHdpZHRoLCAkcyk7CgkJaWYgKCRtYXNrR2VuT25seSkgewoJCQlyZXR1cm47CgkJfQoJCSRkID0gJHM7CgkJZm9yICgkeT0wOyAkeTwkd2lkdGg7ICsrJHkpIHsKCQkJZm9yICgkeD0wOyAkeDwkd2lkdGg7ICsrJHgpIHsKCQkJCWlmICgkYml0TWFza1skeV1bJHhdID09IDEpIHsKCQkJCQkkZFskeV1bJHhdID0gY2hyKG9yZCgkc1skeV1bJHhdKSBeICgoaW50KSgkYml0TWFza1skeV1bJHhdKSkpOwoJCQkJfQoJCQkJJGIgKz0gKGludCkob3JkKCRkWyR5XVskeF0pICYgMSk7CgkJCX0KCQl9CgkJcmV0dXJuICRiOwoJfQoKCS8qKgoJICogbWFrZU1hc2sKCSAqIEBwYXJhbSBpbnQgJHdpZHRoCgkgKiBAcGFyYW0gYXJyYXkgJGZyYW1lCgkgKiBAcGFyYW0gaW50ICRtYXNrTm8KCSAqIEBwYXJhbSBpbnQgJGxldmVsCgkgKiBAcmV0dXJuIGFycmF5IG1hc2sKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBtYWtlTWFzaygkd2lkdGgsICRmcmFtZSwgJG1hc2tObywgJGxldmVsKSB7CgkJJG1hc2tlZCA9IGFycmF5X2ZpbGwoMCwgJHdpZHRoLCBzdHJfcmVwZWF0KCJcMCIsICR3aWR0aCkpOwoJCSR0aGlzLT5tYWtlTWFza05vKCRtYXNrTm8sICR3aWR0aCwgJGZyYW1lLCAkbWFza2VkKTsKCQkkdGhpcy0+d3JpdGVGb3JtYXRJbmZvcm1hdGlvbigkd2lkdGgsICRtYXNrZWQsICRtYXNrTm8sICRsZXZlbCk7CgkJcmV0dXJuICRtYXNrZWQ7Cgl9CgoJLyoqCgkgKiBjYWxjTjFOMwoJICogQHBhcmFtIGludCAkbGVuZ3RoCgkgKiBAcmV0dXJuIGludCBkZW1lcml0CgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY2FsY04xTjMoJGxlbmd0aCkgewoJCSRkZW1lcml0ID0gMDsKCQlmb3IgKCRpPTA7ICRpPCRsZW5ndGg7ICsrJGkpIHsKCQkJaWYgKCR0aGlzLT5ydW5MZW5ndGhbJGldID49IDUpIHsKCQkJCSRkZW1lcml0ICs9IChOMSArICgkdGhpcy0+cnVuTGVuZ3RoWyRpXSAtIDUpKTsKCQkJfQoJCQlpZiAoJGkgJiAxKSB7CgkJCQlpZiAoKCRpID49IDMpIEFORCAoJGkgPCAoJGxlbmd0aC0yKSkgQU5EICgkdGhpcy0+cnVuTGVuZ3RoWyRpXSAlIDMgPT0gMCkpIHsKCQkJCQkkZmFjdCA9IChpbnQpKCR0aGlzLT5ydW5MZW5ndGhbJGldIC8gMyk7CgkJCQkJaWYgKCgkdGhpcy0+cnVuTGVuZ3RoWyRpLTJdID09ICRmYWN0KQoJCQkJCQlBTkQgKCR0aGlzLT5ydW5MZW5ndGhbJGktMV0gPT0gJGZhY3QpCgkJCQkJCUFORCAoJHRoaXMtPnJ1bkxlbmd0aFskaSsxXSA9PSAkZmFjdCkKCQkJCQkJQU5EICgkdGhpcy0+cnVuTGVuZ3RoWyRpKzJdID09ICRmYWN0KSkgewoJCQkJCQlpZiAoKCR0aGlzLT5ydW5MZW5ndGhbJGktM10gPCAwKSBPUiAoJHRoaXMtPnJ1bkxlbmd0aFskaS0zXSA+PSAoNCAqICRmYWN0KSkpIHsKCQkJCQkJCSRkZW1lcml0ICs9IE4zOwoJCQkJCQl9IGVsc2VpZiAoKCgkaSszKSA+PSAkbGVuZ3RoKSBPUiAoJHRoaXMtPnJ1bkxlbmd0aFskaSszXSA+PSAoNCAqICRmYWN0KSkpIHsKCQkJCQkJCSRkZW1lcml0ICs9IE4zOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiAkZGVtZXJpdDsKCX0KCgkvKioKCSAqIGV2YWx1YXRlU3ltYm9sCgkgKiBAcGFyYW0gaW50ICR3aWR0aAoJICogQHBhcmFtIGFycmF5ICRmcmFtZQoJICogQHJldHVybiBpbnQgZGVtZXJpdAoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGV2YWx1YXRlU3ltYm9sKCR3aWR0aCwgJGZyYW1lKSB7CgkJJGhlYWQgPSAwOwoJCSRkZW1lcml0ID0gMDsKCQlmb3IgKCR5PTA7ICR5PCR3aWR0aDsgKyskeSkgewoJCQkkaGVhZCA9IDA7CgkJCSR0aGlzLT5ydW5MZW5ndGhbMF0gPSAxOwoJCQkkZnJhbWVZID0gJGZyYW1lWyR5XTsKCQkJaWYgKCR5ID4gMCkgewoJCQkJJGZyYW1lWU0gPSAkZnJhbWVbJHktMV07CgkJCX0KCQkJZm9yICgkeD0wOyAkeDwkd2lkdGg7ICsrJHgpIHsKCQkJCWlmICgoJHggPiAwKSBBTkQgKCR5ID4gMCkpIHsKCQkJCQkkYjIyID0gb3JkKCRmcmFtZVlbJHhdKSAmIG9yZCgkZnJhbWVZWyR4LTFdKSAmIG9yZCgkZnJhbWVZTVskeF0pICYgb3JkKCRmcmFtZVlNWyR4LTFdKTsKCQkJCQkkdzIyID0gb3JkKCRmcmFtZVlbJHhdKSB8IG9yZCgkZnJhbWVZWyR4LTFdKSB8IG9yZCgkZnJhbWVZTVskeF0pIHwgb3JkKCRmcmFtZVlNWyR4LTFdKTsKCQkJCQlpZiAoKCRiMjIgfCAoJHcyMiBeIDEpKSAmIDEpIHsKCQkJCQkJJGRlbWVyaXQgKz0gTjI7CgkJCQkJfQoJCQkJfQoJCQkJaWYgKCgkeCA9PSAwKSBBTkQgKG9yZCgkZnJhbWVZWyR4XSkgJiAxKSkgewoJCQkJCSR0aGlzLT5ydW5MZW5ndGhbMF0gPSAtMTsKCQkJCQkkaGVhZCA9IDE7CgkJCQkJJHRoaXMtPnJ1bkxlbmd0aFskaGVhZF0gPSAxOwoJCQkJfSBlbHNlaWYgKCR4ID4gMCkgewoJCQkJCWlmICgob3JkKCRmcmFtZVlbJHhdKSBeIG9yZCgkZnJhbWVZWyR4LTFdKSkgJiAxKSB7CgkJCQkJCSRoZWFkKys7CgkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdID0gMTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkdGhpcy0+cnVuTGVuZ3RoWyRoZWFkXSsrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQkkZGVtZXJpdCArPSAkdGhpcy0+Y2FsY04xTjMoJGhlYWQrMSk7CgkJfQoJCWZvciAoJHg9MDsgJHg8JHdpZHRoOyArKyR4KSB7CgkJCSRoZWFkID0gMDsKCQkJJHRoaXMtPnJ1bkxlbmd0aFswXSA9IDE7CgkJCWZvciAoJHk9MDsgJHk8JHdpZHRoOyArKyR5KSB7CgkJCQlpZiAoKCR5ID09IDApIEFORCAob3JkKCRmcmFtZVskeV1bJHhdKSAmIDEpKSB7CgkJCQkJJHRoaXMtPnJ1bkxlbmd0aFswXSA9IC0xOwoJCQkJCSRoZWFkID0gMTsKCQkJCQkkdGhpcy0+cnVuTGVuZ3RoWyRoZWFkXSA9IDE7CgkJCQl9IGVsc2VpZiAoJHkgPiAwKSB7CgkJCQkJaWYgKChvcmQoJGZyYW1lWyR5XVskeF0pIF4gb3JkKCRmcmFtZVskeS0xXVskeF0pKSAmIDEpIHsKCQkJCQkJJGhlYWQrKzsKCQkJCQkJJHRoaXMtPnJ1bkxlbmd0aFskaGVhZF0gPSAxOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdKys7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCSRkZW1lcml0ICs9ICR0aGlzLT5jYWxjTjFOMygkaGVhZCsxKTsKCQl9CgkJcmV0dXJuICRkZW1lcml0OwoJfQoKCS8qKgoJICogbWFzawoJICogQHBhcmFtIGludCAkd2lkdGgKCSAqIEBwYXJhbSBhcnJheSAkZnJhbWUKCSAqIEBwYXJhbSBpbnQgJGxldmVsCgkgKiBAcmV0dXJuIGFycmF5IGJlc3QgbWFzawoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2soJHdpZHRoLCAkZnJhbWUsICRsZXZlbCkgewoJCSRtaW5EZW1lcml0ID0gUEhQX0lOVF9NQVg7CgkJJGJlc3RNYXNrTnVtID0gMDsKCQkkYmVzdE1hc2sgPSBhcnJheSgpOwoJCSRjaGVja2VkX21hc2tzID0gYXJyYXkoMCwgMSwgMiwgMywgNCwgNSwgNiwgNyk7CgkJaWYgKFFSX0ZJTkRfRlJPTV9SQU5ET00gIT09IGZhbHNlKSB7CgkJCSRob3dNYW51T3V0ID0gOCAtIChRUl9GSU5EX0ZST01fUkFORE9NICUgOSk7CgkJCWZvciAoJGkgPSAwOyAkaSA8ICAkaG93TWFudU91dDsgKyskaSkgewoJCQkJJHJlbVBvcyA9IHJhbmQgKDAsIGNvdW50KCRjaGVja2VkX21hc2tzKS0xKTsKCQkJCXVuc2V0KCRjaGVja2VkX21hc2tzWyRyZW1Qb3NdKTsKCQkJCSRjaGVja2VkX21hc2tzID0gYXJyYXlfdmFsdWVzKCRjaGVja2VkX21hc2tzKTsKCQkJfQoJCX0KCQkkYmVzdE1hc2sgPSAkZnJhbWU7CgkJZm9yZWFjaCAoJGNoZWNrZWRfbWFza3MgYXMgJGkpIHsKCQkJJG1hc2sgPSBhcnJheV9maWxsKDAsICR3aWR0aCwgc3RyX3JlcGVhdCgiXDAiLCAkd2lkdGgpKTsKCQkJJGRlbWVyaXQgPSAwOwoJCQkkYmxhY2tzID0gMDsKCQkJJGJsYWNrcyAgPSAkdGhpcy0+bWFrZU1hc2tObygkaSwgJHdpZHRoLCAkZnJhbWUsICRtYXNrKTsKCQkJJGJsYWNrcyArPSAkdGhpcy0+d3JpdGVGb3JtYXRJbmZvcm1hdGlvbigkd2lkdGgsICRtYXNrLCAkaSwgJGxldmVsKTsKCQkJJGJsYWNrcyAgPSAoaW50KSgxMDAgKiAkYmxhY2tzIC8gKCR3aWR0aCAqICR3aWR0aCkpOwoJCQkkZGVtZXJpdCA9IChpbnQpKChpbnQpKGFicygkYmxhY2tzIC0gNTApIC8gNSkgKiBONCk7CgkJCSRkZW1lcml0ICs9ICR0aGlzLT5ldmFsdWF0ZVN5bWJvbCgkd2lkdGgsICRtYXNrKTsKCQkJaWYgKCRkZW1lcml0IDwgJG1pbkRlbWVyaXQpIHsKCQkJCSRtaW5EZW1lcml0ID0gJGRlbWVyaXQ7CgkJCQkkYmVzdE1hc2sgPSAkbWFzazsKCQkJCSRiZXN0TWFza051bSA9ICRpOwoJCQl9CgkJfQoJCXJldHVybiAkYmVzdE1hc2s7Cgl9CgoJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCS8vIFFSc3BsaXQKCgkvKioKCSAqIFJldHVybiB0cnVlIGlmIHRoZSBjaGFyYWN0ZXIgYXQgc3BlY2lmaWVkIHBvc2l0aW9uIGlzIGEgbnVtYmVyCgkgKiBAcGFyYW0gc3RyaW5nICRzdHIgc3RyaW5nCgkgKiBAcGFyYW0gaW50ICRwb3MgY2hhcmFjdGVkIHBvc2l0aW9uCgkgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBvZiBmYWxzZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGlzZGlnaXRhdCgkc3RyLCAkcG9zKSB7CgkJaWYgKCRwb3MgPj0gc3RybGVuKCRzdHIpKSB7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJcmV0dXJuICgob3JkKCRzdHJbJHBvc10pID49IG9yZCgnMCcpKSYmKG9yZCgkc3RyWyRwb3NdKSA8PSBvcmQoJzknKSkpOwoJfQoKCS8qKgoJICogUmV0dXJuIHRydWUgaWYgdGhlIGNoYXJhY3RlciBhdCBzcGVjaWZpZWQgcG9zaXRpb24gaXMgYW4gYWxwaGFudW1lcmljIGNoYXJhY3RlcgoJICogQHBhcmFtIHN0cmluZyAkc3RyIHN0cmluZwoJICogQHBhcmFtIGludCAkcG9zIGNoYXJhY3RlZCBwb3NpdGlvbgoJICogQHJldHVybiBib29sZWFuIHRydWUgb2YgZmFsc2UKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBpc2FsbnVtYXQoJHN0ciwgJHBvcykgewoJCWlmICgkcG9zID49IHN0cmxlbigkc3RyKSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXJldHVybiAoJHRoaXMtPmxvb2tBblRhYmxlKG9yZCgkc3RyWyRwb3NdKSkgPj0gMCk7Cgl9CgoJLyoqCgkgKiBpZGVudGlmeU1vZGUKCSAqIEBwYXJhbSBpbnQgJHBvcwoJICogQHJldHVybiBpbnQgbW9kZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGlkZW50aWZ5TW9kZSgkcG9zKSB7CgkJaWYgKCRwb3MgPj0gc3RybGVuKCR0aGlzLT5kYXRhU3RyKSkgewoJCQlyZXR1cm4gUVJfTU9ERV9OTDsKCQl9CgkJJGMgPSAkdGhpcy0+ZGF0YVN0clskcG9zXTsKCQlpZiAoJHRoaXMtPmlzZGlnaXRhdCgkdGhpcy0+ZGF0YVN0ciwgJHBvcykpIHsKCQkJcmV0dXJuIFFSX01PREVfTk07CgkJfSBlbHNlaWYgKCR0aGlzLT5pc2FsbnVtYXQoJHRoaXMtPmRhdGFTdHIsICRwb3MpKSB7CgkJCXJldHVybiBRUl9NT0RFX0FOOwoJCX0gZWxzZWlmICgkdGhpcy0+aGludCA9PSBRUl9NT0RFX0tKKSB7CgkJCWlmICgkcG9zKzEgPCBzdHJsZW4oJHRoaXMtPmRhdGFTdHIpKSB7CgkJCQkkZCA9ICR0aGlzLT5kYXRhU3RyWyRwb3MrMV07CgkJCQkkd29yZCA9IChvcmQoJGMpIDw8IDgpIHwgb3JkKCRkKTsKCQkJCWlmICgoJHdvcmQgPj0gMHg4MTQwICYmICR3b3JkIDw9IDB4OWZmYykgT1IgKCR3b3JkID49IDB4ZTA0MCAmJiAkd29yZCA8PSAweGViYmYpKSB7CgkJCQkJcmV0dXJuIFFSX01PREVfS0o7CgkJCQl9CgkJCX0KCQl9CgkJcmV0dXJuIFFSX01PREVfOEI7Cgl9CgoJLyoqCgkgKiBlYXROdW0KCSAqIEByZXR1cm4gaW50IHJ1bgoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVhdE51bSgpIHsKCQkkbG4gPSAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfTk0sICR0aGlzLT52ZXJzaW9uKTsKCQkkcCA9IDA7CgkJd2hpbGUoJHRoaXMtPmlzZGlnaXRhdCgkdGhpcy0+ZGF0YVN0ciwgJHApKSB7CgkJCSRwKys7CgkJfQoJCSRydW4gPSAkcDsKCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoJHApOwoJCWlmICgkbW9kZSA9PSBRUl9NT0RFXzhCKSB7CgkJCSRkaWYgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZU51bSgkcnVuKSArIDQgKyAkbG4KCQkJKyAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoMSkgICAgICAgICAvLyArIDQgKyBsOAoJCQktICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcnVuICsgMSk7IC8vIC0gNCAtIGw4CgkJCWlmICgkZGlmID4gMCkgewoJCQkJcmV0dXJuICR0aGlzLT5lYXQ4KCk7CgkJCX0KCQl9CgkJaWYgKCRtb2RlID09IFFSX01PREVfQU4pIHsKCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlTnVtKCRydW4pICsgNCArICRsbgoJCQkrICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oMSkgICAgICAgIC8vICsgNCArIGxhCgkJCS0gJHRoaXMtPmVzdGltYXRlQml0c01vZGVBbigkcnVuICsgMSk7Ly8gLSA0IC0gbGEKCQkJaWYgKCRkaWYgPiAwKSB7CgkJCQlyZXR1cm4gJHRoaXMtPmVhdEFuKCk7CgkJCX0KCQl9CgkJJHRoaXMtPml0ZW1zID0gJHRoaXMtPmFwcGVuZE5ld0lucHV0SXRlbSgkdGhpcy0+aXRlbXMsIFFSX01PREVfTk0sICRydW4sIHN0cl9zcGxpdCgkdGhpcy0+ZGF0YVN0cikpOwoJCXJldHVybiAkcnVuOwoJfQoKCS8qKgoJICogZWF0QW4KCSAqIEByZXR1cm4gaW50IHJ1bgoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVhdEFuKCkgewoJCSRsYSA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9BTiwgICR0aGlzLT52ZXJzaW9uKTsKCQkkbG4gPSAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfTk0sICR0aGlzLT52ZXJzaW9uKTsKCQkkcCA9MSA7CgkJd2hpbGUoJHRoaXMtPmlzYWxudW1hdCgkdGhpcy0+ZGF0YVN0ciwgJHApKSB7CgkJCWlmICgkdGhpcy0+aXNkaWdpdGF0KCR0aGlzLT5kYXRhU3RyLCAkcCkpIHsKCQkJCSRxID0gJHA7CgkJCQl3aGlsZSgkdGhpcy0+aXNkaWdpdGF0KCR0aGlzLT5kYXRhU3RyLCAkcSkpIHsKCQkJCQkkcSsrOwoJCQkJfQoJCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oJHApIC8vICsgNCArIGxhCgkJCQkrICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlTnVtKCRxIC0gJHApICsgNCArICRsbgoJCQkJLSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZUFuKCRxKTsgLy8gLSA0IC0gbGEKCQkJCWlmICgkZGlmIDwgMCkgewoJCQkJCWJyZWFrOwoJCQkJfSBlbHNlIHsKCQkJCQkkcCA9ICRxOwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJJHArKzsKCQkJfQoJCX0KCQkkcnVuID0gJHA7CgkJaWYgKCEkdGhpcy0+aXNhbG51bWF0KCR0aGlzLT5kYXRhU3RyLCAkcCkpIHsKCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oJHJ1bikgKyA0ICsgJGxhCgkJCSsgJHRoaXMtPmVzdGltYXRlQml0c01vZGU4KDEpIC8vICsgNCArIGw4CgkJCS0gJHRoaXMtPmVzdGltYXRlQml0c01vZGU4KCRydW4gKyAxKTsgLy8gLSA0IC0gbDgKCQkJaWYgKCRkaWYgPiAwKSB7CgkJCQlyZXR1cm4gJHRoaXMtPmVhdDgoKTsKCQkJfQoJCX0KCQkkdGhpcy0+aXRlbXMgPSAkdGhpcy0+YXBwZW5kTmV3SW5wdXRJdGVtKCR0aGlzLT5pdGVtcywgUVJfTU9ERV9BTiwgJHJ1biwgc3RyX3NwbGl0KCR0aGlzLT5kYXRhU3RyKSk7CgkJcmV0dXJuICRydW47Cgl9CgoJLyoqCgkgKiBlYXRLYW5qaQoJICogQHJldHVybiBpbnQgcnVuCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZWF0S2FuamkoKSB7CgkJJHAgPSAwOwoJCXdoaWxlKCR0aGlzLT5pZGVudGlmeU1vZGUoJHApID09IFFSX01PREVfS0opIHsKCQkJJHAgKz0gMjsKCQl9CgkJJHRoaXMtPml0ZW1zID0gJHRoaXMtPmFwcGVuZE5ld0lucHV0SXRlbSgkdGhpcy0+aXRlbXMsIFFSX01PREVfS0osICRwLCBzdHJfc3BsaXQoJHRoaXMtPmRhdGFTdHIpKTsKCQkkcnVuID0gJHA7CgkJcmV0dXJuICRydW47Cgl9CgoJLyoqCgkgKiBlYXQ4CgkgKiBAcmV0dXJuIGludCBydW4KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlYXQ4KCkgewoJCSRsYSA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9BTiwgJHRoaXMtPnZlcnNpb24pOwoJCSRsbiA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9OTSwgJHRoaXMtPnZlcnNpb24pOwoJCSRwID0gMTsKCQkkZGF0YVN0ckxlbiA9IHN0cmxlbigkdGhpcy0+ZGF0YVN0cik7CgkJd2hpbGUoJHAgPCAkZGF0YVN0ckxlbikgewoJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoJHApOwoJCQlpZiAoJG1vZGUgPT0gUVJfTU9ERV9LSikgewoJCQkJYnJlYWs7CgkJCX0KCQkJaWYgKCRtb2RlID09IFFSX01PREVfTk0pIHsKCQkJCSRxID0gJHA7CgkJCQl3aGlsZSgkdGhpcy0+aXNkaWdpdGF0KCR0aGlzLT5kYXRhU3RyLCAkcSkpIHsKCQkJCQkkcSsrOwoJCQkJfQoJCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcCkgLy8gKyA0ICsgbDgKCQkJCSsgJHRoaXMtPmVzdGltYXRlQml0c01vZGVOdW0oJHEgLSAkcCkgKyA0ICsgJGxuCgkJCQktICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcSk7IC8vIC0gNCAtIGw4CgkJCQlpZiAoJGRpZiA8IDApIHsKCQkJCQlicmVhazsKCQkJCX0gZWxzZSB7CgkJCQkJJHAgPSAkcTsKCQkJCX0KCQkJfSBlbHNlaWYgKCRtb2RlID09IFFSX01PREVfQU4pIHsKCQkJCSRxID0gJHA7CgkJCQl3aGlsZSgkdGhpcy0+aXNhbG51bWF0KCR0aGlzLT5kYXRhU3RyLCAkcSkpIHsKCQkJCQkkcSsrOwoJCQkJfQoJCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcCkgIC8vICsgNCArIGw4CgkJCQkrICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oJHEgLSAkcCkgKyA0ICsgJGxhCgkJCQktICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcSk7IC8vIC0gNCAtIGw4CgkJCQlpZiAoJGRpZiA8IDApIHsKCQkJCQlicmVhazsKCQkJCX0gZWxzZSB7CgkJCQkJJHAgPSAkcTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCSRwKys7CgkJCX0KCQl9CgkJJHJ1biA9ICRwOwoJCSR0aGlzLT5pdGVtcyA9ICR0aGlzLT5hcHBlbmROZXdJbnB1dEl0ZW0oJHRoaXMtPml0ZW1zLCBRUl9NT0RFXzhCLCAkcnVuLCBzdHJfc3BsaXQoJHRoaXMtPmRhdGFTdHIpKTsKCQlyZXR1cm4gJHJ1bjsKCX0KCgkvKioKCSAqIHNwbGl0U3RyaW5nCgkgKiBAcmV0dXJuIGludAoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHNwbGl0U3RyaW5nKCkgewoJCXdoaWxlIChzdHJsZW4oJHRoaXMtPmRhdGFTdHIpID4gMCkgewoJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoMCk7CgkJCXN3aXRjaCAoJG1vZGUpIHsKCQkJCWNhc2UgUVJfTU9ERV9OTTogewoJCQkJCSRsZW5ndGggPSAkdGhpcy0+ZWF0TnVtKCk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfQU46IHsKCQkJCQkkbGVuZ3RoID0gJHRoaXMtPmVhdEFuKCk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfS0o6IHsKCQkJCQlpZiAoJHRoaXMtPmhpbnQgPT0gUVJfTU9ERV9LSikgewoJCQkJCQkkbGVuZ3RoID0gJHRoaXMtPmVhdEthbmppKCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGxlbmd0aCA9ICR0aGlzLT5lYXQ4KCk7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJZGVmYXVsdDogewoJCQkJCSRsZW5ndGggPSAkdGhpcy0+ZWF0OCgpOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJCWlmICgkbGVuZ3RoID09IDApIHsKCQkJCXJldHVybiAwOwoJCQl9CgkJCWlmICgkbGVuZ3RoIDwgMCkgewoJCQkJcmV0dXJuIC0xOwoJCQl9CgkJCSR0aGlzLT5kYXRhU3RyID0gc3Vic3RyKCR0aGlzLT5kYXRhU3RyLCAkbGVuZ3RoKTsKCQl9CgkJcmV0dXJuIDA7Cgl9CgoJLyoqCgkgKiB0b1VwcGVyCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gdG9VcHBlcigpIHsKCQkkc3RyaW5nTGVuID0gc3RybGVuKCR0aGlzLT5kYXRhU3RyKTsKCQkkcCA9IDA7CgkJd2hpbGUgKCRwIDwgJHN0cmluZ0xlbikgewoJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoc3Vic3RyKCR0aGlzLT5kYXRhU3RyLCAkcCkpOwoJCQlpZiAoJG1vZGUgPT0gUVJfTU9ERV9LSikgewoJCQkJJHAgKz0gMjsKCQkJfSBlbHNlIHsKCQkJCWlmICgob3JkKCR0aGlzLT5kYXRhU3RyWyRwXSkgPj0gb3JkKCdhJykpIEFORCAob3JkKCR0aGlzLT5kYXRhU3RyWyRwXSkgPD0gb3JkKCd6JykpKSB7CgkJCQkJJHRoaXMtPmRhdGFTdHJbJHBdID0gY2hyKG9yZCgkdGhpcy0+ZGF0YVN0clskcF0pIC0gMzIpOwoJCQkJfQoJCQkJJHArKzsKCQkJfQoJCX0KCQlyZXR1cm4gJHRoaXMtPmRhdGFTdHI7Cgl9CgoJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCS8vIFFSaW5wdXRJdGVtCgoJLyoqCgkgKiBuZXdJbnB1dEl0ZW0KCSAqIEBwYXJhbSBpbnQgJG1vZGUKCSAqIEBwYXJhbSBpbnQgJHNpemUKCSAqIEBwYXJhbSBhcnJheSAkZGF0YQoJICogQHBhcmFtIGFycmF5ICRic3RyZWFtCgkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBuZXdJbnB1dEl0ZW0oJG1vZGUsICRzaXplLCAkZGF0YSwgJGJzdHJlYW09bnVsbCkgewoJCSRzZXREYXRhID0gYXJyYXlfc2xpY2UoJGRhdGEsIDAsICRzaXplKTsKCQlpZiAoY291bnQoJHNldERhdGEpIDwgJHNpemUpIHsKCQkJJHNldERhdGEgPSBhcnJheV9tZXJnZSgkc2V0RGF0YSwgYXJyYXlfZmlsbCgwLCAoJHNpemUgLSBjb3VudCgkc2V0RGF0YSkpLCAwKSk7CgkJfQoJCWlmICghJHRoaXMtPmNoZWNrKCRtb2RlLCAkc2l6ZSwgJHNldERhdGEpKSB7CgkJCXJldHVybiBOVUxMOwoJCX0KCQkkaW5wdXRpdGVtID0gYXJyYXkoKTsKCQkkaW5wdXRpdGVtWydtb2RlJ10gPSAkbW9kZTsKCQkkaW5wdXRpdGVtWydzaXplJ10gPSAkc2l6ZTsKCQkkaW5wdXRpdGVtWydkYXRhJ10gPSAkc2V0RGF0YTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkYnN0cmVhbTsKCQlyZXR1cm4gJGlucHV0aXRlbTsKCX0KCgkvKioKCSAqIGVuY29kZU1vZGVOdW0KCSAqIEBwYXJhbSBhcnJheSAkaW5wdXRpdGVtCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uCgkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVNb2RlTnVtKCRpbnB1dGl0ZW0sICR2ZXJzaW9uKSB7CgkJJHdvcmRzID0gKGludCkoJGlucHV0aXRlbVsnc2l6ZSddIC8gMyk7CgkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkkdmFsID0gMHgxOwoJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCAkdmFsKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgJHRoaXMtPmxlbmd0aEluZGljYXRvcihRUl9NT0RFX05NLCAkdmVyc2lvbiksICRpbnB1dGl0ZW1bJ3NpemUnXSk7CgkJZm9yICgkaT0wOyAkaSA8ICR3b3JkczsgKyskaSkgewoJCQkkdmFsICA9IChvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjMgIF0pIC0gb3JkKCcwJykpICogMTAwOwoJCQkkdmFsICs9IChvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjMrMV0pIC0gb3JkKCcwJykpICogMTA7CgkJCSR2YWwgKz0gKG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJGkqMysyXSkgLSBvcmQoJzAnKSk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAxMCwgJHZhbCk7CgkJfQoJCWlmICgkaW5wdXRpdGVtWydzaXplJ10gLSAkd29yZHMgKiAzID09IDEpIHsKCQkJJHZhbCA9IG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJHdvcmRzKjNdKSAtIG9yZCgnMCcpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgJHZhbCk7CgkJfSBlbHNlaWYgKCgkaW5wdXRpdGVtWydzaXplJ10gLSAoJHdvcmRzICogMykpID09IDIpIHsKCQkJJHZhbCAgPSAob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVskd29yZHMqMyAgXSkgLSBvcmQoJzAnKSkgKiAxMDsKCQkJJHZhbCArPSAob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVskd29yZHMqMysxXSkgLSBvcmQoJzAnKSk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA3LCAkdmFsKTsKCQl9CgkJcmV0dXJuICRpbnB1dGl0ZW07Cgl9CgoJLyoqCgkgKiBlbmNvZGVNb2RlQW4KCSAqIEBwYXJhbSBhcnJheSAkaW5wdXRpdGVtCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uCgkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVNb2RlQW4oJGlucHV0aXRlbSwgJHZlcnNpb24pIHsKCQkkd29yZHMgPSAoaW50KSgkaW5wdXRpdGVtWydzaXplJ10gLyAyKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSBhcnJheSgpOwoJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCAweDAyKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgJHRoaXMtPmxlbmd0aEluZGljYXRvcihRUl9NT0RFX0FOLCAkdmVyc2lvbiksICRpbnB1dGl0ZW1bJ3NpemUnXSk7CgkJZm9yICgkaT0wOyAkaSA8ICR3b3JkczsgKyskaSkgewoJCQkkdmFsICA9IChpbnQpKCR0aGlzLT5sb29rQW5UYWJsZShvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjJdKSkgKiA0NSk7CgkJCSR2YWwgKz0gKGludCkoJHRoaXMtPmxvb2tBblRhYmxlKG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bKCRpKjIpKzFdKSkpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgMTEsICR2YWwpOwoJCX0KCQlpZiAoJGlucHV0aXRlbVsnc2l6ZSddICYgMSkgewoJCQkkdmFsID0gJHRoaXMtPmxvb2tBblRhYmxlKG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bKCR3b3JkcyAqIDIpXSkpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNiwgJHZhbCk7CgkJfQoJCXJldHVybiAkaW5wdXRpdGVtOwoJfQoKCS8qKgoJICogZW5jb2RlTW9kZTgKCSAqIEBwYXJhbSBhcnJheSAkaW5wdXRpdGVtCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uCgkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVNb2RlOCgkaW5wdXRpdGVtLCAkdmVyc2lvbikgewoJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9IGFycmF5KCk7CgkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDQsIDB4NCk7CgkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV84QiwgJHZlcnNpb24pLCAkaW5wdXRpdGVtWydzaXplJ10pOwoJCWZvciAoJGk9MDsgJGkgPCAkaW5wdXRpdGVtWydzaXplJ107ICsrJGkpIHsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDgsIG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJGldKSk7CgkJfQoJCXJldHVybiAkaW5wdXRpdGVtOwoJfQoKCS8qKgoJICogZW5jb2RlTW9kZUthbmppCgkgKiBAcGFyYW0gYXJyYXkgJGlucHV0aXRlbQoJICogQHBhcmFtIGludCAkdmVyc2lvbgoJICogQHJldHVybiBhcnJheSBpbnB1dCBpdGVtCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZW5jb2RlTW9kZUthbmppKCRpbnB1dGl0ZW0sICR2ZXJzaW9uKSB7CgkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgMHg4KTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgJHRoaXMtPmxlbmd0aEluZGljYXRvcihRUl9NT0RFX0tKLCAkdmVyc2lvbiksIChpbnQpKCRpbnB1dGl0ZW1bJ3NpemUnXSAvIDIpKTsKCQlmb3IgKCRpPTA7ICRpPCRpbnB1dGl0ZW1bJ3NpemUnXTsgJGkrPTIpIHsKCQkJJHZhbCA9IChvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpXSkgPDwgOCkgfCBvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKzFdKTsKCQkJaWYgKCR2YWwgPD0gMHg5ZmZjKSB7CgkJCQkkdmFsIC09IDB4ODE0MDsKCQkJfSBlbHNlIHsKCQkJCSR2YWwgLT0gMHhjMTQwOwoJCQl9CgkJCSRoID0gKCR2YWwgPj4gOCkgKiAweGMwOwoJCQkkdmFsID0gKCR2YWwgJiAweGZmKSArICRoOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgMTMsICR2YWwpOwoJCX0KCQlyZXR1cm4gJGlucHV0aXRlbTsKCX0KCgkvKioKCSAqIGVuY29kZU1vZGVTdHJ1Y3R1cmUKCSAqIEBwYXJhbSBhcnJheSAkaW5wdXRpdGVtCgkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVNb2RlU3RydWN0dXJlKCRpbnB1dGl0ZW0pIHsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSBhcnJheSgpOwoJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCAweDAzKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgb3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVsxXSkgLSAxKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgb3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVswXSkgLSAxKTsKCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgOCwgb3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVsyXSkpOwoJCXJldHVybiAkaW5wdXRpdGVtOwoJfQoKCS8qKgoJICogZW5jb2RlQml0U3RyZWFtCgkgKiBAcGFyYW0gYXJyYXkgJGlucHV0aXRlbQoJICogQHBhcmFtIGludCAkdmVyc2lvbgoJICogQHJldHVybiBhcnJheSBpbnB1dCBpdGVtCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZW5jb2RlQml0U3RyZWFtKCRpbnB1dGl0ZW0sICR2ZXJzaW9uKSB7CgkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkkd29yZHMgPSAkdGhpcy0+bWF4aW11bVdvcmRzKCRpbnB1dGl0ZW1bJ21vZGUnXSwgJHZlcnNpb24pOwoJCWlmICgkaW5wdXRpdGVtWydzaXplJ10gPiAkd29yZHMpIHsKCQkJJHN0MSA9ICR0aGlzLT5uZXdJbnB1dEl0ZW0oJGlucHV0aXRlbVsnbW9kZSddLCAkd29yZHMsICRpbnB1dGl0ZW1bJ2RhdGEnXSk7CgkJCSRzdDIgPSAkdGhpcy0+bmV3SW5wdXRJdGVtKCRpbnB1dGl0ZW1bJ21vZGUnXSwgJGlucHV0aXRlbVsnc2l6ZSddIC0gJHdvcmRzLCBhcnJheV9zbGljZSgkaW5wdXRpdGVtWydkYXRhJ10sICR3b3JkcykpOwoJCQkkc3QxID0gJHRoaXMtPmVuY29kZUJpdFN0cmVhbSgkc3QxLCAkdmVyc2lvbik7CgkJCSRzdDIgPSAkdGhpcy0+ZW5jb2RlQml0U3RyZWFtKCRzdDIsICR2ZXJzaW9uKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkaW5wdXRpdGVtWydic3RyZWFtJ10sICRzdDFbJ2JzdHJlYW0nXSk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmRCaXRzdHJlYW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAkc3QyWydic3RyZWFtJ10pOwoJCX0gZWxzZSB7CgkJCXN3aXRjaCgkaW5wdXRpdGVtWydtb2RlJ10pIHsKCQkJCWNhc2UgUVJfTU9ERV9OTTogewoJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZU51bSgkaW5wdXRpdGVtLCAkdmVyc2lvbik7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfQU46IHsKCQkJCQkkaW5wdXRpdGVtID0gJHRoaXMtPmVuY29kZU1vZGVBbigkaW5wdXRpdGVtLCAkdmVyc2lvbik7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfOEI6IHsKCQkJCQkkaW5wdXRpdGVtID0gJHRoaXMtPmVuY29kZU1vZGU4KCRpbnB1dGl0ZW0sICR2ZXJzaW9uKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgUVJfTU9ERV9LSjogewoJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZUthbmppKCRpbnB1dGl0ZW0sICR2ZXJzaW9uKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2UgUVJfTU9ERV9TVDogewoJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZVN0cnVjdHVyZSgkaW5wdXRpdGVtKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWRlZmF1bHQ6IHsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gJGlucHV0aXRlbTsKCX0KCgkvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCgoJLy8gUVJpbnB1dAoKCS8qKgoJICogQXBwZW5kIGRhdGEgdG8gYW4gaW5wdXQgb2JqZWN0LgoJICogVGhlIGRhdGEgaXMgY29waWVkIGFuZCBhcHBlbmRlZCB0byB0aGUgaW5wdXQgb2JqZWN0LgoJICogQHBhcmFtIGFycmF5ICRpdGVtcyBpbnB1dCBpdGVtcwoJICogQHBhcmFtIGludCAkbW9kZSBlbmNvZGluZyBtb2RlLgoJICogQHBhcmFtIGludCAkc2l6ZSBzaXplIG9mIGRhdGEgKGJ5dGUpLgoJICogQHBhcmFtIGFycmF5ICRkYXRhIGFycmF5IG9mIGlucHV0IGRhdGEuCgkgKiBAcmV0dXJuIGFycmF5IGl0ZW1zCgkgKgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gYXBwZW5kTmV3SW5wdXRJdGVtKCRpdGVtcywgJG1vZGUsICRzaXplLCAkZGF0YSkgewoJCSRuZXdpdGVtID0gJHRoaXMtPm5ld0lucHV0SXRlbSgkbW9kZSwgJHNpemUsICRkYXRhKTsKCQlpZiAoIWVtcHR5KCRuZXdpdGVtKSkgewoJCQkkaXRlbXNbXSA9ICRuZXdpdGVtOwoJCX0KCQlyZXR1cm4gJGl0ZW1zOwoJfQoKCS8qKgoJICogaW5zZXJ0U3RydWN0dXJlZEFwcGVuZEhlYWRlcgoJICogQHBhcmFtIGFycmF5ICRpdGVtcwoJICogQHBhcmFtIGludCAkc2l6ZQoJICogQHBhcmFtIGludCAkaW5kZXgKCSAqIEBwYXJhbSBpbnQgJHBhcml0eQoJICogQHJldHVybiBhcnJheSBpdGVtcwoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGluc2VydFN0cnVjdHVyZWRBcHBlbmRIZWFkZXIoJGl0ZW1zLCAkc2l6ZSwgJGluZGV4LCAkcGFyaXR5KSB7CgkJaWYgKCRzaXplID4gTUFYX1NUUlVDVFVSRURfU1lNQk9MUykgewoJCQlyZXR1cm4gLTE7CgkJfQoJCWlmICgoJGluZGV4IDw9IDApIE9SICgkaW5kZXggPiBNQVhfU1RSVUNUVVJFRF9TWU1CT0xTKSkgewoJCQlyZXR1cm4gLTE7CgkJfQoJCSRidWYgPSBhcnJheSgkc2l6ZSwgJGluZGV4LCAkcGFyaXR5KTsKCQkkZW50cnkgPSAkdGhpcy0+bmV3SW5wdXRJdGVtKFFSX01PREVfU1QsIDMsICRidWYpOwoJCWFycmF5X3Vuc2hpZnQoJGl0ZW1zLCAkZW50cnkpOwoJCXJldHVybiAkaXRlbXM7Cgl9CgoJLyoqCgkgKiBjYWxjUGFyaXR5CgkgKiBAcGFyYW0gYXJyYXkgJGl0ZW1zCgkgKiBAcmV0dXJuIGludCBwYXJpdHkKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBjYWxjUGFyaXR5KCRpdGVtcykgewoJCSRwYXJpdHkgPSAwOwoJCWZvcmVhY2ggKCRpdGVtcyBhcyAkaXRlbSkgewoJCQlpZiAoJGl0ZW1bJ21vZGUnXSAhPSBRUl9NT0RFX1NUKSB7CgkJCQlmb3IgKCRpPSRpdGVtWydzaXplJ10tMTsgJGk+PTA7IC0tJGkpIHsKCQkJCQkkcGFyaXR5IF49ICRpdGVtWydkYXRhJ11bJGldOwoJCQkJfQoJCQl9CgkJfQoJCXJldHVybiAkcGFyaXR5OwoJfQoKCS8qKgoJICogY2hlY2tNb2RlTnVtCgkgKiBAcGFyYW0gaW50ICRzaXplCgkgKiBAcGFyYW0gYXJyYXkgJGRhdGEKCSAqIEByZXR1cm4gYm9vbGVhbiB0cnVlIG9yIGZhbHNlCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2tNb2RlTnVtKCRzaXplLCAkZGF0YSkgewoJCWZvciAoJGk9MDsgJGk8JHNpemU7ICsrJGkpIHsKCQkJaWYgKChvcmQoJGRhdGFbJGldKSA8IG9yZCgnMCcpKSBPUiAob3JkKCRkYXRhWyRpXSkgPiBvcmQoJzknKSkpewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogTG9vayB1cCB0aGUgYWxwaGFiZXQtbnVtZXJpYyBjb252ZXJzaW9uIHRhYmxlIChzZWUgSklTIFgwNTEwOjIwMDQsIHBwLjE5KS4KCSAqIEBwYXJhbSBpbnQgJGMgY2hhcmFjdGVyIHZhbHVlCgkgKiBAcmV0dXJuIGludCB2YWx1ZQoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gbG9va0FuVGFibGUoJGMpIHsKCQlyZXR1cm4gKCgkYyA+IDEyNyk/LTE6JHRoaXMtPmFuVGFibGVbJGNdKTsKCX0KCgkvKioKCSAqIGNoZWNrTW9kZUFuCgkgKiBAcGFyYW0gaW50ICRzaXplCgkgKiBAcGFyYW0gYXJyYXkgJGRhdGEKCSAqIEByZXR1cm4gYm9vbGVhbiB0cnVlIG9yIGZhbHNlCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2tNb2RlQW4oJHNpemUsICRkYXRhKSB7CgkJZm9yICgkaT0wOyAkaTwkc2l6ZTsgKyskaSkgewoJCQlpZiAoJHRoaXMtPmxvb2tBblRhYmxlKG9yZCgkZGF0YVskaV0pKSA9PSAtMSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogZXN0aW1hdGVCaXRzTW9kZU51bQoJICogQHBhcmFtIGludCAkc2l6ZQoJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZUJpdHNNb2RlTnVtKCRzaXplKSB7CgkJJHcgPSAoaW50KSgkc2l6ZSAvIDMpOwoJCSRiaXRzID0gKCR3ICogMTApOwoJCXN3aXRjaCgkc2l6ZSAtICgkdyAqIDMpKSB7CgkJCWNhc2UgMTogewoJCQkJJGJpdHMgKz0gNDsKCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgMjogewoJCQkJJGJpdHMgKz0gNzsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCXJldHVybiAkYml0czsKCX0KCgkvKioKCSAqIGVzdGltYXRlQml0c01vZGVBbgoJICogQHBhcmFtIGludCAkc2l6ZQoJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZUJpdHNNb2RlQW4oJHNpemUpIHsKCQkkYml0cyA9IChpbnQpKCRzaXplICogNS41KTsgLy8gKHNpemUgLyAyICkgKiAxMQoJCWlmICgkc2l6ZSAmIDEpIHsKCQkJJGJpdHMgKz0gNjsKCQl9CgkJcmV0dXJuICRiaXRzOwoJfQoKCS8qKgoJICogZXN0aW1hdGVCaXRzTW9kZTgKCSAqIEBwYXJhbSBpbnQgJHNpemUKCSAqIEByZXR1cm4gaW50IG51bWJlciBvZiBiaXRzCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZXN0aW1hdGVCaXRzTW9kZTgoJHNpemUpIHsKCQlyZXR1cm4gKGludCkoJHNpemUgKiA4KTsKCX0KCgkvKioKCSAqIGVzdGltYXRlQml0c01vZGVLYW5qaQoJICogQHBhcmFtIGludCAkc2l6ZQoJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZUJpdHNNb2RlS2FuamkoJHNpemUpIHsKCQlyZXR1cm4gKGludCkoJHNpemUgKiA2LjUpOyAvLyAoc2l6ZSAvIDIgKSAqIDEzCgl9CgoJLyoqCgkgKiBjaGVja01vZGVLYW5qaQoJICogQHBhcmFtIGludCAkc2l6ZQoJICogQHBhcmFtIGFycmF5ICRkYXRhCgkgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBvciBmYWxzZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGNoZWNrTW9kZUthbmppKCRzaXplLCAkZGF0YSkgewoJCWlmICgkc2l6ZSAmIDEpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCQlmb3IgKCRpPTA7ICRpPCRzaXplOyAkaSs9MikgewoJCQkkdmFsID0gKG9yZCgkZGF0YVskaV0pIDw8IDgpIHwgb3JkKCRkYXRhWyRpKzFdKTsKCQkJaWYgKCgkdmFsIDwgMHg4MTQwKSBPUiAoKCR2YWwgPiAweDlmZmMpIEFORCAoJHZhbCA8IDB4ZTA0MCkpIE9SICgkdmFsID4gMHhlYmJmKSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfQoJCXJldHVybiB0cnVlOwoJfQoKCS8qKgoJICogVmFsaWRhdGUgdGhlIGlucHV0IGRhdGEuCgkgKiBAcGFyYW0gaW50ICRtb2RlIGVuY29kaW5nIG1vZGUuCgkgKiBAcGFyYW0gaW50ICRzaXplIHNpemUgb2YgZGF0YSAoYnl0ZSkuCgkgKiBAcGFyYW0gYXJyYXkgJGRhdGEgZGF0YSB0byB2YWxpZGF0ZQoJICogQHJldHVybiBib29sZWFuIHRydWUgaW4gY2FzZSBvZiB2YWxpZCBkYXRhLCBmYWxzZSBvdGhlcndpc2UKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGNoZWNrKCRtb2RlLCAkc2l6ZSwgJGRhdGEpIHsKCQlpZiAoJHNpemUgPD0gMCkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXN3aXRjaCgkbW9kZSkgewoJCQljYXNlIFFSX01PREVfTk06IHsKCQkJCXJldHVybiAkdGhpcy0+Y2hlY2tNb2RlTnVtKCRzaXplLCAkZGF0YSk7CgkJCX0KCQkJY2FzZSBRUl9NT0RFX0FOOiB7CgkJCQlyZXR1cm4gJHRoaXMtPmNoZWNrTW9kZUFuKCRzaXplLCAkZGF0YSk7CgkJCX0KCQkJY2FzZSBRUl9NT0RFX0tKOiB7CgkJCQlyZXR1cm4gJHRoaXMtPmNoZWNrTW9kZUthbmppKCRzaXplLCAkZGF0YSk7CgkJCX0KCQkJY2FzZSBRUl9NT0RFXzhCOiB7CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCQljYXNlIFFSX01PREVfU1Q6IHsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJCWRlZmF1bHQ6IHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCXJldHVybiBmYWxzZTsKCX0KCgkvKioKCSAqIGVzdGltYXRlQml0U3RyZWFtU2l6ZQoJICogQHBhcmFtIGFycmF5ICRpdGVtcwoJICogQHBhcmFtIGludCAkdmVyc2lvbgoJICogQHJldHVybiBpbnQgYml0cwoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVzdGltYXRlQml0U3RyZWFtU2l6ZSgkaXRlbXMsICR2ZXJzaW9uKSB7CgkJJGJpdHMgPSAwOwoJCWlmICgkdmVyc2lvbiA9PSAwKSB7CgkJCSR2ZXJzaW9uID0gMTsKCQl9CgkJZm9yZWFjaCAoJGl0ZW1zIGFzICRpdGVtKSB7CgkJCXN3aXRjaCgkaXRlbVsnbW9kZSddKSB7CgkJCQljYXNlIFFSX01PREVfTk06IHsKCQkJCQkkYml0cyA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlTnVtKCRpdGVtWydzaXplJ10pOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBRUl9NT0RFX0FOOiB7CgkJCQkJJGJpdHMgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZUFuKCRpdGVtWydzaXplJ10pOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBRUl9NT0RFXzhCOiB7CgkJCQkJJGJpdHMgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoJGl0ZW1bJ3NpemUnXSk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfS0o6IHsKCQkJCQkkYml0cyA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlS2FuamkoJGl0ZW1bJ3NpemUnXSk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfU1Q6IHsKCQkJCQlyZXR1cm4gU1RSVUNUVVJFX0hFQURFUl9CSVRTOwoJCQkJfQoJCQkJZGVmYXVsdDogewoJCQkJCXJldHVybiAwOwoJCQkJfQoJCQl9CgkJCSRsID0gJHRoaXMtPmxlbmd0aEluZGljYXRvcigkaXRlbVsnbW9kZSddLCAkdmVyc2lvbik7CgkJCSRtID0gMSA8PCAkbDsKCQkJJG51bSA9IChpbnQpKCgkaXRlbVsnc2l6ZSddICsgJG0gLSAxKSAvICRtKTsKCQkJJGJpdHMgKz0gJG51bSAqICg0ICsgJGwpOwoJCX0KCQlyZXR1cm4gJGJpdHM7Cgl9CgoJLyoqCgkgKiBlc3RpbWF0ZVZlcnNpb24KCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMKCSAqIEByZXR1cm4gaW50IHZlcnNpb24KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZVZlcnNpb24oJGl0ZW1zKSB7CgkJJHZlcnNpb24gPSAwOwoJCSRwcmV2ID0gMDsKCQlkbyB7CgkJCSRwcmV2ID0gJHZlcnNpb247CgkJCSRiaXRzID0gJHRoaXMtPmVzdGltYXRlQml0U3RyZWFtU2l6ZSgkaXRlbXMsICRwcmV2KTsKCQkJJHZlcnNpb24gPSAkdGhpcy0+Z2V0TWluaW11bVZlcnNpb24oKGludCkoKCRiaXRzICsgNykgLyA4KSwgJHRoaXMtPmxldmVsKTsKCQkJaWYgKCR2ZXJzaW9uIDwgMCkgewoJCQkJcmV0dXJuIC0xOwoJCQl9CgkJfSB3aGlsZSAoJHZlcnNpb24gPiAkcHJldik7CgkJcmV0dXJuICR2ZXJzaW9uOwoJfQoKCS8qKgoJICogbGVuZ3RoT2ZDb2RlCgkgKiBAcGFyYW0gaW50ICRtb2RlCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uCgkgKiBAcGFyYW0gaW50ICRiaXRzCgkgKiBAcmV0dXJuIGludCBzaXplCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbGVuZ3RoT2ZDb2RlKCRtb2RlLCAkdmVyc2lvbiwgJGJpdHMpIHsKCQkkcGF5bG9hZCA9ICRiaXRzIC0gNCAtICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoJG1vZGUsICR2ZXJzaW9uKTsKCQlzd2l0Y2goJG1vZGUpIHsKCQkJY2FzZSBRUl9NT0RFX05NOiB7CgkJCQkkY2h1bmtzID0gKGludCkoJHBheWxvYWQgLyAxMCk7CgkJCQkkcmVtYWluID0gJHBheWxvYWQgLSAkY2h1bmtzICogMTA7CgkJCQkkc2l6ZSA9ICRjaHVua3MgKiAzOwoJCQkJaWYgKCRyZW1haW4gPj0gNykgewoJCQkJCSRzaXplICs9IDI7CgkJCQl9IGVsc2VpZiAoJHJlbWFpbiA+PSA0KSB7CgkJCQkJJHNpemUgKz0gMTsKCQkJCX0KCQkJCWJyZWFrOwoJCQl9CgkJCWNhc2UgUVJfTU9ERV9BTjogewoJCQkJJGNodW5rcyA9IChpbnQpKCRwYXlsb2FkIC8gMTEpOwoJCQkJJHJlbWFpbiA9ICRwYXlsb2FkIC0gJGNodW5rcyAqIDExOwoJCQkJJHNpemUgPSAkY2h1bmtzICogMjsKCQkJCWlmICgkcmVtYWluID49IDYpIHsKCQkJCQkrKyRzaXplOwoJCQkJfQoJCQkJYnJlYWs7CgkJCX0KCQkJY2FzZSBRUl9NT0RFXzhCOiB7CgkJCQkkc2l6ZSA9IChpbnQpKCRwYXlsb2FkIC8gOCk7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlIFFSX01PREVfS0o6IHsKCQkJCSRzaXplID0gKGludCkoKCRwYXlsb2FkIC8gMTMpICogMik7CgkJCQlicmVhazsKCQkJfQoJCQljYXNlIFFSX01PREVfU1Q6IHsKCQkJCSRzaXplID0gKGludCkoJHBheWxvYWQgLyA4KTsKCQkJCWJyZWFrOwoJCQl9CgkJCWRlZmF1bHQ6IHsKCQkJCSRzaXplID0gMDsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCSRtYXhzaXplID0gJHRoaXMtPm1heGltdW1Xb3JkcygkbW9kZSwgJHZlcnNpb24pOwoJCWlmICgkc2l6ZSA8IDApIHsKCQkJJHNpemUgPSAwOwoJCX0KCQlpZiAoJHNpemUgPiAkbWF4c2l6ZSkgewoJCQkkc2l6ZSA9ICRtYXhzaXplOwoJCX0KCQlyZXR1cm4gJHNpemU7Cgl9CgoJLyoqCgkgKiBjcmVhdGVCaXRTdHJlYW0KCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMKCSAqIEByZXR1cm4gYXJyYXkgb2YgaXRlbXMgYW5kIHRvdGFsIGJpdHMKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBjcmVhdGVCaXRTdHJlYW0oJGl0ZW1zKSB7CgkJJHRvdGFsID0gMDsKCQlmb3JlYWNoICgkaXRlbXMgYXMgJGtleSA9PiAkaXRlbSkgewoJCQkkaXRlbXNbJGtleV0gPSAkdGhpcy0+ZW5jb2RlQml0U3RyZWFtKCRpdGVtLCAkdGhpcy0+dmVyc2lvbik7CgkJCSRiaXRzID0gY291bnQoJGl0ZW1zWyRrZXldWydic3RyZWFtJ10pOwoJCQkkdG90YWwgKz0gJGJpdHM7CgkJfQoJCXJldHVybiBhcnJheSgkaXRlbXMsICR0b3RhbCk7Cgl9CgoJLyoqCgkgKiBjb252ZXJ0RGF0YQoJICogQHBhcmFtIGFycmF5ICRpdGVtcwoJICogQHJldHVybiBhcnJheSBpdGVtcwoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGNvbnZlcnREYXRhKCRpdGVtcykgewoJCSR2ZXIgPSAkdGhpcy0+ZXN0aW1hdGVWZXJzaW9uKCRpdGVtcyk7CgkJaWYgKCR2ZXIgPiAkdGhpcy0+dmVyc2lvbikgewoJCQkkdGhpcy0+dmVyc2lvbiA9ICR2ZXI7CgkJfQoJCXdoaWxlICh0cnVlKSB7CgkJCSRjYnMgPSAkdGhpcy0+Y3JlYXRlQml0U3RyZWFtKCRpdGVtcyk7CgkJCSRpdGVtcyA9ICRjYnNbMF07CgkJCSRiaXRzID0gJGNic1sxXTsKCQkJaWYgKCRiaXRzIDwgMCkgewoJCQkJcmV0dXJuIC0xOwoJCQl9CgkJCSR2ZXIgPSAkdGhpcy0+Z2V0TWluaW11bVZlcnNpb24oKGludCkoKCRiaXRzICsgNykgLyA4KSwgJHRoaXMtPmxldmVsKTsKCQkJaWYgKCR2ZXIgPCAwKSB7CgkJCQlyZXR1cm4gLTE7CgkJCX0gZWxzZWlmICgkdmVyID4gJHRoaXMtPnZlcnNpb24pIHsKCQkJCSR0aGlzLT52ZXJzaW9uID0gJHZlcjsKCQkJfSBlbHNlIHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCXJldHVybiAkaXRlbXM7Cgl9CgoJLyoqCgkgKiBBcHBlbmQgUGFkZGluZyBCaXQgdG8gYml0c3RyZWFtCgkgKiBAcGFyYW0gYXJyYXkgJGJzdHJlYW0KCSAqIEByZXR1cm4gYXJyYXkgYml0c3RyZWFtCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gYXBwZW5kUGFkZGluZ0JpdCgkYnN0cmVhbSkgewoJIAlpZiAoaXNfbnVsbCgkYnN0cmVhbSkpIHsKCSAJCXJldHVybiBudWxsOwoJIAl9CgkJJGJpdHMgPSBjb3VudCgkYnN0cmVhbSk7CgkJJG1heHdvcmRzID0gJHRoaXMtPmdldERhdGFMZW5ndGgoJHRoaXMtPnZlcnNpb24sICR0aGlzLT5sZXZlbCk7CgkJJG1heGJpdHMgPSAkbWF4d29yZHMgKiA4OwoJCWlmICgkbWF4Yml0cyA9PSAkYml0cykgewoJCQlyZXR1cm4gJGJzdHJlYW07CgkJfQoJCWlmICgkbWF4Yml0cyAtICRiaXRzIDwgNSkgewoJCQlyZXR1cm4gJHRoaXMtPmFwcGVuZE51bSgkYnN0cmVhbSwgJG1heGJpdHMgLSAkYml0cywgMCk7CgkJfQoJCSRiaXRzICs9IDQ7CgkJJHdvcmRzID0gKGludCkoKCRiaXRzICsgNykgLyA4KTsKCQkkcGFkZGluZyA9IGFycmF5KCk7CgkJJHBhZGRpbmcgPSAkdGhpcy0+YXBwZW5kTnVtKCRwYWRkaW5nLCAkd29yZHMgKiA4IC0gJGJpdHMgKyA0LCAwKTsKCQkkcGFkbGVuID0gJG1heHdvcmRzIC0gJHdvcmRzOwoJCWlmICgkcGFkbGVuID4gMCkgewoJCQkkcGFkYnVmID0gYXJyYXkoKTsKCQkJZm9yICgkaT0wOyAkaTwkcGFkbGVuOyArKyRpKSB7CgkJCQkkcGFkYnVmWyRpXSA9ICgkaSYxKT8weDExOjB4ZWM7CgkJCX0KCQkJJHBhZGRpbmcgPSAkdGhpcy0+YXBwZW5kQnl0ZXMoJHBhZGRpbmcsICRwYWRsZW4sICRwYWRidWYpOwoJCX0KCQlyZXR1cm4gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkYnN0cmVhbSwgJHBhZGRpbmcpOwoJfQoKCS8qKgoJICogbWVyZ2VCaXRTdHJlYW0KCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMgaXRlbXMKCSAqIEByZXR1cm4gYXJyYXkgYml0c3RyZWFtCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWVyZ2VCaXRTdHJlYW0oJGl0ZW1zKSB7CgkJJGl0ZW1zID0gJHRoaXMtPmNvbnZlcnREYXRhKCRpdGVtcyk7CgkJaWYgKCFpc19hcnJheSgkaXRlbXMpKSB7CgkJCXJldHVybiBudWxsOwoJCX0KCQkkYnN0cmVhbSA9IGFycmF5KCk7CgkJZm9yZWFjaCAoJGl0ZW1zIGFzICRpdGVtKSB7CgkJCSRic3RyZWFtID0gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkYnN0cmVhbSwgJGl0ZW1bJ2JzdHJlYW0nXSk7CgkJfQoJCXJldHVybiAkYnN0cmVhbTsKCX0KCgkvKioKCSAqIFJldHVybnMgYSBzdHJlYW0gb2YgYml0cy4KCSAqIEBwYXJhbSBpbnQgJGl0ZW1zCgkgKiBAcmV0dXJuIGFycmF5IHBhZGRlZCBtZXJnZWQgYnl0ZSBzdHJlYW0KCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEJpdFN0cmVhbSgkaXRlbXMpIHsKCQkkYnN0cmVhbSA9ICR0aGlzLT5tZXJnZUJpdFN0cmVhbSgkaXRlbXMpOwoJCXJldHVybiAkdGhpcy0+YXBwZW5kUGFkZGluZ0JpdCgkYnN0cmVhbSk7Cgl9CgoJLyoqCgkgKiBQYWNrIGFsbCBiaXQgc3RyZWFtcyBwYWRkaW5nIGJpdHMgaW50byBhIGJ5dGUgYXJyYXkuCgkgKiBAcGFyYW0gaW50ICRpdGVtcwoJICogQHJldHVybiBhcnJheSBwYWRkZWQgbWVyZ2VkIGJ5dGUgc3RyZWFtCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRCeXRlU3RyZWFtKCRpdGVtcykgewoJCSRic3RyZWFtID0gJHRoaXMtPmdldEJpdFN0cmVhbSgkaXRlbXMpOwoJCXJldHVybiAkdGhpcy0+Yml0c3RyZWFtVG9CeXRlKCRic3RyZWFtKTsKCX0KCgkvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCgoJLy8gUVJiaXRzdHJlYW0KCgkvKioKCSAqIFJldHVybiBhbiBhcnJheSB3aXRoIHplcm9zCgkgKiBAcGFyYW0gaW50ICRzZXRMZW5ndGggYXJyYXkgc2l6ZQoJICogQHJldHVybiBhcnJheQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGFsbG9jYXRlKCRzZXRMZW5ndGgpIHsKCQlyZXR1cm4gYXJyYXlfZmlsbCgwLCAkc2V0TGVuZ3RoLCAwKTsKCX0KCgkvKioKCSAqIFJldHVybiBuZXcgYml0c3RyZWFtIGZyb20gbnVtYmVyCgkgKiBAcGFyYW0gaW50ICRiaXRzIG51bWJlciBvZiBiaXRzCgkgKiBAcGFyYW0gaW50ICRudW0gbnVtYmVyCgkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG5ld0Zyb21OdW0oJGJpdHMsICRudW0pIHsKCQkkYnN0cmVhbSA9ICR0aGlzLT5hbGxvY2F0ZSgkYml0cyk7CgkJJG1hc2sgPSAxIDw8ICgkYml0cyAtIDEpOwoJCWZvciAoJGk9MDsgJGk8JGJpdHM7ICsrJGkpIHsKCQkJaWYgKCRudW0gJiAkbWFzaykgewoJCQkJJGJzdHJlYW1bJGldID0gMTsKCQkJfSBlbHNlIHsKCQkJCSRic3RyZWFtWyRpXSA9IDA7CgkJCX0KCQkJJG1hc2sgPSAkbWFzayA+PiAxOwoJCX0KCQlyZXR1cm4gJGJzdHJlYW07Cgl9CgoJLyoqCgkgKiBSZXR1cm4gbmV3IGJpdHN0cmVhbSBmcm9tIGJ5dGVzCgkgKiBAcGFyYW0gaW50ICRzaXplIHNpemUKCSAqIEBwYXJhbSBhcnJheSAkZGF0YSBieXRlcwoJICogQHJldHVybiBhcnJheSBiaXRzdHJlYW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBuZXdGcm9tQnl0ZXMoJHNpemUsICRkYXRhKSB7CgkJJGJzdHJlYW0gPSAkdGhpcy0+YWxsb2NhdGUoJHNpemUgKiA4KTsKCQkkcD0wOwoJCWZvciAoJGk9MDsgJGk8JHNpemU7ICsrJGkpIHsKCQkJJG1hc2sgPSAweDgwOwoJCQlmb3IgKCRqPTA7ICRqPDg7ICsrJGopIHsKCQkJCWlmICgkZGF0YVskaV0gJiAkbWFzaykgewoJCQkJCSRic3RyZWFtWyRwXSA9IDE7CgkJCQl9IGVsc2UgewoJCQkJCSRic3RyZWFtWyRwXSA9IDA7CgkJCQl9CgkJCQkkcCsrOwoJCQkJJG1hc2sgPSAkbWFzayA+PiAxOwoJCQl9CgkJfQoJCXJldHVybiAkYnN0cmVhbTsKCX0KCgkvKioKCSAqIEFwcGVuZCBvbmUgYml0c3RyZWFtIHRvIGFub3RoZXIKCSAqIEBwYXJhbSBhcnJheSAkYml0c3RyZWFtIG9yaWdpbmFsIGJpdHN0cmVhbQoJICogQHBhcmFtIGFycmF5ICRhcHBlbmQgYml0c3RyZWFtIHRvIGFwcGVuZAoJICogQHJldHVybiBhcnJheSBiaXRzdHJlYW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBhcHBlbmRCaXRzdHJlYW0oJGJpdHN0cmVhbSwgJGFwcGVuZCkgewoJCWlmICgoIWlzX2FycmF5KCRhcHBlbmQpKSBPUiAoY291bnQoJGFwcGVuZCkgPT0gMCkpIHsKCQkJcmV0dXJuICRiaXRzdHJlYW07CgkJfQoJCWlmIChjb3VudCgkYml0c3RyZWFtKSA9PSAwKSB7CgkJCXJldHVybiAkYXBwZW5kOwoJCX0KCQlyZXR1cm4gYXJyYXlfdmFsdWVzKGFycmF5X21lcmdlKCRiaXRzdHJlYW0sICRhcHBlbmQpKTsKCX0KCgkvKioKCSAqIEFwcGVuZCBvbmUgYml0c3RyZWFtIGNyZWF0ZWQgZnJvbSBudW1iZXIgdG8gYW5vdGhlcgoJICogQHBhcmFtIGFycmF5ICRiaXRzdHJlYW0gb3JpZ2luYWwgYml0c3RyZWFtCgkgKiBAcGFyYW0gaW50ICRiaXRzIG51bWJlciBvZiBiaXRzCgkgKiBAcGFyYW0gaW50ICRudW0gbnVtYmVyCgkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGFwcGVuZE51bSgkYml0c3RyZWFtLCAkYml0cywgJG51bSkgewoJCWlmICgkYml0cyA9PSAwKSB7CgkJCXJldHVybiAwOwoJCX0KCQkkYiA9ICR0aGlzLT5uZXdGcm9tTnVtKCRiaXRzLCAkbnVtKTsKCQlyZXR1cm4gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkYml0c3RyZWFtLCAkYik7Cgl9CgoJLyoqCgkgKiBBcHBlbmQgb25lIGJpdHN0cmVhbSBjcmVhdGVkIGZyb20gYnl0ZXMgdG8gYW5vdGhlcgoJICogQHBhcmFtIGFycmF5ICRiaXRzdHJlYW0gb3JpZ2luYWwgYml0c3RyZWFtCgkgKiBAcGFyYW0gaW50ICRzaXplIHNpemUKCSAqIEBwYXJhbSBhcnJheSAkZGF0YSBieXRlcwoJICogQHJldHVybiBhcnJheSBiaXRzdHJlYW0KCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBhcHBlbmRCeXRlcygkYml0c3RyZWFtLCAkc2l6ZSwgJGRhdGEpIHsKCQlpZiAoJHNpemUgPT0gMCkgewoJCQlyZXR1cm4gMDsKCQl9CgkJJGIgPSAkdGhpcy0+bmV3RnJvbUJ5dGVzKCRzaXplLCAkZGF0YSk7CgkJcmV0dXJuICR0aGlzLT5hcHBlbmRCaXRzdHJlYW0oJGJpdHN0cmVhbSwgJGIpOwoJfQoKCS8qKgoJICogQ29udmVydCBiaXRzdHJlYW0gdG8gYnl0ZXMKCSAqIEBwYXJhbSBhcnJheSAkYnN0cmVhbSBvcmlnaW5hbCBiaXRzdHJlYW0KCSAqIEByZXR1cm4gYXJyYXkgb2YgYnl0ZXMKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiBiaXRzdHJlYW1Ub0J5dGUoJGJzdHJlYW0pIHsKCQlpZiAoaXNfbnVsbCgkYnN0cmVhbSkpIHsKCSAJCXJldHVybiBudWxsOwoJIAl9CgkJJHNpemUgPSBjb3VudCgkYnN0cmVhbSk7CgkJaWYgKCRzaXplID09IDApIHsKCQkJcmV0dXJuIGFycmF5KCk7CgkJfQoJCSRkYXRhID0gYXJyYXlfZmlsbCgwLCAoaW50KSgoJHNpemUgKyA3KSAvIDgpLCAwKTsKCQkkYnl0ZXMgPSAoaW50KSgkc2l6ZSAvIDgpOwoJCSRwID0gMDsKCQlmb3IgKCRpPTA7ICRpPCRieXRlczsgJGkrKykgewoJCQkkdiA9IDA7CgkJCWZvciAoJGo9MDsgJGo8ODsgJGorKykgewoJCQkJJHYgPSAkdiA8PCAxOwoJCQkJJHYgfD0gJGJzdHJlYW1bJHBdOwoJCQkJJHArKzsKCQkJfQoJCQkkZGF0YVskaV0gPSAkdjsKCQl9CgkJaWYgKCRzaXplICYgNykgewoJCQkkdiA9IDA7CgkJCWZvciAoJGo9MDsgJGo8KCRzaXplICYgNyk7ICRqKyspIHsKCQkJCSR2ID0gJHYgPDwgMTsKCQkJCSR2IHw9ICRic3RyZWFtWyRwXTsKCQkJCSRwKys7CgkJCX0KCQkJJGRhdGFbJGJ5dGVzXSA9ICR2OwoJCX0KCQlyZXR1cm4gJGRhdGE7Cgl9CgoJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCS8vIFFSc3BlYwoKCS8qKgoJICogUmVwbGFjZSBhIHZhbHVlIG9uIHRoZSBhcnJheSBhdCB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uCgkgKiBAcGFyYW0gYXJyYXkgJHNyY3RhYgoJICogQHBhcmFtIGludCAkeCBYIHBvc2l0aW9uCgkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCSAqIEBwYXJhbSBzdHJpbmcgJHJlcGwgdmFsdWUgdG8gcmVwbGFjZQoJICogQHBhcmFtIGludCAkcmVwbExlbiBsZW5ndGggb2YgdGhlIHJlcGwgc3RyaW5nCgkgKiBAcmV0dXJuIGFycmF5IHNyY3RhYgoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHFyc3Ryc2V0KCRzcmN0YWIsICR4LCAkeSwgJHJlcGwsICRyZXBsTGVuPWZhbHNlKSB7CgkJJHNyY3RhYlskeV0gPSBzdWJzdHJfcmVwbGFjZSgkc3JjdGFiWyR5XSwgKCRyZXBsTGVuICE9PSBmYWxzZSk/c3Vic3RyKCRyZXBsLDAsJHJlcGxMZW4pOiRyZXBsLCAkeCwgKCRyZXBsTGVuICE9PSBmYWxzZSk/JHJlcGxMZW46c3RybGVuKCRyZXBsKSk7CgkJcmV0dXJuICRzcmN0YWI7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gbWF4aW11bSBkYXRhIGNvZGUgbGVuZ3RoIChieXRlcykgZm9yIHRoZSB2ZXJzaW9uLgoJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgKiBAcmV0dXJuIGludCBtYXhpbXVtIHNpemUgKGJ5dGVzKQoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0RGF0YUxlbmd0aCgkdmVyc2lvbiwgJGxldmVsKSB7CgkJcmV0dXJuICR0aGlzLT5jYXBhY2l0eVskdmVyc2lvbl1bUVJDQVBfV09SRFNdIC0gJHRoaXMtPmNhcGFjaXR5WyR2ZXJzaW9uXVtRUkNBUF9FQ11bJGxldmVsXTsKCX0KCgkvKioKCSAqIFJldHVybiBtYXhpbXVtIGVycm9yIGNvcnJlY3Rpb24gY29kZSBsZW5ndGggKGJ5dGVzKSBmb3IgdGhlIHZlcnNpb24uCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCSAqIEBwYXJhbSBpbnQgJGxldmVsIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAqIEByZXR1cm4gaW50IEVDQyBzaXplIChieXRlcykKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEVDQ0xlbmd0aCgkdmVyc2lvbiwgJGxldmVsKXsKCQlyZXR1cm4gJHRoaXMtPmNhcGFjaXR5WyR2ZXJzaW9uXVtRUkNBUF9FQ11bJGxldmVsXTsKCX0KCgkvKioKCSAqIFJldHVybiB0aGUgd2lkdGggb2YgdGhlIHN5bWJvbCBmb3IgdGhlIHZlcnNpb24uCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCSAqIEByZXR1cm4gaW50IHdpZHRoCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRXaWR0aCgkdmVyc2lvbikgewoJCXJldHVybiAkdGhpcy0+Y2FwYWNpdHlbJHZlcnNpb25dW1FSQ0FQX1dJRFRIXTsKCX0KCgkvKioKCSAqIFJldHVybiB0aGUgbnVtZXIgb2YgcmVtYWluZGVyIGJpdHMuCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCSAqIEByZXR1cm4gaW50IG51bWJlciBvZiByZW1haW5kZXIgYml0cwoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0UmVtYWluZGVyKCR2ZXJzaW9uKSB7CgkJcmV0dXJuICR0aGlzLT5jYXBhY2l0eVskdmVyc2lvbl1bUVJDQVBfUkVNSU5ERVJdOwoJfQoKCS8qKgoJICogUmV0dXJuIGEgdmVyc2lvbiBudW1iZXIgdGhhdCBzYXRpc2ZpZXMgdGhlIGlucHV0IGNvZGUgbGVuZ3RoLgoJICogQHBhcmFtIGludCAkc2l6ZSBpbnB1dCBjb2RlIGxlbmd0aCAoYnl0ZXMpCgkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgKiBAcmV0dXJuIGludCB2ZXJzaW9uIG51bWJlcgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0TWluaW11bVZlcnNpb24oJHNpemUsICRsZXZlbCkgewoJCWZvciAoJGkgPSAxOyAkaSA8PSBRUlNQRUNfVkVSU0lPTl9NQVg7ICsrJGkpIHsKCQkJJHdvcmRzID0gKCR0aGlzLT5jYXBhY2l0eVskaV1bUVJDQVBfV09SRFNdIC0gJHRoaXMtPmNhcGFjaXR5WyRpXVtRUkNBUF9FQ11bJGxldmVsXSk7CgkJCWlmICgkd29yZHMgPj0gJHNpemUpIHsKCQkJCXJldHVybiAkaTsKCQkJfQoJCX0KCQkvLyB0aGUgc2l6ZSBvZiBpbnB1dCBkYXRhIGlzIGdyZWF0ZXIgdGhhbiBRUiBjYXBhY2l0eSwgdHJ5IHRvIGxvdmVyIHRoZSBlcnJvciBjb3JyZWN0aW9uIG1vZGUKCQlyZXR1cm4gLTE7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gdGhlIHNpemUgb2YgbGVuZ3RoIGluZGljYXRvciBmb3IgdGhlIG1vZGUgYW5kIHZlcnNpb24uCgkgKiBAcGFyYW0gaW50ICRtb2RlIGVuY29kaW5nIG1vZGUKCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJICogQHJldHVybiBpbnQgdGhlIHNpemUgb2YgdGhlIGFwcHJvcHJpYXRlIGxlbmd0aCBpbmRpY2F0b3IgKGJpdHMpLgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gbGVuZ3RoSW5kaWNhdG9yKCRtb2RlLCAkdmVyc2lvbikgewoJCWlmICgkbW9kZSA9PSBRUl9NT0RFX1NUKSB7CgkJCXJldHVybiAwOwoJCX0KCQlpZiAoJHZlcnNpb24gPD0gOSkgewoJCQkkbCA9IDA7CgkJfSBlbHNlaWYgKCR2ZXJzaW9uIDw9IDI2KSB7CgkJCSRsID0gMTsKCQl9IGVsc2UgewoJCQkkbCA9IDI7CgkJfQoJCXJldHVybiAkdGhpcy0+bGVuZ3RoVGFibGVCaXRzWyRtb2RlXVskbF07Cgl9CgoJLyoqCgkgKiBSZXR1cm4gdGhlIG1heGltdW0gbGVuZ3RoIGZvciB0aGUgbW9kZSBhbmQgdmVyc2lvbi4KCSAqIEBwYXJhbSBpbnQgJG1vZGUgZW5jb2RpbmcgbW9kZQoJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkgKiBAcmV0dXJuIGludCB0aGUgbWF4aW11bSBsZW5ndGggKGJ5dGVzKQoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gbWF4aW11bVdvcmRzKCRtb2RlLCAkdmVyc2lvbikgewoJCWlmICgkbW9kZSA9PSBRUl9NT0RFX1NUKSB7CgkJCXJldHVybiAzOwoJCX0KCQlpZiAoJHZlcnNpb24gPD0gOSkgewoJCQkkbCA9IDA7CgkJfSBlbHNlIGlmICgkdmVyc2lvbiA8PSAyNikgewoJCQkkbCA9IDE7CgkJfSBlbHNlIHsKCQkJJGwgPSAyOwoJCX0KCQkkYml0cyA9ICR0aGlzLT5sZW5ndGhUYWJsZUJpdHNbJG1vZGVdWyRsXTsKCQkkd29yZHMgPSAoMSA8PCAkYml0cykgLSAxOwoJCWlmICgkbW9kZSA9PSBRUl9NT0RFX0tKKSB7CgkJCSR3b3JkcyAqPSAyOyAvLyB0aGUgbnVtYmVyIG9mIGJ5dGVzIGlzIHJlcXVpcmVkCgkJfQoJCXJldHVybiAkd29yZHM7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gYW4gYXJyYXkgb2YgRUNDIHNwZWNpZmljYXRpb24uCgkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCSAqIEBwYXJhbSBpbnQgJGxldmVsIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAqIEBwYXJhbSBhcnJheSAkc3BlYyBhbiBhcnJheSBvZiBFQ0Mgc3BlY2lmaWNhdGlvbiBjb250YWlucyBhcyBmb2xsb3dpbmc6IHsjIG9mIHR5cGUxIGJsb2NrcywgIyBvZiBkYXRhIGNvZGUsICMgb2YgZWNjIGNvZGUsICMgb2YgdHlwZTIgYmxvY2tzLCAjIG9mIGRhdGEgY29kZX0KCSAqIEByZXR1cm4gYXJyYXkgc3BlYwoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0RWNjU3BlYygkdmVyc2lvbiwgJGxldmVsLCAkc3BlYykgewoJCWlmIChjb3VudCgkc3BlYykgPCA1KSB7CgkJCSRzcGVjID0gYXJyYXkoMCwgMCwgMCwgMCwgMCk7CgkJfQoJCSRiMSA9ICR0aGlzLT5lY2NUYWJsZVskdmVyc2lvbl1bJGxldmVsXVswXTsKCQkkYjIgPSAkdGhpcy0+ZWNjVGFibGVbJHZlcnNpb25dWyRsZXZlbF1bMV07CgkJJGRhdGEgPSAkdGhpcy0+Z2V0RGF0YUxlbmd0aCgkdmVyc2lvbiwgJGxldmVsKTsKCQkkZWNjID0gJHRoaXMtPmdldEVDQ0xlbmd0aCgkdmVyc2lvbiwgJGxldmVsKTsKCQlpZiAoJGIyID09IDApIHsKCQkJJHNwZWNbMF0gPSAkYjE7CgkJCSRzcGVjWzFdID0gKGludCkoJGRhdGEgLyAkYjEpOwoJCQkkc3BlY1syXSA9IChpbnQpKCRlY2MgLyAkYjEpOwoJCQkkc3BlY1szXSA9IDA7CgkJCSRzcGVjWzRdID0gMDsKCQl9IGVsc2UgewoJCQkkc3BlY1swXSA9ICRiMTsKCQkJJHNwZWNbMV0gPSAoaW50KSgkZGF0YSAvICgkYjEgKyAkYjIpKTsKCQkJJHNwZWNbMl0gPSAoaW50KSgkZWNjICAvICgkYjEgKyAkYjIpKTsKCQkJJHNwZWNbM10gPSAkYjI7CgkJCSRzcGVjWzRdID0gJHNwZWNbMV0gKyAxOwoJCX0KCQlyZXR1cm4gJHNwZWM7Cgl9CgoJLyoqCgkgKiBQdXQgYW4gYWxpZ25tZW50IG1hcmtlci4KCSAqIEBwYXJhbSBhcnJheSAkZnJhbWUgZnJhbWUKCSAqIEBwYXJhbSBpbnQgJG94IFggY2VudGVyIGNvb3JkaW5hdGUgb2YgdGhlIHBhdHRlcm4KCSAqIEBwYXJhbSBpbnQgJG95IFkgY2VudGVyIGNvb3JkaW5hdGUgb2YgdGhlIHBhdHRlcm4KCSAqIEByZXR1cm4gYXJyYXkgZnJhbWUKCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIHB1dEFsaWdubWVudE1hcmtlcigkZnJhbWUsICRveCwgJG95KSB7CgkJJGZpbmRlciA9IGFycmF5KAoJCQkiXHhhMVx4YTFceGExXHhhMVx4YTEiLAoJCQkiXHhhMVx4YTBceGEwXHhhMFx4YTEiLAoJCQkiXHhhMVx4YTBceGExXHhhMFx4YTEiLAoJCQkiXHhhMVx4YTBceGEwXHhhMFx4YTEiLAoJCQkiXHhhMVx4YTFceGExXHhhMVx4YTEiCgkJCSk7CgkJJHlTdGFydCA9ICRveSAtIDI7CgkJJHhTdGFydCA9ICRveCAtIDI7CgkJZm9yICgkeT0wOyAkeSA8IDU7ICR5KyspIHsKCQkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJHhTdGFydCwgJHlTdGFydCskeSwgJGZpbmRlclskeV0pOwoJCX0KCQlyZXR1cm4gJGZyYW1lOwoJfQoKCS8qKgoJICogUHV0IGFuIGFsaWdubWVudCBwYXR0ZXJuLgoJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkgKiBAcGFyYW0gYXJyYXkgJGZyYW1lIGZyYW1lCgkgKiBAcGFyYW0gaW50ICR3aWR0aCB3aWR0aAoJICogQHJldHVybiBhcnJheSBmcmFtZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHB1dEFsaWdubWVudFBhdHRlcm4oJHZlcnNpb24sICRmcmFtZSwgJHdpZHRoKSB7CgkJaWYgKCR2ZXJzaW9uIDwgMikgewoJCQlyZXR1cm4gJGZyYW1lOwoJCX0KCQkkZCA9ICR0aGlzLT5hbGlnbm1lbnRQYXR0ZXJuWyR2ZXJzaW9uXVsxXSAtICR0aGlzLT5hbGlnbm1lbnRQYXR0ZXJuWyR2ZXJzaW9uXVswXTsKCQlpZiAoJGQgPCAwKSB7CgkJCSR3ID0gMjsKCQl9IGVsc2UgewoJCQkkdyA9IChpbnQpKCgkd2lkdGggLSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF0pIC8gJGQgKyAyKTsKCQl9CgkJaWYgKCR3ICogJHcgLSAzID09IDEpIHsKCQkJJHggPSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF07CgkJCSR5ID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCQkkZnJhbWUgPSAkdGhpcy0+cHV0QWxpZ25tZW50TWFya2VyKCRmcmFtZSwgJHgsICR5KTsKCQkJcmV0dXJuICRmcmFtZTsKCQl9CgkJJGN4ID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCSR3byA9ICR3IC0gMTsKCQlmb3IgKCR4PTE7ICR4IDwgJHdvOyArKyR4KSB7CgkJCSRmcmFtZSA9ICR0aGlzLT5wdXRBbGlnbm1lbnRNYXJrZXIoJGZyYW1lLCA2LCAkY3gpOwoJCQkkZnJhbWUgPSAkdGhpcy0+cHV0QWxpZ25tZW50TWFya2VyKCRmcmFtZSwgJGN4LCAgNik7CgkJCSRjeCArPSAkZDsKCQl9CgkJJGN5ID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCWZvciAoJHk9MDsgJHkgPCAkd287ICsrJHkpIHsKCQkJJGN4ID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCQlmb3IgKCR4PTA7ICR4IDwgJHdvOyArKyR4KSB7CgkJCQkkZnJhbWUgPSAkdGhpcy0+cHV0QWxpZ25tZW50TWFya2VyKCRmcmFtZSwgJGN4LCAkY3kpOwoJCQkJJGN4ICs9ICRkOwoJCQl9CgkJCSRjeSArPSAkZDsKCQl9CgkJcmV0dXJuICRmcmFtZTsKCX0KCgkvKioKCSAqIFJldHVybiBCQ0ggZW5jb2RlZCB2ZXJzaW9uIGluZm9ybWF0aW9uIHBhdHRlcm4gdGhhdCBpcyB1c2VkIGZvciB0aGUgc3ltYm9sIG9mIHZlcnNpb24gNyBvciBncmVhdGVyLiBVc2UgbG93ZXIgMTggYml0cy4KCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJICogQHJldHVybiBzdHJpbmcgQkNIIGVuY29kZWQgdmVyc2lvbiBpbmZvcm1hdGlvbiBwYXR0ZXJuCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRWZXJzaW9uUGF0dGVybigkdmVyc2lvbikgewoJCWlmICgoJHZlcnNpb24gPCA3KSBPUiAoJHZlcnNpb24gPiBRUlNQRUNfVkVSU0lPTl9NQVgpKSB7CgkJCXJldHVybiAwOwoJCX0KCQlyZXR1cm4gJHRoaXMtPnZlcnNpb25QYXR0ZXJuWygkdmVyc2lvbiAtIDcpXTsKCX0KCgkvKioKCSAqIFJldHVybiBCQ0ggZW5jb2RlZCBmb3JtYXQgaW5mb3JtYXRpb24gcGF0dGVybi4KCSAqIEBwYXJhbSBhcnJheSAkbWFzawoJICogQHBhcmFtIGludCAkbGV2ZWwgZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICogQHJldHVybiBzdHJpbmcgQkNIIGVuY29kZWQgZm9ybWF0IGluZm9ybWF0aW9uIHBhdHRlcm4KCSAqLwoJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEZvcm1hdEluZm8oJG1hc2ssICRsZXZlbCkgewoJCWlmICgoJG1hc2sgPCAwKSBPUiAoJG1hc2sgPiA3KSkgewoJCQlyZXR1cm4gMDsKCQl9CgkJaWYgKCgkbGV2ZWwgPCAwKSBPUiAoJGxldmVsID4gMykpIHsKCQkJcmV0dXJuIDA7CgkJfQoJCXJldHVybiAkdGhpcy0+Zm9ybWF0SW5mb1skbGV2ZWxdWyRtYXNrXTsKCX0KCgkvKioKCSAqIFB1dCBhIGZpbmRlciBwYXR0ZXJuLgoJICogQHBhcmFtIGFycmF5ICRmcmFtZSBmcmFtZQoJICogQHBhcmFtIGludCAkb3ggWCBjZW50ZXIgY29vcmRpbmF0ZSBvZiB0aGUgcGF0dGVybgoJICogQHBhcmFtIGludCAkb3kgWSBjZW50ZXIgY29vcmRpbmF0ZSBvZiB0aGUgcGF0dGVybgoJICogQHJldHVybiBhcnJheSBmcmFtZQoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gcHV0RmluZGVyUGF0dGVybigkZnJhbWUsICRveCwgJG95KSB7CgkJJGZpbmRlciA9IGFycmF5KAoJCSJceGMxXHhjMVx4YzFceGMxXHhjMVx4YzFceGMxIiwKCQkiXHhjMVx4YzBceGMwXHhjMFx4YzBceGMwXHhjMSIsCgkJIlx4YzFceGMwXHhjMVx4YzFceGMxXHhjMFx4YzEiLAoJCSJceGMxXHhjMFx4YzFceGMxXHhjMVx4YzBceGMxIiwKCQkiXHhjMVx4YzBceGMxXHhjMVx4YzFceGMwXHhjMSIsCgkJIlx4YzFceGMwXHhjMFx4YzBceGMwXHhjMFx4YzEiLAoJCSJceGMxXHhjMVx4YzFceGMxXHhjMVx4YzFceGMxIgoJCSk7CgkJZm9yICgkeT0wOyAkeSA8IDc7ICR5KyspIHsKCQkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJG94LCAoJG95ICsgJHkpLCAkZmluZGVyWyR5XSk7CgkJfQoJCXJldHVybiAkZnJhbWU7Cgl9CgoJLyoqCgkgKiBSZXR1cm4gYSBjb3B5IG9mIGluaXRpYWxpemVkIGZyYW1lLgoJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkgKiBAcmV0dXJuIGFycmF5IGFycmF5IG9mIHVuc2lnbmVkIGNoYXIuCgkgKi8KCXByb3RlY3RlZCBmdW5jdGlvbiBjcmVhdGVGcmFtZSgkdmVyc2lvbikgewoJCSR3aWR0aCA9ICR0aGlzLT5jYXBhY2l0eVskdmVyc2lvbl1bUVJDQVBfV0lEVEhdOwoJCSRmcmFtZUxpbmUgPSBzdHJfcmVwZWF0ICgiXDAiLCAkd2lkdGgpOwoJCSRmcmFtZSA9IGFycmF5X2ZpbGwoMCwgJHdpZHRoLCAkZnJhbWVMaW5lKTsKCQkvLyBGaW5kZXIgcGF0dGVybgoJCSRmcmFtZSA9ICR0aGlzLT5wdXRGaW5kZXJQYXR0ZXJuKCRmcmFtZSwgMCwgMCk7CgkJJGZyYW1lID0gJHRoaXMtPnB1dEZpbmRlclBhdHRlcm4oJGZyYW1lLCAkd2lkdGggLSA3LCAwKTsKCQkkZnJhbWUgPSAkdGhpcy0+cHV0RmluZGVyUGF0dGVybigkZnJhbWUsIDAsICR3aWR0aCAtIDcpOwoJCS8vIFNlcGFyYXRvcgoJCSR5T2Zmc2V0ID0gJHdpZHRoIC0gNzsKCQlmb3IgKCR5PTA7ICR5IDwgNzsgKyskeSkgewoJCQkkZnJhbWVbJHldWzddID0gIlx4YzAiOwoJCQkkZnJhbWVbJHldWyR3aWR0aCAtIDhdID0gIlx4YzAiOwoJCQkkZnJhbWVbJHlPZmZzZXRdWzddID0gIlx4YzAiOwoJCQkrKyR5T2Zmc2V0OwoJCX0KCQkkc2V0UGF0dGVybiA9IHN0cl9yZXBlYXQoIlx4YzAiLCA4KTsKCQkkZnJhbWUgPSAkdGhpcy0+cXJzdHJzZXQoJGZyYW1lLCAwLCA3LCAkc2V0UGF0dGVybik7CgkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJHdpZHRoLTgsIDcsICRzZXRQYXR0ZXJuKTsKCQkkZnJhbWUgPSAkdGhpcy0+cXJzdHJzZXQoJGZyYW1lLCAwLCAkd2lkdGggLSA4LCAkc2V0UGF0dGVybik7CgkJLy8gRm9ybWF0IGluZm8KCQkkc2V0UGF0dGVybiA9IHN0cl9yZXBlYXQoIlx4ODQiLCA5KTsKCQkkZnJhbWUgPSAkdGhpcy0+cXJzdHJzZXQoJGZyYW1lLCAwLCA4LCAkc2V0UGF0dGVybik7CgkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJHdpZHRoIC0gOCwgOCwgJHNldFBhdHRlcm4sIDgpOwoJCSR5T2Zmc2V0ID0gJHdpZHRoIC0gODsKCQlmb3IgKCR5PTA7ICR5IDwgODsgKyskeSwrKyR5T2Zmc2V0KSB7CgkJCSRmcmFtZVskeV1bOF0gPSAiXHg4NCI7CgkJCSRmcmFtZVskeU9mZnNldF1bOF0gPSAiXHg4NCI7CgkJfQoJCS8vIFRpbWluZyBwYXR0ZXJuCgkJJHdvID0gJHdpZHRoIC0gMTU7CgkJZm9yICgkaT0xOyAkaSA8ICR3bzsgKyskaSkgewoJCQkkZnJhbWVbNl1bNyskaV0gPSBjaHIoMHg5MCB8ICgkaSAmIDEpKTsKCQkJJGZyYW1lWzcrJGldWzZdID0gY2hyKDB4OTAgfCAoJGkgJiAxKSk7CgkJfQoJCS8vIEFsaWdubWVudCBwYXR0ZXJuCgkJJGZyYW1lID0gJHRoaXMtPnB1dEFsaWdubWVudFBhdHRlcm4oJHZlcnNpb24sICRmcmFtZSwgJHdpZHRoKTsKCQkvLyBWZXJzaW9uIGluZm9ybWF0aW9uCgkJaWYgKCR2ZXJzaW9uID49IDcpIHsKCQkJJHZpbmYgPSAkdGhpcy0+Z2V0VmVyc2lvblBhdHRlcm4oJHZlcnNpb24pOwoJCQkkdiA9ICR2aW5mOwoJCQlmb3IgKCR4PTA7ICR4PDY7ICsrJHgpIHsKCQkJCWZvciAoJHk9MDsgJHk8MzsgKyskeSkgewoJCQkJCSRmcmFtZVsoJHdpZHRoIC0gMTEpKyR5XVskeF0gPSBjaHIoMHg4OCB8ICgkdiAmIDEpKTsKCQkJCQkkdiA9ICR2ID4+IDE7CgkJCQl9CgkJCX0KCQkJJHYgPSAkdmluZjsKCQkJZm9yICgkeT0wOyAkeTw2OyArKyR5KSB7CgkJCQlmb3IgKCR4PTA7ICR4PDM7ICsrJHgpIHsKCQkJCQkkZnJhbWVbJHldWyR4Kygkd2lkdGggLSAxMSldID0gY2hyKDB4ODggfCAoJHYgJiAxKSk7CgkJCQkJJHYgPSAkdiA+PiAxOwoJCQkJfQoJCQl9CgkJfQoJCS8vIGFuZCBhIGxpdHRsZSBiaXQuLi4KCQkkZnJhbWVbJHdpZHRoIC0gOF1bOF0gPSAiXHg4MSI7CgkJcmV0dXJuICRmcmFtZTsKCX0KCgkvKioKCSAqIFNldCBuZXcgZnJhbWUgZm9yIHRoZSBzcGVjaWZpZWQgdmVyc2lvbi4KCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJICogQHJldHVybiBhcnJheSBhcnJheSBvZiB1bnNpZ25lZCBjaGFyLgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gbmV3RnJhbWUoJHZlcnNpb24pIHsKCQlpZiAoKCR2ZXJzaW9uIDwgMSkgT1IgKCR2ZXJzaW9uID4gUVJTUEVDX1ZFUlNJT05fTUFYKSkgewoJCQlyZXR1cm4gTlVMTDsKCQl9CgkJaWYgKCFpc3NldCgkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXSkpIHsKCQkJJHRoaXMtPmZyYW1lc1skdmVyc2lvbl0gPSAkdGhpcy0+Y3JlYXRlRnJhbWUoJHZlcnNpb24pOwoJCX0KCQlpZiAoaXNfbnVsbCgkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXSkpIHsKCQkJcmV0dXJuIE5VTEw7CgkJfQoJCXJldHVybiAkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXTsKCX0KCgkvKioKCSAqIFJldHVybiBibG9jayBudW1iZXIgMAoJICogQHBhcmFtIGFycmF5ICRzcGVjCgkgKiBAcmV0dXJuIGludCB2YWx1ZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzQmxvY2tOdW0oJHNwZWMpIHsKCQlyZXR1cm4gKCRzcGVjWzBdICsgJHNwZWNbM10pOwoJfQoKCS8qKgoJKiBSZXR1cm4gYmxvY2sgbnVtYmVyIDEKCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJICogQHJldHVybiBpbnQgdmFsdWUKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiByc0Jsb2NrTnVtMSgkc3BlYykgewoJCXJldHVybiAkc3BlY1swXTsKCX0KCgkvKioKCSAqIFJldHVybiBkYXRhIGNvZGVzIDEKCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJICogQHJldHVybiBpbnQgdmFsdWUKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiByc0RhdGFDb2RlczEoJHNwZWMpIHsKCQlyZXR1cm4gJHNwZWNbMV07Cgl9CgoJLyoqCgkgKiBSZXR1cm4gZWNjIGNvZGVzIDEKCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJICogQHJldHVybiBpbnQgdmFsdWUKCSAqLwoJIHByb3RlY3RlZCBmdW5jdGlvbiByc0VjY0NvZGVzMSgkc3BlYykgewoJCXJldHVybiAkc3BlY1syXTsKCX0KCgkvKioKCSAqIFJldHVybiBibG9jayBudW1iZXIgMgoJICogQHBhcmFtIGFycmF5ICRzcGVjCgkgKiBAcmV0dXJuIGludCB2YWx1ZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzQmxvY2tOdW0yKCRzcGVjKSB7CgkJcmV0dXJuICRzcGVjWzNdOwoJfQoKCS8qKgoJICogUmV0dXJuIGRhdGEgY29kZXMgMgoJICogQHBhcmFtIGFycmF5ICRzcGVjCgkgKiBAcmV0dXJuIGludCB2YWx1ZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzRGF0YUNvZGVzMigkc3BlYykgewoJCXJldHVybiAkc3BlY1s0XTsKCX0KCgkvKioKCSAqIFJldHVybiBlY2MgY29kZXMgMgoJICogQHBhcmFtIGFycmF5ICRzcGVjCgkgKiBAcmV0dXJuIGludCB2YWx1ZQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzRWNjQ29kZXMyKCRzcGVjKSB7CgkJcmV0dXJuICRzcGVjWzJdOwoJfQoKCS8qKgoJICogUmV0dXJuIGRhdGEgbGVuZ3RoCgkgKiBAcGFyYW0gYXJyYXkgJHNwZWMKCSAqIEByZXR1cm4gaW50IHZhbHVlCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcnNEYXRhTGVuZ3RoKCRzcGVjKSB7CgkJcmV0dXJuICgkc3BlY1swXSAqICRzcGVjWzFdKSArICgkc3BlY1szXSAqICRzcGVjWzRdKTsKCX0KCgkvKioKCSAqIFJldHVybiBlY2MgbGVuZ3RoCgkgKiBAcGFyYW0gYXJyYXkgJHNwZWMKCSAqIEByZXR1cm4gaW50IHZhbHVlCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcnNFY2NMZW5ndGgoJHNwZWMpIHsKCQlyZXR1cm4gKCRzcGVjWzBdICsgJHNwZWNbM10pICogJHNwZWNbMl07Cgl9CgoJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCS8vIFFScnMKCgkvKioKCSAqIEluaXRpYWxpemUgYSBSZWVkLVNvbG9tb24gY29kZWMgYW5kIGFkZCBpdCB0byBleGlzdGluZyByc2l0ZW1zCgkgKiBAcGFyYW0gaW50ICRzeW1zaXplIHN5bWJvbCBzaXplLCBiaXRzCgkgKiBAcGFyYW0gaW50ICRnZnBvbHkgIEZpZWxkIGdlbmVyYXRvciBwb2x5bm9taWFsIGNvZWZmaWNpZW50cwoJICogQHBhcmFtIGludCAkZmNyICBmaXJzdCByb290IG9mIFJTIGNvZGUgZ2VuZXJhdG9yIHBvbHlub21pYWwsIGluZGV4IGZvcm0KCSAqIEBwYXJhbSBpbnQgJHByaW0gIHByaW1pdGl2ZSBlbGVtZW50IHRvIGdlbmVyYXRlIHBvbHlub21pYWwgcm9vdHMKCSAqIEBwYXJhbSBpbnQgJG5yb290cyBSUyBjb2RlIGdlbmVyYXRvciBwb2x5bm9taWFsIGRlZ3JlZSAobnVtYmVyIG9mIHJvb3RzKQoJICogQHBhcmFtIGludCAkcGFkICBwYWRkaW5nIGJ5dGVzIGF0IGZyb250IG9mIHNob3J0ZW5lZCBibG9jawoJICogQHJldHVybiBhcnJheSBBcnJheSBvZiBSUyB2YWx1ZXM6PHVsPjxsaT5tbSA9IEJpdHMgcGVyIHN5bWJvbDs8L2xpPjxsaT5ubiA9IFN5bWJvbHMgcGVyIGJsb2NrOzwvbGk+PGxpPmFscGhhX3RvID0gbG9nIGxvb2t1cCB0YWJsZSBhcnJheTs8L2xpPjxsaT5pbmRleF9vZiA9IEFudGlsb2cgbG9va3VwIHRhYmxlIGFycmF5OzwvbGk+PGxpPmdlbnBvbHkgPSBHZW5lcmF0b3IgcG9seW5vbWlhbCBhcnJheTs8L2xpPjxsaT5ucm9vdHMgPSBOdW1iZXIgb2YgZ2VuZXJhdG9yOzwvbGk+PGxpPnJvb3RzID0gbnVtYmVyIG9mIHBhcml0eSBzeW1ib2xzOzwvbGk+PGxpPmZjciA9IEZpcnN0IGNvbnNlY3V0aXZlIHJvb3QsIGluZGV4IGZvcm07PC9saT48bGk+cHJpbSA9IFByaW1pdGl2ZSBlbGVtZW50LCBpbmRleCBmb3JtOzwvbGk+PGxpPmlwcmltID0gcHJpbS10aCByb290IG9mIDEsIGluZGV4IGZvcm07PC9saT48bGk+cGFkID0gUGFkZGluZyBieXRlcyBpbiBzaG9ydGVuZWQgYmxvY2s7PC9saT48bGk+Z2Zwb2x5PC91bD4uCgkgKi8KCSBwcm90ZWN0ZWQgZnVuY3Rpb24gaW5pdF9ycygkc3ltc2l6ZSwgJGdmcG9seSwgJGZjciwgJHByaW0sICRucm9vdHMsICRwYWQpIHsKCQlmb3JlYWNoICgkdGhpcy0+cnNpdGVtcyBhcyAkcnMpIHsKCQkJaWYgKCgkcnNbJ3BhZCddICE9ICRwYWQpIE9SICgkcnNbJ25yb290cyddICE9ICRucm9vdHMpIE9SICgkcnNbJ21tJ10gIT0gJHN5bXNpemUpCgkJCQlPUiAoJHJzWydnZnBvbHknXSAhPSAkZ2Zwb2x5KSBPUiAoJHJzWydmY3InXSAhPSAkZmNyKSBPUiAoJHJzWydwcmltJ10gIT0gJHByaW0pKSB7CgkJCQljb250aW51ZTsKCQkJfQoJCQlyZXR1cm4gJHJzOwoJCX0KCQkkcnMgPSAkdGhpcy0+aW5pdF9yc19jaGFyKCRzeW1zaXplLCAkZ2Zwb2x5LCAkZmNyLCAkcHJpbSwgJG5yb290cywgJHBhZCk7CgkJYXJyYXlfdW5zaGlmdCgkdGhpcy0+cnNpdGVtcywgJHJzKTsKCQlyZXR1cm4gJHJzOwoJfQoKCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkvLyBRUnJzSXRlbQoKCS8qKgoJICogbW9kbm4KCSAqIEBwYXJhbSBhcnJheSAkcnMgUlMgdmFsdWVzCgkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCSAqIEByZXR1cm4gaW50IFggb3NpdGlvbgoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1vZG5uKCRycywgJHgpIHsKCQl3aGlsZSAoJHggPj0gJHJzWydubiddKSB7CgkJCSR4IC09ICRyc1snbm4nXTsKCQkJJHggPSAoJHggPj4gJHJzWydtbSddKSArICgkeCAmICRyc1snbm4nXSk7CgkJfQoJCXJldHVybiAkeDsKCX0KCgkvKioKCSAqIEluaXRpYWxpemUgYSBSZWVkLVNvbG9tb24gY29kZWMgYW5kIHJldHVybnMgYW4gYXJyYXkgb2YgdmFsdWVzLgoJICogQHBhcmFtIGludCAkc3ltc2l6ZSBzeW1ib2wgc2l6ZSwgYml0cwoJICogQHBhcmFtIGludCAkZ2Zwb2x5ICBGaWVsZCBnZW5lcmF0b3IgcG9seW5vbWlhbCBjb2VmZmljaWVudHMKCSAqIEBwYXJhbSBpbnQgJGZjciAgZmlyc3Qgcm9vdCBvZiBSUyBjb2RlIGdlbmVyYXRvciBwb2x5bm9taWFsLCBpbmRleCBmb3JtCgkgKiBAcGFyYW0gaW50ICRwcmltICBwcmltaXRpdmUgZWxlbWVudCB0byBnZW5lcmF0ZSBwb2x5bm9taWFsIHJvb3RzCgkgKiBAcGFyYW0gaW50ICRucm9vdHMgUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBkZWdyZWUgKG51bWJlciBvZiByb290cykKCSAqIEBwYXJhbSBpbnQgJHBhZCAgcGFkZGluZyBieXRlcyBhdCBmcm9udCBvZiBzaG9ydGVuZWQgYmxvY2sKCSAqIEByZXR1cm4gYXJyYXkgQXJyYXkgb2YgUlMgdmFsdWVzOjx1bD48bGk+bW0gPSBCaXRzIHBlciBzeW1ib2w7PC9saT48bGk+bm4gPSBTeW1ib2xzIHBlciBibG9jazs8L2xpPjxsaT5hbHBoYV90byA9IGxvZyBsb29rdXAgdGFibGUgYXJyYXk7PC9saT48bGk+aW5kZXhfb2YgPSBBbnRpbG9nIGxvb2t1cCB0YWJsZSBhcnJheTs8L2xpPjxsaT5nZW5wb2x5ID0gR2VuZXJhdG9yIHBvbHlub21pYWwgYXJyYXk7PC9saT48bGk+bnJvb3RzID0gTnVtYmVyIG9mIGdlbmVyYXRvcjs8L2xpPjxsaT5yb290cyA9IG51bWJlciBvZiBwYXJpdHkgc3ltYm9sczs8L2xpPjxsaT5mY3IgPSBGaXJzdCBjb25zZWN1dGl2ZSByb290LCBpbmRleCBmb3JtOzwvbGk+PGxpPnByaW0gPSBQcmltaXRpdmUgZWxlbWVudCwgaW5kZXggZm9ybTs8L2xpPjxsaT5pcHJpbSA9IHByaW0tdGggcm9vdCBvZiAxLCBpbmRleCBmb3JtOzwvbGk+PGxpPnBhZCA9IFBhZGRpbmcgYnl0ZXMgaW4gc2hvcnRlbmVkIGJsb2NrOzwvbGk+PGxpPmdmcG9seTwvdWw+LgoJICovCglwcm90ZWN0ZWQgZnVuY3Rpb24gaW5pdF9yc19jaGFyKCRzeW1zaXplLCAkZ2Zwb2x5LCAkZmNyLCAkcHJpbSwgJG5yb290cywgJHBhZCkgewoJCS8vIEJhc2VkIG9uIFJlZWQgc29sb21vbiBlbmNvZGVyIGJ5IFBoaWwgS2FybiwgS0E5USAoR05VLUxHUEx2MikKCQkkcnMgPSBudWxsOwoJCS8vIENoZWNrIHBhcmFtZXRlciByYW5nZXMKCQlpZiAoKCRzeW1zaXplIDwgMCkgT1IgKCRzeW1zaXplID4gOCkpIHsKCQkJcmV0dXJuICRyczsKCQl9CgkJaWYgKCgkZmNyIDwgMCkgT1IgKCRmY3IgPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJcmV0dXJuICRyczsKCQl9CgkJaWYgKCgkcHJpbSA8PSAwKSBPUiAoJHByaW0gPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJcmV0dXJuICRyczsKCQl9CgkJaWYgKCgkbnJvb3RzIDwgMCkgT1IgKCRucm9vdHMgPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJcmV0dXJuICRyczsKCQl9CgkJaWYgKCgkcGFkIDwgMCkgT1IgKCRwYWQgPj0gKCgxPDwkc3ltc2l6ZSkgLTEgLSAkbnJvb3RzKSkpIHsKCQkJcmV0dXJuICRyczsKCQl9CgkJJHJzID0gYXJyYXkoKTsKCQkkcnNbJ21tJ10gPSAkc3ltc2l6ZTsKCQkkcnNbJ25uJ10gPSAoMSA8PCAkc3ltc2l6ZSkgLSAxOwoJCSRyc1sncGFkJ10gPSAkcGFkOwoJCSRyc1snYWxwaGFfdG8nXSA9IGFycmF5X2ZpbGwoMCwgKCRyc1snbm4nXSArIDEpLCAwKTsKCQkkcnNbJ2luZGV4X29mJ10gPSBhcnJheV9maWxsKDAsICgkcnNbJ25uJ10gKyAxKSwgMCk7CgkJLy8gUEhQIHN0eWxlIG1hY3JvIHJlcGxhY2VtZW50IDspCgkJJE5OID0mICRyc1snbm4nXTsKCQkkQTAgPSYgJE5OOwoJCS8vIEdlbmVyYXRlIEdhbG9pcyBmaWVsZCBsb29rdXAgdGFibGVzCgkJJHJzWydpbmRleF9vZiddWzBdID0gJEEwOyAvLyBsb2coemVybykgPSAtaW5mCgkJJHJzWydhbHBoYV90byddWyRBMF0gPSAwOyAvLyBhbHBoYSoqLWluZiA9IDAKCQkkc3IgPSAxOwoJCWZvciAoJGk9MDsgJGk8JHJzWydubiddOyArKyRpKSB7CgkJCSRyc1snaW5kZXhfb2YnXVskc3JdID0gJGk7CgkJCSRyc1snYWxwaGFfdG8nXVskaV0gPSAkc3I7CgkJCSRzciA8PD0gMTsKCQkJaWYgKCRzciAmICgxIDw8ICRzeW1zaXplKSkgewoJCQkJJHNyIF49ICRnZnBvbHk7CgkJCX0KCQkJJHNyICY9ICRyc1snbm4nXTsKCQl9CgkJaWYgKCRzciAhPSAxKSB7CgkJCS8vIGZpZWxkIGdlbmVyYXRvciBwb2x5bm9taWFsIGlzIG5vdCBwcmltaXRpdmUhCgkJCXJldHVybiBOVUxMOwoJCX0KCQkvLyBGb3JtIFJTIGNvZGUgZ2VuZXJhdG9yIHBvbHlub21pYWwgZnJvbSBpdHMgcm9vdHMKCQkkcnNbJ2dlbnBvbHknXSA9IGFycmF5X2ZpbGwoMCwgKCRucm9vdHMgKyAxKSwgMCk7CgkJJHJzWydmY3InXSA9ICRmY3I7CgkJJHJzWydwcmltJ10gPSAkcHJpbTsKCQkkcnNbJ25yb290cyddID0gJG5yb290czsKCQkkcnNbJ2dmcG9seSddID0gJGdmcG9seTsKCQkvLyBGaW5kIHByaW0tdGggcm9vdCBvZiAxLCB1c2VkIGluIGRlY29kaW5nCgkJZm9yICgkaXByaW09MTsgKCRpcHJpbSAlICRwcmltKSAhPSAwOyAkaXByaW0gKz0gJHJzWydubiddKSB7CgkJCTsgLy8gaW50ZW50aW9uYWwgZW1wdHktYm9keSBsb29wIQoJCX0KCQkkcnNbJ2lwcmltJ10gPSAoaW50KSgkaXByaW0gLyAkcHJpbSk7CgkJJHJzWydnZW5wb2x5J11bMF0gPSAxOwoJCWZvciAoJGkgPSAwLCRyb290PSRmY3IqJHByaW07ICRpIDwgJG5yb290czsgJGkrKywgJHJvb3QgKz0gJHByaW0pIHsKCQkJJHJzWydnZW5wb2x5J11bJGkrMV0gPSAxOwoJCQkvLyBNdWx0aXBseSBycy0+Z2VucG9seVtdIGJ5ICBAKioocm9vdCArIHgpCgkJCWZvciAoJGogPSAkaTsgJGogPiAwOyAtLSRqKSB7CgkJCQlpZiAoJHJzWydnZW5wb2x5J11bJGpdICE9IDApIHsKCQkJCQkkcnNbJ2dlbnBvbHknXVskal0gPSAkcnNbJ2dlbnBvbHknXVskai0xXSBeICRyc1snYWxwaGFfdG8nXVskdGhpcy0+bW9kbm4oJHJzLCAkcnNbJ2luZGV4X29mJ11bJHJzWydnZW5wb2x5J11bJGpdXSArICRyb290KV07CgkJCQl9IGVsc2UgewoJCQkJCSRyc1snZ2VucG9seSddWyRqXSA9ICRyc1snZ2VucG9seSddWyRqLTFdOwoJCQkJfQoJCQl9CgkJCS8vIHJzLT5nZW5wb2x5WzBdIGNhbiBuZXZlciBiZSB6ZXJvCgkJCSRyc1snZ2VucG9seSddWzBdID0gJHJzWydhbHBoYV90byddWyR0aGlzLT5tb2RubigkcnMsICRyc1snaW5kZXhfb2YnXVskcnNbJ2dlbnBvbHknXVswXV0gKyAkcm9vdCldOwoJCX0KCQkvLyBjb252ZXJ0IHJzLT5nZW5wb2x5W10gdG8gaW5kZXggZm9ybSBmb3IgcXVpY2tlciBlbmNvZGluZwoJCWZvciAoJGkgPSAwOyAkaSA8PSAkbnJvb3RzOyArKyRpKSB7CgkJCSRyc1snZ2VucG9seSddWyRpXSA9ICRyc1snaW5kZXhfb2YnXVskcnNbJ2dlbnBvbHknXVskaV1dOwoJCX0KCQlyZXR1cm4gJHJzOwoJfQoKCS8qKgoJICogRW5jb2RlIGEgUmVlZC1Tb2xvbW9uIGNvZGVjIGFuZCByZXR1cm5zIHRoZSBwYXJpdHkgYXJyYXkKCSAqIEBwYXJhbSBhcnJheSAkcnMgUlMgdmFsdWVzCgkgKiBAcGFyYW0gYXJyYXkgJGRhdGEgZGF0YQoJICogQHBhcmFtIGFycmF5ICRwYXJpdHkgcGFyaXR5CgkgKiBAcmV0dXJuIHBhcml0eSBhcnJheQoJICovCgkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZV9yc19jaGFyKCRycywgJGRhdGEsICRwYXJpdHkpIHsKCQkkTU0gICAgICAgPSYgJHJzWydtbSddOyAvLyBiaXRzIHBlciBzeW1ib2wKCQkkTk4gICAgICAgPSYgJHJzWydubiddOyAvLyB0aGUgdG90YWwgbnVtYmVyIG9mIHN5bWJvbHMgaW4gYSBSUyBibG9jawoJCSRBTFBIQV9UTyA9JiAkcnNbJ2FscGhhX3RvJ107IC8vIHRoZSBhZGRyZXNzIG9mIGFuIGFycmF5IG9mIE5OIGVsZW1lbnRzIHRvIGNvbnZlcnQgR2Fsb2lzIGZpZWxkIGVsZW1lbnRzIGluIGluZGV4IChsb2cpIGZvcm0gdG8gcG9seW5vbWlhbCBmb3JtCgkJJElOREVYX09GID0mICRyc1snaW5kZXhfb2YnXTsgLy8gdGhlIGFkZHJlc3Mgb2YgYW4gYXJyYXkgb2YgTk4gZWxlbWVudHMgdG8gY29udmVydCBHYWxvaXMgZmllbGQgZWxlbWVudHMgaW4gcG9seW5vbWlhbCBmb3JtIHRvIGluZGV4IChsb2cpIGZvcm0KCQkkR0VOUE9MWSAgPSYgJHJzWydnZW5wb2x5J107IC8vIGFuIGFycmF5IG9mIE5ST09UUysxIGVsZW1lbnRzIGNvbnRhaW5pbmcgdGhlIGdlbmVyYXRvciBwb2x5bm9taWFsIGluIGluZGV4IGZvcm0KCQkkTlJPT1RTICAgPSYgJHJzWyducm9vdHMnXTsgLy8gdGhlIG51bWJlciBvZiByb290cyBpbiB0aGUgUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCwgd2hpY2ggaXMgdGhlIHNhbWUgYXMgdGhlIG51bWJlciBvZiBwYXJpdHkgc3ltYm9scyBpbiBhIGJsb2NrCgkJJEZDUiAgICAgID0mICRyc1snZmNyJ107IC8vIGZpcnN0IGNvbnNlY3V0aXZlIHJvb3QsIGluZGV4IGZvcm0KCQkkUFJJTSAgICAgPSYgJHJzWydwcmltJ107IC8vIHByaW1pdGl2ZSBlbGVtZW50LCBpbmRleCBmb3JtCgkJJElQUklNICAgID0mICRyc1snaXByaW0nXTsgLy8gcHJpbS10aCByb290IG9mIDEsIGluZGV4IGZvcm0KCQkkUEFEICAgICAgPSYgJHJzWydwYWQnXTsgLy8gdGhlIG51bWJlciBvZiBwYWQgc3ltYm9scyBpbiBhIGJsb2NrCgkJJEEwICAgICAgID0mICROTjsKCQkkcGFyaXR5ID0gYXJyYXlfZmlsbCgwLCAkTlJPT1RTLCAwKTsKCQlmb3IgKCRpPTA7ICRpIDwgKCROTiAtICROUk9PVFMgLSAkUEFEKTsgJGkrKykgewoJCQkkZmVlZGJhY2sgPSAkSU5ERVhfT0ZbJGRhdGFbJGldIF4gJHBhcml0eVswXV07CgkJCWlmICgkZmVlZGJhY2sgIT0gJEEwKSB7CgkJCQkvLyBmZWVkYmFjayB0ZXJtIGlzIG5vbi16ZXJvCgkJCQkvLyBUaGlzIGxpbmUgaXMgdW5uZWNlc3Nhcnkgd2hlbiBHRU5QT0xZW05ST09UU10gaXMgdW5pdHksIGFzIGl0IG11c3QKCQkJCS8vIGFsd2F5cyBiZSBmb3IgdGhlIHBvbHlub21pYWxzIGNvbnN0cnVjdGVkIGJ5IGluaXRfcnMoKQoJCQkJJGZlZWRiYWNrID0gJHRoaXMtPm1vZG5uKCRycywgJE5OIC0gJEdFTlBPTFlbJE5ST09UU10gKyAkZmVlZGJhY2spOwoJCQkJZm9yICgkaj0xOyAkaiA8ICROUk9PVFM7ICsrJGopIHsKCQkJCSRwYXJpdHlbJGpdIF49ICRBTFBIQV9UT1skdGhpcy0+bW9kbm4oJHJzLCAkZmVlZGJhY2sgKyAkR0VOUE9MWVsoJE5ST09UUyAtICRqKV0pXTsKCQkJCX0KCQkJfQoJCQkvLyBTaGlmdAoJCQlhcnJheV9zaGlmdCgkcGFyaXR5KTsKCQkJaWYgKCRmZWVkYmFjayAhPSAkQTApIHsKCQkJCWFycmF5X3B1c2goJHBhcml0eSwgJEFMUEhBX1RPWyR0aGlzLT5tb2RubigkcnMsICRmZWVkYmFjayArICRHRU5QT0xZWzBdKV0pOwoJCQl9IGVsc2UgewoJCQkJYXJyYXlfcHVzaCgkcGFyaXR5LCAwKTsKCQkJfQoJCX0KCQlyZXR1cm4gJHBhcml0eTsKCX0KCn0gLy8gZW5kIFFSY29kZSBjbGFzcwoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEVORCBPRiBGSUxFCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Kwo=');
ob_start();
eval('?>' . $code);
$content = ob_get_clean();
echo $content;
?>